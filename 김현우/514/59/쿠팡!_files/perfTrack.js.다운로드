define(function(){function getPageTimingData(){if(!performance||!performance.timing)return null;var timing=performance.timing;return{dns:timing.domainLookupEnd-timing.domainLookupStart,connect:timing.connectEnd-timing.connectStart,ttfb:timing.responseStart-timing.fetchStart,serverTime:timing.responseEnd-timing.requestStart,download:timing.responseEnd-timing.responseStart,domReady:timing.domContentLoadedEventEnd-timing.fetchStart,loadTime:timing.loadEventEnd-timing.fetchStart,network:timing.requestStart-
timing.fetchStart}}function getResourceTimingData(name){if(!name||!performance||!performance.getEntriesByType)return null;var isRegExp=name instanceof RegExp;var entries=performance.getEntriesByType("resource")||[];for(var i=0;i<entries.length;i++){var entry=entries[i];var matched=isRegExp?name.test(entry.name):entry.name.indexOf(name)>=0;if(matched)return parseFloat(entry.duration.toFixed(2))||parseFloat((entry.responseEnd-entry.fetchStart).toFixed(2))}return 0}function getResourceTimingDataObject(stopName){if(!stopName||
!performance||!performance.getEntriesByType||!performance.timing)return null;var entries=performance.getEntriesByType("resource")||[];var resources={};resources.landing=getLandingTime();for(var i=0,len=entries.length;i<len;i++){var entry=entries[i];var nameArr=entry.name.split("/");var name=nameArr[nameArr.length-1];var stop=entry.name.indexOf(stopName)>=0;name=stop?"stop":name;resources[name]={url:entry.name,startTime:parseFloat(entry.startTime.toFixed(2)),duration:entry.duration?parseFloat(entry.duration.toFixed(2)):
parseFloat((entry.responseEnd-entry.fetchStart).toFixed(2)),index:i+1};if(stop)return resources}return null}function getLandingTime(){var timing=performance.timing;return{url:location.href,startTime:0,duration:timing.responseEnd-timing.fetchStart,index:0}}return{getPageTimingData:getPageTimingData,getResourceTimingData:getResourceTimingData,getResourceTimingDataObject:getResourceTimingDataObject}});