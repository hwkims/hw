define(["jquery","common/utils/pageType"],function($,pageTypeUtil){var currentPageType="unknown";var signNudgeWrapSelector=".with-right-breadcrumb";var signNudgeSelector=".with-right-breadcrumb .sign-in-nudge";var signNudgeBtnSelector=".sign-in-nudge .sign-in-nudge-inner .login-link";var ExplainingBenefitsNudge=function(){this.init()};ExplainingBenefitsNudge.prototype={init:function(){if(!this.getShowSignInNudge())return;this.initPageType();this.sendSignInNudgeImpressionLog();this.initSignInNudgeClick()},
initSignInNudgeClick:function(){var _this=this;$(signNudgeWrapSelector).on("click",signNudgeBtnSelector,function(){_this.onClickSignNudge()})},sendSignInNudgeImpressionLog:function(){if(!CoupangWebLog)return;CoupangWebLog.submit({meta:{schemaId:14053,schemaVersion:1},data:this.getImpressionLogData()})},sendSignInNudgeClickLog:function(){if(!CoupangWebLog)return;CoupangWebLog.submit({meta:{schemaId:14054,schemaVersion:1},data:this.getClickLogData()})},getShowSignInNudge:function(){return["B","C"].includes(this.getAddSignInNudgeExplainingBenefitsAbOption())},
getAddSignInNudgeExplainingBenefitsAbOption:function(){var $signNudge=$(signNudgeSelector);if(!$signNudge.length)return null;return $signNudge.data("addSignInNudgeExplainingBenefitsAbOption")},initPageType:function(){currentPageType=pageTypeUtil.getCurrentPageType()},onClickSignNudge:function(){var baseLoginUrl=$(signNudgeSelector).data("loginUrl");if(!baseLoginUrl)return;this.sendSignInNudgeClickLog();var loginUrl=baseLoginUrl+encodeURIComponent(encodeURIComponent(window.location.href));location.href=
loginUrl},getImpressionLogData:function(){switch(currentPageType){case pageTypeUtil.pageTypeMap.sdp:return this.getSdpImpressionLogData();case pageTypeUtil.pageTypeMap.srp:return this.getSrpImpressionLogData();case pageTypeUtil.pageTypeMap.plp:return this.getPlpImpressionLogData();default:return{}}},getClickLogData:function(){switch(currentPageType){case pageTypeUtil.pageTypeMap.sdp:return this.getSdpClickLogData();case pageTypeUtil.pageTypeMap.srp:return this.getSrpClickLogData();case pageTypeUtil.pageTypeMap.plp:return this.getPlpClickLogData();
default:return{}}},getSdpImpressionLogData:function(){var productId="";var itemId="";var vendorItemId="";var sdpVisitKey="";if(window.sdp){productId=window.sdp.productId;itemId=window.sdp.itemId;vendorItemId=window.sdp.vendorItemId;if(window.sdp.trackMeta)sdpVisitKey=window.sdp.trackMeta.sdpVisitKey}return{eventName:"login_nudge_impression",logCategory:"impression",logType:"impression",domain:"sdp",pageName:"sdp",productId:productId,itemId:itemId,vendorItemId:vendorItemId,sdpVisitKey:sdpVisitKey}},
getSdpClickLogData:function(){var productId="";var itemId="";var vendorItemId="";var sdpVisitKey="";if(window.sdp){productId=window.sdp.productId;itemId=window.sdp.itemId;vendorItemId=window.sdp.vendorItemId;if(window.sdp.trackMeta)sdpVisitKey=window.sdp.trackMeta.sdpVisitKey}return{eventName:"login_nudge_click",logCategory:"event",logType:"click",domain:"sdp",pageName:"sdp",productId:productId,itemId:itemId,vendorItemId:vendorItemId,sdpVisitKey:sdpVisitKey}},getSrpImpressionLogData:function(){var searchId=
$('input[name\x3d"searchId"]').val();var q="";try{q=(new URLSearchParams(location.search)).get("q")||""}catch(error){}return{eventName:"login_nudge_impression",logCategory:"impression",logType:"impression",domain:"srp",pageName:"srp",q:q,searchId:searchId}},getSrpClickLogData:function(){var searchId=$('input[name\x3d"searchId"]').val();var q="";try{q=(new URLSearchParams(location.search)).get("q")||""}catch(error){}return{eventName:"login_nudge_click",logCategory:"event",logType:"click",domain:"srp",
pageName:"srp",q:q,searchId:searchId}},getPlpImpressionLogData:function(){var linkCode=$("#searchOptionForm").data("linkcode")||"";var raw=$(".newcx-main").data("raw");var categoryId;try{if(raw&&raw.component)categoryId=raw.component.toString()}catch(error){}return{eventName:"login_nudge_impression",logCategory:"impression",logType:"impression",domain:"plp",pageName:"plp",linkCode:String(linkCode),categoryId:categoryId}},getPlpClickLogData:function(){var linkCode=$("#searchOptionForm").data("linkcode")||
"";var raw=$(".newcx-main").data("raw");var categoryId;try{if(raw&&raw.component)categoryId=raw.component.toString()}catch(error){}return{eventName:"login_nudge_click",logCategory:"event",logType:"click",domain:"plp",pageName:"plp",linkCode:String(linkCode),categoryId:categoryId}}};return ExplainingBenefitsNudge});