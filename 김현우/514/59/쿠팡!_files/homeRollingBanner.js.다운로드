define("homeRollingBanner",["jquery","common/essentialData","weblog","HomeWebLogger"],function($,essentialData,CoupangWebLog,HomeWebLogger){var homeRollingBanner=function(indicator,targetElement,activatedClass,rollingSpeed){this.init(indicator,targetElement,activatedClass,rollingSpeed)};homeRollingBanner.prototype={loggingFlag:false,init:function(indicator,targetElement,activatedClass,rollingSpeed){if(!window.CoupangWebLog)CoupangWebLog.init({"platform":"web","service":"coupang","mode":essentialData.getProfile()===
""||essentialData.getProfile()==="production"?"production":"test","useAutoSendPageViewLog":false});this.rollingBanner({indicator:indicator,slider:$(targetElement),speed:rollingSpeed,activatedClass:activatedClass})},rollingBanner:function(options){var setting={slider:null,speed:"1000",activatedClass:null,indicator:null};var options=$.extend(setting,options);var slider=options.slider;var list=slider.find("ul");var item=list.find("li");var rollingTimer="";var speed=options.speed;var paging=slider.find("ol");
var button=slider.find(".move");var size=1;var view=Math.ceil(item.size()/size);var index=0;var checkBannerLogging=[];var indicator=options.indicator;var activatedClass=options.activatedClass;var bannerVisible=function(){if(item.length<1)return false;var _window=$(window);var sliderTop=slider.offset().top;return sliderTop+slider.height()>_window.scrollTop()&&sliderTop<_window.scrollTop()+_window.height()};var loggingFlag=bannerVisible();$(window).on("scroll",$.proxy(function(){if(bannerVisible()){if(loggingFlag===
false){loggingFlag=true;impressionLoggingForActivated()}}else loggingFlag=false},this));var impressionLoggingForActivated=function(){if(item.length>0&&checkBannerLogging.length<item.length){var activatedBanner=indicator+" ."+activatedClass;var data=$(activatedBanner).find("a").data("logProps");var bannerId=$(activatedBanner).data("bannerId");if(data&&checkBannerLogging.indexOf(bannerId)<0&&loggingFlag===true){sendImpressionLogging(data);checkBannerLogging.push(bannerId)}}};var sendImpressionLogging=
function(data){HomeWebLogger.impressionLog({id:data.impressionId,param:data.param},{isAsync:true})};var panelFunc=function(){$(item).hide();item.removeClass(activatedClass);$(item).each(function(){var _this=$(this);var unit=Math.floor(_this.index()/size);if(unit==index){_this.show();_this.addClass(activatedClass)}else{_this.hide();_this.removeClass(activatedClass)}});impressionLoggingForActivated()};var pagingFunc=function(){paging.find("li").removeClass("selected");paging.find("li").eq(index).addClass("selected")};
var buttonFunc=function(type){if(type=="next"){index++;if(index>view-1)index=0}else{index--;if(index<0)index=view-1}pagingFunc();panelFunc()};var rollingFunc=function(type){if(type=="start")rollingTimer=setInterval(function(){buttonFunc("next")},speed);else clearInterval(rollingTimer)};slider.bind({mouseenter:function(){rollingFunc("stop")},mouseleave:function(){rollingFunc("start")}});rollingFunc("start");var loadFunc=function(){if(item.size()===1){button.hide();paging.hide()}else{paging.html("");
for(var i=0;i<view;i++)paging.append('\x3cli\x3e\x3ca title\x3d"'+(i+1)+'"\x3e'+(i+1)+"\x3c/a\x3e\x3c/li\x3e");paging.find("li").each(function(){$(this).on("click",function(){index=$(this).index();pagingFunc();panelFunc()})});pagingFunc()}panelFunc()};button.unbind("click").bind("click",function(e){e.preventDefault();if($(this).hasClass("next"))buttonFunc("next");else buttonFunc("prev");pagingFunc();panelFunc()});loadFunc()}};return homeRollingBanner});