!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="f7e3d66e-0e62-4109-9adf-e179908a9a9d",t._sentryDebugIdIdentifier="sentry-dbid-f7e3d66e-0e62-4109-9adf-e179908a9a9d")}catch(t){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"a2c176496c4c6a858c2cfe131601c238a8805dcf"},(self.webpackChunkupbit_web=self.webpackChunkupbit_web||[]).push([[6427],{96614:function(t,e,i){var n=i(19755),s=i(19755);!function(e){"use strict";t.exports=function(t,e){var i=t.CIQ,a=[];n.fn.extend({stxtap:function(t,e){return this.each((function(){i.installTapEvent(this),"string"==typeof t?s(this).on("stxtap",t,(function(t){e.call(this,t)})):s(this).on("stxtap",(function(e){t.call(this,e)}))}))}}),n.fn.extend(s.expr[":"],{trulyvisible:function(t,e,i){var n=s(t).parents();n=n.add(t);for(var a=0;a<n.length;a++){var o=s(n[a]);if("0"===o.css("opacity"))return!1;if("hidden"===o.css("visibility"))return!1;if("0px"===o.css("height")&&"hidden"==o.css("overflow-y"))return!1;if(!o.is(":visible"))return!1}return!0}}),n.fn.extend({parentsAndMe:function(t){var e=s(this).parents();return e=e.add(s(this))},cqvirtual:function(t){var e=this.clone(!0);return e.empty(),e.original=this,e},cqrender:function(t){if(this[0].innerHTML==this.original[0].innerHTML)return this.original;this.original.emptyExceptTemplate();var e=this.children();if(e.length){var i=e.detach();this.original.append(i)}return this.original},guaranteedWidth:function(){for(var t=this,e=t.width();!e;){if("BODY"===(t=t.parent())[0].tagName||t[0]===window)return window.innerWidth;e=t.width()}return e},guaranteedHeight:function(){for(var t=this,e=t.height();!e;){if("BODY"===(t=t.parent())[0].tagName||t[0]===window)return window.innerHeight;e=t.height()}return e},emptyExceptTemplate:function(){return this.children().not("template").remove(),this},truthyAttr:function(t){var e=this.attr(t);return void 0!==e&&("false"!=e.toLowerCase()&&"0"!=e)},attrBetter:function(t,e){return void 0===e&&(e="true"),this.attr(t)!==e&&(this.attr(t,e),!0)},removeAttrBetter:function(t){var e=this.attr(t);return!(!e&&""!==e)&&(this.removeAttr(t),!0)},textBetter:function(t){return this.text()!==t&&(this.text(t),!0)}}),n.queryString=function(t){for(var e=window.location.search.substring(1).split("&"),i=0;i<e.length;i++){var n=e[i].split("=");if(n[0]==t)return n[1]}return null},function(){var t,e,n=document.attachEvent,a=navigator.userAgent.match(/Trident/),o=(t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,20)},function(e){return t(e)}),r=(e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout,function(t){return e(t)});function c(t){var e=t.target||t.srcElement;e.__resizeRAF__&&r(e.__resizeRAF__),e.__resizeRAF__=o((function(){var i=e.__resizeTrigger__;i.__resizeListeners__.forEach((function(e){e.call(i,t)}))}))}function l(t){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",c)}i.addResizeListener=function(t,e){var i=s("cq-ui-manager");if(i.length>0&&(i=i[0]).registerForResize(t),!t.__resizeListeners__)if(t.__resizeListeners__=[],n)t.__resizeTrigger__=t,t.attachEvent("onresize",c);else{var o=t.__resizeTrigger__=document.createElement("object");o.setAttribute("style","visibility:hidden; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1; border:0px;"),o.__resizeElement__=t,o.onload=l,o.type="text/html",a&&t.appendChild(o),o.data="about:blank",a||t.appendChild(o)}t.__resizeListeners__.push(e)},i.removeResizeListener=function(t,e){var i=s("cq-ui-manager");i.length>0&&(i=i[0]).unregisterForResize(t),t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),t.__resizeListeners__.length||(n?t.detachEvent("onresize",c):(t.__resizeTrigger__.contentDocument.defaultView.removeEventListener("resize",c),t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)))}}(),i.UI={},i.UI.addResizeListener=function(t,e){i.UI.getUIManager().registerForResize(t),t.resizeHandle=i.resizeObserver(t,e,null,250)},i.UI.removeResizeListener=function(t){i.UI.getUIManager().unregisterForResize(t),i.resizeObserver(t,null,t.resizeHandle)},i.UI.containerExecute=function(t,e,i){var n=i;i&&n.constructor!==Array&&(n=Array.prototype.slice.call(arguments,2));for(var s=t.node.parents(),a=0;a<s.length;a++){var o=s[a];if(o[e]&&o[e].constructor==Function)return o[e].apply(o,n)}return null},i.UI.animatePrice=function(t,e,i,n){t.timeoutHandle&&(clearTimeout(t.timeoutHandle),t.timeoutHandle=null),t.removeClass("cq-stable cq-up cq-down"),e>i?t.addClass("cq-up"):e<i&&t.addClass("cq-down"),n&&(t.timeoutHandle=setTimeout((function(){t.addClass("cq-stable").removeClass("cq-up cq-down")}),0))},i.UI.makeFromTemplate=function(t,e){var i,n=s(t),a=n[0].content;function o(t){return function(){t.appendChild(this.cloneNode(!0))}}function r(t){return function(){!0===t?n.parent().append(this):s(t).append(this)}}a&&a.childNodes.length?i=document.importNode(a,!0):(a=document.createElement("DIV"),n.children().each(o(a)),i=a.cloneNode(!0));var c=s(i).children();return e&&c.each(r(e)),c},i.UI.splitMethod=function(t){if(!t)return null;var e=t.indexOf("("),i=t.lastIndexOf(")");if(-1==e||-1==i)return console.log("malformed stxtap attribute: "+t),null;var n,s=null,a=t.substring(0,e),o=a.indexOf(".");-1==o?n=a:(s=a.substring(0,o),n=t.substring(o+1,e));var r=t.substring(e+1,i).match(/('[^']+'|[^,]+)/g),c=new RegExp("^[0-9]+([,.][0-9]+)?$","g"),l=new RegExp("^\\d+$"),h=[];if(r)for(var d=0;d<r.length;d++){for(var u=r[d];" "==u.charAt(0);)u=u.substring(1);if(-1!=u.indexOf('"')||-1!=u.indexOf("'"))h.push(u.substring(1,u.length-1));else if("true"==u)h.push(!0);else if("false"==u)h.push(!1);else if("null"==u)h.push(null);else if(l.test(u))h.push(parseInt(u,10));else if(c.test(u))h.push(parseFloat(u));else{for(var p=u.split("."),m=window,g=0;g<p.length;g++)m=m[p[g]];h.push(m)}}return{helperName:s,functionName:n,args:h}},i.UI.observe=function(t){if(!Object.observe)return console.warn("CIQ.UI.observe is deprecated. You must include thirdparty/object-observe.js in your project to use the feature, or use CIQ.UI.observeProperty.");var e=this;function i(i){var n=!1;if(t.member){if(i.name===t.member)n=!0;else if(t.member.constructor==Array)for(var a=0;a<t.member.length;a++)i.name===t.member[a]&&(n=!0)}else n=!0;if(n){var o=s(t.selector);if(!o.length&&"callback"===t.action)return void t.value.call(e,t);"class"===t.action&&o.removeClass(t.value),o.each((function(){var i=!1;t.member&&(t.condition?t.obj[t.member]===t.condition&&(i=!0):i=t.obj[t.member]),"class"===t.action&&i&&o.addClass(t.value),"callback"===t.action&&t.value.call(e,t,this),"value"===t.action&&(t.value?this.value=t.value:t.obj[t.member]?this.value=t.obj[t.member]:this.value="")}))}}var n=function(t){t.forEach(i)};return Object.observe(t.obj,n,["update","add","delete"]),i({name:t.member}),n},i.UI.unobserve=function(t){Object.observe&&Object.unobserve(t.obj,t.handler)},i.UI.observeProperty=function(t,e,n){if(e&&t&&n){t in e||(e[t]=void 0),i.UI.observables||(i.UI.observables={});var s,a=i.UI.observables;a[t]||(a[t]=[]);for(var o=0;o<a[t].length;o++){var r=a[t][o];r.obj==e&&(s=r)}s||(s={obj:e,value:e[t],listeners:[]},a[t].push(s)),s.listeners.push(n),n({obj:e,property:t,value:s.value}),Object.defineProperty(e,t,{enumerable:!0,get:function(){return s.value},set:function(i){if(s.value!==i){s.value=i;for(var n={obj:e,property:t,value:i},a=0;a<s.listeners.length;a++)s.listeners[a](n)}}})}},i.UI.unobserveProperty=function(t,e,n){if(t&&e&&i.UI.observables){var s=i.UI.observables[t];if(s){for(var a=s.length-1;a>=0;a--){var o=s[a];if(o.obj==e){if(n)for(var r=o.listeners,c=r.length;c>=0;c--)r[c]===n&&r.splice(c,1);n&&o.listeners.length||(Object.defineProperty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o.value}),s.splice(a,1))}}s.length||delete i.UI.observables[t]}}},i.UI.allContexts=function(){return s("cq-context,*[cq-context]")},i.UI.getMyContext=function(t){for(var e=s(t).parentsAndMe(),i=0;i<e.length;i++){var n=e[i];if(n.context)return n.context;if(n.CIQ&&n.CIQ.UI)return n.CIQ.UI.context}return null},i.UI.contextsForEach=function(t){i.UI.allContexts().each((function(){t.apply(this.CIQ.UI.context)}))},i.UI.release=!1,i.UI.bypassBindings=!1,i.UI.begin=function(t){i.UI.release=!0,setTimeout((function(){c.nextTick(),t&&t()}),0)},i.UI.addComponentDefinition=function(t,e){const n=!!i.UI.registerComponentsImmediately;i.UI._webcomponents||(i.UI._webcomponents={list:{},registered:n}),i.UI._webcomponents.list[t]={tag:t,classDefinition:e,registered:n},n&&customElements.define(t,e)},i.UI.registerComponents=function({except:t=[]}={}){if(!i.UI._webcomponents)return;const{list:e}=i.UI._webcomponents;Object.keys(e).filter((e=>!t.includes[e])).forEach((t=>{const i=e[t];i&&!i.registered&&(customElements.define(t,i.classDefinition),i.registered=!0)})),i.UI._webcomponents.registered=!0},i.UI.ensureComponentsRegistered=function(){i.UI._webcomponents&&!i.UI._webcomponents.registered&&i.UI.registerComponents()},i.UI.componentMarkup=function(t,e){const n=Object.values(i.UI._webcomponents.list).filter((({tag:e,classDefinition:i})=>!t||t===e||t===i.name||t===i));if(void 0===e){if(!n.length)return;const e=n.map(a);return t?e[0]:e}const[s]=n;if(s&&s.classDefinition.markup)return s.classDefinition.markup=e,a(s);function a(t){const{tag:e,registered:i,classDefinition:{markup:n,name:s}}=t;return{tag:e,name:s,registered:i,markup:n}}},i.UI.addInheritance=function(t,e){for(var i in e.prototype)try{t.prototype[i]=e.prototype[i]}catch(t){}};var o={};i.UI.supportedInputType=function(t){if(!o[t]){var e=document.createElement("input");e.setAttribute("type",t),o[t]=e.type}return o[t]};var r=i.UI.Context=function(t,e,n){this.params=n||{},this.stx=t,t&&(t.uiContext=this),e=this.topNode=s(e)[0],this.node=s(this.topNode),i.isMobile&&e.setAttribute("ciq-mobile","");var a=i.UI.Context.assembleContext(e);this.advertised={};for(var o=e.CIQ.UI.context=this,r=[],c=0;c<a.Components.length;c++)r.push(a.Components[c].tagName.toLowerCase());r.length&&this.topNode.querySelectorAll(r.join(",")).forEach((function(t){t.setContextPrivate(o)}))};r.assembleContext=function(t){return t.CIQ||(t.CIQ={}),t.CIQ.UI||(t.CIQ.UI={}),t.CIQ.UI.Components||(t.CIQ.UI.Components=[]),t.CIQ.UI},r.prototype.changeSymbol=function(t){console.log("Please implement CIQ.UI.Context.prototype.changeSymbol")},r.prototype.setLookupDriver=function(t){this.lookupDriver=t,t.deprecated&&console.warn("Using deprecated Lookup Driver, please see documentation: CIQ.ChartEngine.Driver.Lookup")},r.prototype.advertiseAs=function(t,e){this.advertised[e]=t},r.prototype.getAdvertised=function(t){return this.advertised[t]},r.prototype.setLoader=function(t){this.loader=t},r.prototype.isModal=function(){return""!==this.stx.openDialog};class c extends HTMLElement{constructor(){super(),this.node=s(this),this.eventListeners=[]}connectedCallback(){this.attached||(c.buildReverseBindings(this),this.attached=!0)}disconnectedCallback(){if(this.attached=!1,this.context)for(var t=0;t<this.eventListeners.length;t++)this.context.stx.removeEventListener(this.eventListeners[t])}addDefaultMarkup(t,e){const n=t||this;if((t=>0===t.children.length)(n)&&(n.constructor.markup||e)){const t=+new Date;if(n.innerHTML=e||n.constructor.markup,c.buildReverseBindings(n),i.debug){const e=+new Date-t;c.createMarkupTime=e+(c.createMarkupTime||0),console.log("Building markup "+this.constructor.name+" "+(this.getAttribute("cq-name")||"")+" built in="+e,"total="+c.createMarkupTime)}}}channelWrite(t,e,n){const{obj:s,prop:a}=i.UI.BaseComponent.getChannel(t,n,this);s&&(s[a]=e)}channelMergeObject(t,e,n){const{obj:s,prop:a}=i.UI.BaseComponent.getChannel(t,n,this);s&&(s[a]=Object.assign({},s[a],e))}channelRead(t,e){const{obj:n,prop:s}=i.UI.BaseComponent.getChannel(t,e,this);if(n)return n&&n[s]}channelSubscribe(t,e,n){const{obj:s,prop:a}=i.UI.BaseComponent.getChannel(t,n,this);if(s)return i.UI.observeProperty(a,s,o),()=>{i.UI.unobserveProperty(a,s,o)};function o({value:t}){e(t)}}qs(t,e){return"thisChart"===e&&(e=this.getContextContainer()),(e||document).querySelector(t)}qsa(t,e){return"thisChart"===e&&(e=this.getContextContainer()),Array.prototype.slice.call((e||document).querySelectorAll(t)||[])}getContextContainer(t){return t?c.selfOrParentElement(t,"cq-context"):(this.contextContainer||(this.contextContainer=c.selfOrParentElement(this,"cq-context")),this.contextContainer)}getChartContainer(t){return c.selfOrParentElement(t||this,"ciq-chart")}static getHelper(t,e,n){if(t){if(t=s(t)[0],!e&&!(e=t.getAttribute(n)))return null;var a,o=e.indexOf("("),r=e.substring(0,o),c=e.indexOf(".");if(-1==o||-1!=r.indexOf(".")){var l=-1===c?e:e.substring(0,c),h=t.context;if(h||(t.context||(t.context=i.UI.getMyContext(t)),h=t.context),!h)return console.log("No context attached to "+t.tagName+". A context is required when binding to a helper."),null;a=h.getAdvertised(l)}else for(var d=e.substring(0,o),u=s(t).parents(),p=0;p<u.length;p++){var m=u[p];if("function"==typeof m[d])return m}return a}}static activate(t,e,n,a){var o=a?"stxsetget":"stxtap",r=i.UI.splitMethod(t.getAttribute(o));if(r){var l=r.helperName,h=r.functionName;a&&(h="set"+h);var d=[{node:t,e:e,params:n}].concat(r.args);if(l){var u=c.getHelper(t,null,o);if(!u[h])return void console.log("Method '"+h+"' not found in helper",u);u[h].apply(u,d)}else for(var p=s(t).parents(),m=0;m<p.length;m++){var g=p[m];"function"==typeof g[h]&&g[h].apply(g,d)}}}makeTap(t,e){c.makeTap(t,e)}static makeTap(t,e){t.selectFC=e,s(t).stxtap(e)}static bind(t,e){console.warn("CIQ.UI.BaseComponent#bind will deprecated in a future release.\n If you to to bind anything use CIQ.UI.BaseComponent.bindNode() instead"),this.bindNode(t,e)}static bindNode(t,e){var n=(t=s(t)[0]).getAttribute("stxbind"),a=t.getAttribute("stxtap"),o=t.getAttribute("stxsetget");function r(e){var i,s=n.indexOf("(");i=n.substring(n.indexOf(".")+1),-1!==s&&(i=n.substring(0,s)),e&&e[i](t)}function l(t){return function(i){c.activate(t,i,e,!1)}}function h(n){function s(){return function(i){c.activate(t,i,e,!0)}}var a=i.UI.splitMethod(o);if(a){var r=[t].concat(a.args).concat(e),l="get"+a.functionName;n&&n[l]&&n[l].apply(n,r),"text"===t.type||"number"===t.type?c.inputEntry(t,s()):c.makeTap(t,s())}else console.log("Syntax error "+o)}n&&""!==n&&r(c.getHelper(t,n,"stxbind")),a&&""!==a&&("INPUT"!=t.tagName||"text"!==t.type&&"number"!==t.type?c.makeTap(t,l(t)):c.inputEntry(t,l(t))),o&&h(c.getHelper(t,o,"stxsetget"))}static scheduleForBinding(t,e){c.scheduledBindings.push({node:t,parentTag:e}),c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout(c.nextTick,0)}inputEntry(t,e){c.inputEntry(t,e)}static inputEntry(t,e){s(t).on("keypress",(function(t){switch(t.which){case 13:case 9:e()}}))}addClaim(t){a.push({helper:t})}removeClaim(t){for(var e=0;e<a.length;e++)if(a[e].helper===t)return void a.splice(e,1)}static buildReverseBindings(t){if(!i.UI.bypassBindings){var e,n=function(t){if(t.hasAttribute("stxbind")||t.hasAttribute("stxtap")||t.hasAttribute("stxsetget"))return NodeFilter.FILTER_ACCEPT},s=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,i.isIE?n:{acceptNode:n},!1);for(e=s.nextNode();e;)c.scheduleForBinding(e,t),e=s.nextNode()}}static nextTick(){if(i.UI.release){clearTimeout(c.timeout);for(var t=c.scheduledBindings,e=t.length-1;e>=0;e--){var n=t[e];n.node.ciqAlreadyBound||(c.bindNode(n.node,{parent:n.parentTag}),n.node.ciqAlreadyBound=!0)}}}static selfOrParentElement(t,e){let i=t;for(;i;){if(i.classList.contains(e)||null!==i.getAttribute(e)||i.nodeName.toLowerCase()===e)return i;i=i.parentElement}}static toPropAndObject(t,e){const i=t.split(".");return{prop:i.pop(),obj:i.reduce(((t,e)=>void 0!==t[e]?t[e]:t[e]={}),e)}}static getChannel(t,e,n){if(!t)return console.warn("Missing channel path"),{};if(!e&&!n)return console.warn("Chart engine not provided while retrieving ",t),{};e||n.stx||(n.container||(n.container=i.UI.getMyContext(n)),n.stx=n.container.stx);const{obj:s,prop:a}=c.toPropAndObject(t,e||n.stx);return{obj:s,prop:a}}}c.scheduledBindings=[],i.UI.BaseComponent=c;class l extends c{constructor(){super(),this.injections=[]}connectedCallback(){this.attached||(this.setContextHolder(),super.connectedCallback())}disconnectedCallback(){if(this.context){var t;for(t=0;t<this.injections.length;t++)this.context.stx.removeInjection(this.injections[t]);for(this.injections=[],t=0;t<this.eventListeners.length;t++)this.context.stx.removeEventListener(this.eventListeners[t]);this.eventListeners=[]}}setContextHolder(){var t=this.node.parents("cq-context,*[cq-context]");if(t.length){var e=t[0],i=r.assembleContext(e);i.Components.push(this),i.context&&this.setContextPrivate(i.context)}else console.log("No cq-context found for "+this.tagName)}setContext(t){}setContextPrivate(t){var e,n;this.context=t,this.uiManager=i.UI.getUIManager(),this.hasAttribute("cq-marker")&&!this.convertedToMarker&&(this.convertedToMarker=!0,this.marker=new i.Marker({stx:t.stx,node:this,xPositioner:"none",yPositioner:"none",label:"component",permanent:!0})),setTimeout((e=this,n=t,function(){e.setContext(n)}))}addInjection(t,e,i){this.injections.push(this.context.stx[t](e,i))}}i.UI.ContextTag=l;class h extends l{constructor(){super()}connectedCallback(){if(!this.attached){s(this);this.onpointerover=function(){this.modalBegin()},this.onpointerout=function(){this.modalEnd()},super.connectedCallback()}}modalBegin(){this.context&&this.context.stx.modalBegin()}modalEnd(){this.context&&(this.uiManager.activeMenuStack.length||this.context.stx.modalEnd())}}i.UI.ModalTag=h;class d extends c{constructor(){super()}close(){this.node.parents("cq-dialog")[0].close(),this.node.find("cq-swatch").each((function(){this.colorPicker&&this.colorPicker.close()}))}open(t){t&&t.context&&this.setContext(t.context);var e=this.tagName.toLowerCase();this.node.closest("cq-dialog,cq-menu").each((function(){this.addActiveAttribute(e),this.open(t)}))}setContext(t){this.node.find("[stxtap],[stxbind],[stxsetget]").each((function(){this.context=t})),this.context=t}}i.UI.DialogContentTag=d,i.UI.Helper=function(t,e){this.node=t,this.context=e,this.injections=[]},i.UI.Helper.prototype.addInjection=function(t,e,i){this.injections.push(this.context.stx[t](e,i))},i.UI.Helper.prototype.destroy=function(){for(var t=0;t<this.injections.length;t++)this.context.stx.removeInjection(this.injections[t]);this.injections=[]},i.UI.Lookup=function(){},i.UI.Lookup.Driver=function(){this.deprecated=!0},i.UI.Lookup.Driver.prototype.acceptText=function(t,e,i,n){this.cb},i.UI.Lookup.Driver.ChartIQ=function(t){this.exchanges=t,this.exchanges||(this.exchanges=["XNYS","XASE","XNAS","XASX","INDCBSX","INDXASE","INDXNAS","IND_DJI","ARCX","INDARCX","forex"]),this.url="https://symbols.chartiq.com/chiq.symbolserver.SymbolLookup.service",this.requestCounter=0},i.inheritsFrom(i.UI.Lookup.Driver.ChartIQ,i.UI.Lookup.Driver),i.UI.Lookup.Driver.ChartIQ.prototype.acceptText=function(t,e,n,s){"FX"==e&&(e="FOREX"),isNaN(parseInt(n,10))&&(n=100);var a=this.url+"?t="+encodeURIComponent(t)+"&m="+n+"&x=[";this.exchanges&&(a+=this.exchanges.join(",")),a+="]",e&&"ALL"!=e.toUpperCase()&&(a+="&e="+e);var o=++this.requestCounter,r=this;function c(t,e){if(!(o<r.requestCounter)&&200==t)try{for(var i=(e=JSON.parse(e)).payload.symbols,n=[],a=0;a<i.length;a++){var c=i[a].split("|"),l={symbol:c[0],name:c[1],exchDisp:c[2]};n.push({display:[l.symbol,l.name,l.exchDisp],data:l})}s(n)}catch(t){}}i.postAjax({url:a,cb:c})},i.Marker&&(i.Marker.HeadsUp=function(t,e){this.className||(this.className="CIQ.Marker.HeadsUp"),i.Marker.call(this,t),this.prevTick=null,this.showClass=e},i.inheritsFrom(i.Marker.HeadsUp,i.Marker,!1),i.Marker.HeadsUp.placementFunction=function(t){function e(t,e,i,n){return Math.round(i-t.pixelFromPrice(n,e))}var i=t.panel,n=i.chart,a=t.stx,o=a.chart.highLowBars||a.highLowBars[a.layout.chartType];t.showClass||(t.showClass="stx-show");for(var r=0;r<t.arr.length;++r){var c=t.arr[r],l=s(c.node);if(i.hidden||!a.insideChart)return void l.removeClass(t.showClass);if(c.params.x<0||c.params.x>=n.dataSet.length)return void l.removeClass(t.showClass);if(a.layout.crosshair||a.currentVectorParameters.vectorType)return void l.removeClass(t.showClass);var h,d=n.dataSet[c.params.x],u=a.pixelFromTick(c.params.x);if(!d||u<n.left||u>n.right)return void l.removeClass(t.showClass);if(!d[a.chart.defaultPlotField]&&0!==d[a.chart.defaultPlotField])return void l.removeClass(t.showClass);l.addClass(t.showClass),c.clientWidth||(c.clientWidth=l.width()),c.clientHeight||(c.clientHeight=l.height()),c.clientWidth>u?(l.removeClass("stx-left"),l.addClass("stx-right"),l.css({left:u+"px",right:"auto"})):(l.addClass("stx-left"),l.removeClass("stx-right"),l.css({right:a.chart.canvasWidth-u+"px",left:"auto"}));var p=c.params.chartContainer?a.chart.canvasHeight:i.bottom;p-(h=e(a,i,p,o?a.getBarBounds(d)[i.yAxis.flipped?"low":"high"]:d[a.chart.defaultPlotField]))-c.clientHeight+a.top<0?(l.addClass("stx-below"),h=(o?e(a,i,p,a.getBarBounds(d).low):h)-c.clientHeight):l.removeClass("stx-below");var m=h+"px";c.node.style.bottom!=m&&(c.node.style.bottom=m)}});function u(t,e){var i=e.stx,n=s(t||e.topNode);this.node=n[0],this.context=e,this.editing=null,this.drawingContext=s("cq-drawing-context"),this.cvpController=n.find("cq-cvp-controller"),this.toolbar=n.find("cq-toolbar"),this.toolbar.length||(this.toolbar=n.find("cq-drawing-settings")),this.toolbar.on("change",p(i,this)),this.count=i.drawingObjects.length,e.advertiseAs(this,"DrawingEdit"),i.addEventListener("drawing",m(this)),i.addEventListener("drawingEdit",g(this)),n.find("cq-toolbar .ciq-drawing-edit-only:has(.ciq-btn)").hover(f(i,this))}function p(t,e){return function(){e.editing&&(e.editing.name===t.currentVectorParameters.vectorType?(e.editing.copyConfig(),t.draw(),t.changeOccurred("vector")):e.endEdit(null,"tool"))}}function m(t){return function(e){var i=e.drawings.length;t.count!==i&&(t.endEdit(null,"count"),t.count=i)}}function g(t){return function(e){!0===e.forceEdit?(t.endEdit(null,"edit"),t.showToolbar(e.drawing),t.beginEdit(e.drawing)):t.showContext(e)}}function f(t,e){return function(i){var n="mouseenter"===i.type;e.editing&&e.editing.highlighted!==n&&(e.editing.highlighted=n,t.draw())}}i.UI.HeadsUp=function(t,e,i){this.params=i||{},void 0===this.params.autoStart&&(this.params.autoStart=!0),this.node=s(t),this.node.detach(),this.context=e,this.injections=[],this.maxVolume={lastCheckDate:null,value:0},this.params.autoStart&&this.begin()},i.inheritsFrom(i.UI.HeadsUp,i.UI.Helper),i.UI.HeadsUp.prototype.begin=function(){var t,e;this.injections.length||(this.params.followMouse?(this.node.css({top:"auto"}),t={stx:this.context.stx,label:"headsup",xPositioner:"bar",chartContainer:!0,x:0,node:this.node[0]},this.marker=new i.Marker.HeadsUp(t,this.params.showClass),this.addInjection("append","handleMouseOut",(e=this,function(){e.followMouse(-1)}))):this.params.staticNode||(this.node.css({top:"",left:""}),t={stx:this.context.stx,label:"headsup",xPositioner:"none",chartContainer:!1,node:this.node[0]},s.extend(t,this.params),this.marker=new i.Marker(t)),i.isMobile&&(this.context.stx.layout.crosshair=!0),this.calculateMaxVolume(),this.addInjection("prepend","headsUpHR",function(t){return function(){t.position()}}(this)),this.addInjection("append","createXAxis",function(t){return function(){t.position()}}(this)),this.addInjection("append","createDataSet",function(t){return function(e,i,n){t.calculateMaxVolume(n.appending)}}(this)))},i.UI.HeadsUp.prototype.end=function(){i.isMobile&&(this.context.stx.layout.crosshair=!1),this.marker&&this.marker.remove(),this.destroy(),this.marker=null},i.UI.HeadsUp.prototype.calculateMaxVolume=function(t){t||(this.maxVolume={lastCheckDate:null,value:0});var e=this.context.stx.chart.dataSet;if(e&&e.length){for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.DT<this.maxVolume.lastCheckDate)break;n.Volume>this.maxVolume.value&&(this.maxVolume.value=n.Volume)}this.maxVolume.lastCheckDate=e[e.length-1].DT}},i.UI.HeadsUp.prototype.position=function(){var t=this.context.stx,e=t.barFromPixel(t.cx);this.tick=t.tickFromPixel(t.cx);var n=t.chart.xaxis[e],s=t.chart.defaultPlotField,a=t.chart.highLowBars||t.highLowBars[t.layout.chartType];s&&!a||(s="Close");var o=this.node,r=this;function c(e){var i=t.layout.chartScale,n=t.chart.panel,s=t.chart.yAxis;return(s.originalPriceFormatter&&s.originalPriceFormatter.func?s.originalPriceFormatter.func(t,n,e):s.priceFormatter&&"percent"!=i&&"relative"!=i?s.priceFormatter(t,n,e):t.formatYAxisPrice(e,n)).replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1")}function l(){function e(t){return i.isValidNumber(parseFloat(t))?t:"N/A"}if(r.timeout=null,o.find("cq-hu-price").text("N/A"),o.find("cq-hu-open").text("N/A"),o.find("cq-hu-close").text("N/A"),o.find("cq-hu-high").text("N/A"),o.find("cq-hu-low").text("N/A"),o.find("cq-hu-date").text("N/A"),o.find("cq-hu-volume").text("N/A"),o.find("cq-volume-rollup").text(""),n&&n.data){var a=i.clone(n.data);void 0===a.Open&&(a.Open=a.Close),void 0===a.High&&(a.High=Math.max(a.Open,a.Close)),void 0===a.Low&&(a.Low=Math.min(a.Open,a.Close)),o.find("cq-hu-open").text(e(c(a.Open))),o.find("cq-hu-price").text(e(c(a[s]))),o.find("cq-hu-close").text(e(c(a.Close))),o.find("cq-hu-high").text(e(c(a.High))),o.find("cq-hu-low").text(e(c(a.Low)));var l=i.condenseInt(a.Volume),h=l.charAt(l.length-1);h>"9"&&(l=l.substring(0,l.length-1),o.find("cq-volume-rollup").text(h.toUpperCase())),o.find("cq-hu-volume").text(l);var d=a.displayDate;d||(d=a.DT),t.internationalizer?i.ChartEngine.isDailyInterval(t.layout.interval)?o.find("cq-hu-date").text(t.internationalizer.yearMonthDay.format(d)):o.find("cq-hu-date").text(t.internationalizer.yearMonthDay.format(d)+" "+t.internationalizer.hourMinute.format(d)):i.ChartEngine.isDailyInterval(t.layout.interval)?o.find("cq-hu-date").text(i.mmddyyyy(i.yyyymmddhhmm(d))):o.find("cq-hu-date").text(i.mmddhhmm(i.yyyymmddhhmmssmmm(d)));var u=o.find("cq-volume-visual");if(u.length){var p=r.maxVolume.value?a.Volume/r.maxVolume.value:0;u.css({width:Math.round(100*p)+"%"})}}}if(this.tick!=this.prevTick||n&&+n.DT==+t.chart.endPoints.end){this.timeout&&clearTimeout(this.timeout);var h=(this.params.followMouse,0);this.timeout=setTimeout(l,h)}this.prevTick=this.tick,this.params.followMouse&&(t.openDialog&&(this.tick=-1),this.followMouse(this.tick))},i.UI.HeadsUp.prototype.followMouse=function(t){this.marker.params.x=t,this.marker.render()},i.UI.DrawingEdit=u,i.inheritsFrom(u,i.UI.Helper),u.prototype.showContext=function(t){t.context=this.context,t.x=i.ChartEngine.crosshairX,t.y=i.ChartEngine.crosshairY,this.count=this.context.stx.drawingObjects.length,this.drawingContext.each((function(){this.open(t)}))},u.prototype.getToolActivator=function(t){var e=this.toolbar.find('cq-item[cq-tool="'+t+'"]');return e.length||(e=this.toolbar.find("cq-item[stxtap=\"tool('"+t+"')\"]")),{node:e[0]}},u.prototype.showToolbar=function(t){var e=this,n=e.getToolActivator(t.name);e.node;this.toolbar.each((function(){var s=t.lineWidth,a=t.pattern,o=t.parameters&&t instanceof i.Drawing.fibonacci;o&&(s=t.parameters.fibs[0].parameters.lineWidth,a=t.parameters.fibs[0].parameters.pattern),this.tool(n,t.name),this.sync({lineWidth:s,pattern:a,annotation:{font:t.font?i.clone(t.font):{}},fillColor:t.fillColor,currentColor:t.color,axisLabel:t.axisLabel}),e.cvpController.each((function(){this.sync(t)})),o&&(this.context.stx.currentVectorParameters.fibonacci=i.clone(t.parameters))}))},u.prototype.beginEdit=function(t){this.editing=t,this.beforeEdit=t.serialize(),this.toolbar.attr("cq-drawing-edit",t.name);var e=new CustomEvent("drawing-edit-begin",{bubbles:!0,cancelable:!0,detail:{drawing:t,tool:t.name}});this.node.dispatchEvent(e)},u.prototype.endEdit=function(t,e){var i=this.context.stx,n=null,s=null;if(this.editing){s=this.editing.name,n=new CustomEvent("drawing-edit-end",{bubbles:!0,cancelable:!0,detail:{action:e,drawing:this.editing,tool:s}});var a=i.drawingObjects.indexOf(this.editing),o=i.exportDrawings();a>-1&&this.beforeEdit&&(o[a]=this.beforeEdit,i.undoStamp(o,i.exportDrawings())),"close"===e&&this.editing.highlighted&&(this.editing.highlighted=!1,i.draw())}this.editing=null,this.beforeEdit=null,this.toolbar.attr("cq-drawing-edit","none"),s&&"close"===e&&(t=this.getToolActivator(s),this.toolbar.each((function(){this.tool(t,s)}))),n&&this.node.dispatchEvent(n)},u.prototype.edit=function(){var t=this;this.drawingContext.each((function(){var e=i.UI.getMyContext(this.drawing.stx.container).topNode,n=document.querySelector("cq-drawing-context").parentNode,s=e.querySelector("cq-drawing-settings"),a={left:n.offsetLeft,top:n.offsetTop};this.close(),t.endEdit(null,"edit"),t.showToolbar(this.drawing,a),t.beginEdit(this.drawing),s&&s.detach(a.left,a.top)}))},u.prototype.text=function(){var t=this;this.drawingContext.each((function(){this.close(),t.endEdit(null,"text"),this.drawing.edit&&this.drawing.edit(null,!0)}))},u.prototype.clone=function(){var t=this,e=this.context.stx;this.endEdit(null,"clone"),this.drawingContext.each((function(){this.close();var n=new i.Drawing[this.drawing.name],s=this.drawing.serialize();n.reconstruct(e,s),n.repositioner=this.drawing.repositioner,n.highlighted=!0,this.drawing.highlighted=!1,t.count+=1,e.addDrawing(n),e.activateRepositioning(n)}))},u.prototype.reorderLayer=function(t,e){var i=this.context.stx;this.endEdit(null,"reorderLayer"),this.drawingContext.each((function(){this.close();var t=i.drawingObjects.length-1,n=i.drawingObjects.indexOf(this.drawing),s=NaN;if(-1!==n){switch(e){case"up":n<t&&(s=n+1);break;case"down":n>0&&(s=n-1);break;case"top":n<t&&(s=t);break;case"bottom":n>0&&(s=0)}if(s==s){var a=i.exportDrawings();i.drawingObjects.splice(n,1),i.drawingObjects.splice(s,0,this.drawing),i.undoStamp(a,i.exportDrawings()),i.draw(),i.changeOccurred("vector")}}}))},u.prototype.remove=function(){var t=this,e=this.context.stx;this.endEdit(null,"remove"),this.drawingContext.each((function(){if(!this.drawing.permanent){var i=e.exportDrawings();t.count-=1,e.removeDrawing(this.drawing),e.undoStamp(i,e.exportDrawings()),this.close()}}))},i.UI.StudyEdit=function(t,e){this.context=e,this.node=t||e.topNode,this.contextDialog=[];for(var i=document.querySelectorAll("cq-study-context"),n=0;n<i.length;n++)this.contextDialog.push(i[n]);e.advertiseAs(this,"StudyEdit"),this.initialize()},i.inheritsFrom(i.UI.StudyEdit,i.UI.Helper),i.UI.StudyEdit.prototype.remove=function(){i.Studies.removeStudy(this.params.stx,this.params.sd),this.contextDialog.forEach((function(t){t.close()}))},i.UI.StudyEdit.prototype.edit=function(){this.contextDialog.forEach((function(t){t.close()})),this.editPanel(this.params)},i.UI.StudyEdit.prototype.editPanel=function(t){t.context=this.context,t.x=null,t.y=null;const{channelWrite:e}=i.UI.BaseComponent.prototype;this.context.config?e(this.context.config.channels.dialog,{type:"study",params:t},this.context.stx):document.querySelector("cq-study-dialog").open(t)},i.UI.StudyEdit.prototype.editOverlay=function(t){this.params=t,t.context=this.context,t.forceEdit?this.editPanel(t):this.contextDialog.forEach((function(e){t.x=i.ChartEngine.crosshairX,t.y=i.ChartEngine.crosshairY,e.open(t)}))},i.UI.StudyEdit.prototype.initialize=function(){var t=this.context.stx,e=this;function i(t){return function(){t.apply(e,arguments)}}t.addEventListener("studyOverlayEdit",i(e.editOverlay)),t.addEventListener("studyPanelEdit",i(e.editPanel))},i.UI.Layout=function(t,e){this.params=e||{},this.params.activeClassName||(this.params.activeClassName="ciq-active"),this.context=t,t.advertiseAs(this,"Layout")},i.inheritsFrom(i.UI.Layout,i.UI.Helper),i.UI.Layout.prototype.getChartType=function(t,e){var n=this.context.stx,s=this.params.activeClassName,a=function(i){var n=i.obj;n.aggregationType&&"ohlc"!=n.aggregationType?e!==n.aggregationType?t.classList.remove(s):t.classList.add(s):e!==n.chartType?t.classList.remove(s):t.classList.add(s)};i.UI.observeProperty("chartType",n.layout,a),i.UI.observeProperty("aggregationType",n.layout,a)},i.UI.Layout.prototype.setChartType=function(t,e){({heikinashi:!0,kagi:!0,linebreak:!0,pandf:!0,rangebars:!0,renko:!0})[e]?this.context.stx.setAggregationType(e):this.context.stx.setChartType(e)},i.UI.Layout.prototype.getChartScale=function(t,e){var n=this.context.stx,s=this.params.activeClassName,a=function(i){i.value==e?t.classList.add(s):t.classList.remove(s)};i.UI.observeProperty("chartScale",n.layout,a)},i.UI.Layout.prototype.setChartScale=function(t,e){var i=this.context.stx,n=i.layout.chartScale;n==e?i.setChartScale(null):n&&"linear"!=n||i.setChartScale(e)},i.UI.Layout.prototype.getFlippedChart=function(t){var e=this.context.stx,n=this.params.activeClassName,s=function(e){e.value?t.classList.add(n):t.classList.remove(n)};i.UI.observeProperty("flipped",e.layout,s)},i.UI.Layout.prototype.setFlippedChart=function(t){var e=this.context.stx;e.flipChart(!e.layout.flipped)},i.UI.Layout.prototype.getExtendedHours=function(t){var e=this.context.stx,n=this.params.activeClassName,s=function(e){e.value?t.classList.add(n):t.classList.remove(n)};i.UI.observeProperty("extended",e.layout,s)},i.UI.Layout.prototype.setExtendedHours=function(t){var e=this.context.stx;if(e.layout.extended=!e.layout.extended,e.changeOccurred("layout"),!e.layout.extended||e.chart.market.market_def&&e.chart.market.sessions.length||i.alert("There are no Extended Hours for this instrument."),e.extendedHours){var n=this.context.loader;n&&n.show(),e.extendedHours.set(e.layout.extended,null,(function(){n&&n.hide()}))}},i.UI.Layout.prototype.getRangeSlider=function(t){var e=this.context.stx,n=this.params.activeClassName,s=function(e){e.value?t.classList.add(n):t.classList.remove(n)};i.UI.observeProperty("rangeSlider",e.layout,s)},i.UI.Layout.prototype.setRangeSlider=function(t){var e=this.context.stx;e.layout.rangeSlider=!e.layout.rangeSlider,e.slider&&e.slider.display(e.layout.rangeSlider),e.changeOccurred("layout")},i.UI.Layout.prototype.getOutliers=function(t){var e=this.context.stx,n=this.params.activeClassName,s=function(e){e.value?t.classList.add(n):t.classList.remove(n)};i.UI.observeProperty("outliers",e.layout,s)},i.UI.Layout.prototype.setOutliers=function(t){var e=this.context.stx;e.layout.outliers=!e.layout.outliers,e.draw(),e.changeOccurred("layout")},i.UI.Layout.prototype.getAggregationType=function(t,e){var n=this.context.stx,s=this.params.activeClassName,a=function(i){i.value==e?t.classList.add(s):t.classList.remove(s)};i.UI.observeProperty("aggregationType",n.layout,a)},i.UI.Layout.prototype.setAggregationType=function(t,e){this.context.stx.layout.aggregationType==e?this.context.stx.setAggregationType(null):this.context.stx.setAggregationType(e)},i.UI.Layout.prototype.getAggregationEdit=function(t,e){var n=this.context.stx,s=i.deriveFromObjectChain(n.layout,e),a=function(e){var i=e.value;!i&&n.chart.defaultChartStyleConfig[t.name]?t.value=n.chart.defaultChartStyleConfig[t.name]:t.value=i};i.UI.observeProperty(s.member,s.obj,a)},i.UI.Layout.prototype.setAggregationEdit=function(t,e){var n=this.context.stx;function a(){n.changeOccurred("layout"),n.createDataSet(),n.draw()}if("auto"===e){"kagi"===n.layout.aggregationType?n.layout.kagi=null:"renko"===n.layout.aggregationType?n.layout.renko=null:"linebreak"===n.layout.aggregationType?n.layout.priceLines=null:"rangebars"===n.layout.aggregationType?n.layout.rangebars=null:"pandf"===n.layout.aggregationType&&(n.layout.pandf||(n.layout.pandf={box:null,reversal:null}),n.layout.pandf.box=null,n.layout.pandf.reversal=null),a();var o=s(t).offsetParent();s(o).find(".ciq"+n.layout.aggregationType+" input").each((function(){var t=this.name;"box"!=t&&"reversal"!=t||(t="pandf."+t);var e=i.deriveFromObjectChain(n.layout,t);e&&!e.obj[e.member]&&n.chart.defaultChartStyleConfig[this.name]&&s(this).val(n.chart.defaultChartStyleConfig[this.name])}))}else{var r=i.deriveFromObjectChain(n.layout,e);r.obj[r.member]=s(t.node).val(),a()}},i.UI.Layout.prototype.showAggregationEdit=function(t,e){const{context:n}=this;if(n.config){const{channelWrite:t}=i.UI.BaseComponent.prototype;t(n.config.channels.dialog,{type:"aggregation",params:{context:n,aggregationType:e}},n.stx)}else{document.querySelector("cq-aggregation-dialog").open({context:this.context,aggregationType:e})}},i.UI.Layout.prototype.clearStudies=function(t){var e=this.context.stx;for(var n in e.layout.studies){var s=e.layout.studies[n];s.customLegend||s.permanent||i.Studies.removeStudy(e,s)}e.draw()},i.UI.Layout.prototype.setPeriodicity=function(t,e,i,n){var s=this;s.context.loader&&s.context.loader.show(),s.context.stx.setPeriodicity({period:e,interval:i,timeUnit:n},(function(){s.context.loader&&s.context.loader.hide()}))},i.UI.Layout.prototype.showPeriodicity=function(t,e){var n="",{period:a,interval:o,timeUnit:r}=t.getPeriodicity();n=a*=o,"day"==r?n+="D":"week"==r?n+="W":"month"==r?n+="M":"second"==r?n+="s":"millisecond"==r?n+="ms":a>=60&&a%15==0?n=a/60+"H":"tick"==r?n=(a>1?a:"")+"T":n+="m",s(e.selector).empty().append(i.translatableTextNode(t,n))},i.UI.Layout.prototype.periodicity=function(t){var e=this,n=this.context.stx,s=function(i){e.showPeriodicity(n,{selector:t})};i.UI.observeProperty("interval",n.layout,s),i.UI.observeProperty("periodicity",n.layout,s),i.UI.observeProperty("timeUnit",n.layout,s)},i.UI.Layout.prototype.setLanguage=function(){const{config:t,stx:e}=this.context;if(t){const{channelWrite:n}=i.UI.BaseComponent.prototype;n(t.channels.dialog,{type:"language"},e)}else document.querySelector("cq-language-dialog").open()},i.UI.Layout.prototype.getLanguage=function(t){this.context.stx;var e=function(e){i.I18N.languages||(i.I18N.languages={en:"English"}),s(t).find("cq-language-name").text(i.I18N.languages[i.I18N.language]),s(t).find("cq-flag").attr("cq-lang",i.I18N.language)};i.UI.observeProperty("language",i.I18N,e)},i.UI.Markers=function(t,e){this.context=t,e||(e={}),this.menuItemSelector=e.menuItemSelector,this.activeClassName=e.activeClassName||"ciq-active",this.implementation=e.implementation,t.advertiseAs(this,"Markers")},i.inheritsFrom(i.UI.Markers,i.UI.Helper),i.UI.Markers.prototype.showMarkers=function(t,e,i){var n=this.activeClassName,a=this.topNode,o=this.implementation;o&&(o.showMarkers(),e&&o.showMarkers(e,i),s(this.menuItemSelector,a).each((function(){var e=s(this).find(".ciq-checkbox");t.node==this?s(this).addClass(n):e.length<1&&s(this).removeClass(n)})))},i.UI.Keystroke=function(t){this.cb=t,this.shift=!1,this.ctrl=!1,this.cmd=!1,this.capsLock=!1,this.downValue="",this.initialize()},i.UI.Keystroke.noKeyCapture=!1,i.UI.Keystroke.prototype.androidWorkaroundKeyup=function(t){var e,i=t.target.value;i.length>this.downValue.length?(e=i.charAt(i.length-1),t.which=e.charCodeAt(0)):e="Delete",this.key=e,this.cb({key:e,e:t,keystroke:this})},i.UI.Keystroke.prototype.keyup=function(t){if(this.implementAndroidWorkaround)return this.androidWorkaroundKeyup(t),void(this.implementAndroidWorkaround=!1);switch(t.key){case"Shift":return this.shift=!1,void this.cb({key:t.key,e:t,keystroke:this});case"Control":case"Alt":return this.ctrl=!1,void this.cb({key:t.key,e:t,keystroke:this});case"Meta":case"Win":return this.cmd=!1,void this.cb({key:t.key,e:t,keystroke:this})}this.key&&this.cb({key:this.key,e:t,keystroke:this})},i.UI.Keystroke.prototype.keydown=function(t){if(!this.noKeyCapture)if(229==t.which&&i.isAndroid)this.implementAndroidWorkaround=!0;else switch(this.key=t.key,t.key){case"Meta":case"Win":this.cmd=!0;break;case"Shift":this.shift=!0;break;case"Control":case"Alt":this.ctrl=!0;break;case"CapsLock":this.capsLock=!this.capsLock;break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"Up":case"Down":case"Left":case"Right":this.key=null,this.cb({key:t.key,e:t,keystroke:this})}},i.UI.Keystroke.prototype.keypress=function(t){if(!this.noKeyCapture){var e=t.which;e<32||e>222||(this.key=t.key)}},i.UI.Keystroke.prototype.initialize=function(){var t=this;s(document).on("keyup",(function(e){t.keyup(e)})),s(document).on("keydown",(function(e){t.downValue=e.target.value,t.keydown(e)})),s(document).on("keypress",(function(e){t.keypress(e)})),s(window).on("blur",(function(e){t.ctrl=!1,t.cb({key:"Control",e:e,keystroke:t})}))},i.UI.KeystrokeHub=function(t,e,n){t=s(t||"document"),this.infocus=!1;var a=this;function o(){return function(){a.handler.apply(a,arguments)}}t[0]===document||t[0]===document.body||t[0]===window?this.infocus=!0:(t.on("mouseout",(function(){a.infocus=!1})),t.on("mouseover",(function(){a.infocus=!0}))),this.node=t,this.context=e,this.params=n||{},this.uiManager=i.UI.getUIManager(),this.uiManager.keystrokeHub=this,this.keystroke=new i.UI.Keystroke(o())},i.inheritsFrom(i.UI.KeystrokeHub,i.UI.Helper),i.UI.KeystrokeHub.defaultHotKeys=function(t,e){var n=e.context.stx,s=1;switch(t){case"ArrowUp":case"Up":n.allowZoom&&n.zoomIn();break;case"ArrowDown":case"Down":n.allowZoom&&n.zoomOut();break;case"Home":n.home(),n.headsUpHR();break;case"End":n.chart.scroll=n.chart.dataSet.length,n.draw(),n.headsUpHR();break;case"ArrowLeft":case"Left":n.ctrl?n.allowZoom&&n.zoomOut():n.allowScroll&&(s=1,(n.shift||e.capsLock)&&(s=Math.max(5,5*(8-Math.round(n.layout.candleWidth)))),n.chart.scroll+s>=n.chart.dataSet.length&&(s=n.chart.dataSet.length-n.chart.scroll),n.chart.scroll+=s,n.draw(),n.headsUpHR());break;case"ArrowRight":case"Right":n.ctrl?n.allowZoom&&n.zoomIn():n.allowScroll&&(s=1,(n.shift||e.capsLock)&&(s=Math.max(5,5*(8-Math.round(n.layout.candleWidth)))),n.chart.scroll-=s,n.draw(),n.headsUpHR());break;case"Delete":case"Backspace":case"Del":if(i.ChartEngine.drawingLine)n.undo();else{if(!n.anyHighlighted)return!1;n.deleteHighlighted()}break;case"Escape":case"Esc":i.ChartEngine.drawingLine?n.undo():e.uiManager&&e.uiManager.closeMenu();break;default:return!1}return!0},i.UI.KeystrokeHub.prototype.setActiveContext=function(t){this.context=t},i.UI.KeystrokeHub.prototype.processKeyStrokeClaims=function(t,e,i,n){for(var s=a.length-1;s>-1;s--){var o=a[s].helper.keyStroke(t,e,i,n);if(o)return o.allowDefault||i.preventDefault(),!0}return!1},i.UI.KeystrokeHub.prototype.handler=function(t){var e=this.context.stx;if(!e.editingAnnotation&&this.infocus){var n=t.e,s=t.key,a=t.keystroke,o=t.e.target.tagName;switch(s){case"Shift":e.shift=a.shift;break;case"Control":case"Alt":e.ctrl=a.ctrl;break;case"Meta":case"Win":e.cmd=a.cmd;break;case"CapsLock":this.capsLock=!this.capsLock}!i.ChartEngine.drawingLine&&this.processKeyStrokeClaims(this,s,n,a)||"Escape"!=n.key&&"Esc"!=n.key&&this.context.isModal()||"INPUT"!=o&&"TEXTAREA"!=o&&this.params.cb&&this.params.cb(s,this)&&n.preventDefault()}};class v extends HTMLElement{constructor(){super(),this.activeMenuStack=[],this.registeredForResize=[],this.keystrokehub=null,i.installTapEvent(s("body")[0],{preventUnderlayClick:!1});var t=this;function e(){t.closeTopMenu()}s("body").on("stxtap",e)}connectedCallback(){var t=this;this.resize=function(){for(var e=t.registeredForResize,i=0;i<e.length;i++)"function"==typeof e[i].resize&&e[i].resize()},window.addEventListener("resize",this.resize),document.body.contains(this)&&(i.UI.registerComponentsImmediately=!0,i.UI.ensureComponentsRegistered())}disconnectedCallback(){window.removeEventListener("resize",this.resize)}closeMenu(t){var e=this.activeMenuStack,i=s(t).parents("cq-menu"),n=[];if(t){n.push(t);for(var a=0;a<i.length;a++){var o=i[a];o.active&&n.push(o)}}else n=e;for(var r=0;r<n.length;r++)n[r].hide();this.activeMenuStack=e.filter((function(t){return t.active})),this.ifAllClosed()}closeTopMenu(){var t=this.activeMenuStack;if(t.length){var e=t[t.length-1],i=this;e.isDialog&&!e.active||(t.pop(),e.hide(),e.onClose&&e.onClose(),setTimeout((function(){i.ifAllClosed()}),0));var n=e.getAttribute("cq-close-top");n&&s(e).parents(n).each((function(){i.closeMenu(this)}))}}findLifts(t){return s(t).find("*[cq-lift]").filter((function(){var e=s(this).closest("cq-menu,cq-dialog");return e.length&&e[0]==t}))}ifAllClosed(){this.activeMenuStack.length||s("cq-context,*[cq-context]").each((function(){this.CIQ&&this.CIQ.UI&&this.CIQ.UI.context&&this.CIQ.UI.context.stx&&this.CIQ.UI.context.stx.modalEnd()}))}lift(t){var e=s(t);if(e.length){var i=s(e)[0];i.remember={parentNode:i.parentNode,css:{position:i.style.position,display:i.style.display,left:i.style.left,top:i.style.top,height:i.style.height,width:i.style.width,opacity:i.style.opacity}};var n=i.getBoundingClientRect(),a=e.prop("scrollHeight");e.detach(),e.prop("reduceMenuHeight",5),e.css({position:"absolute",display:"block",left:n.left+"px",top:n.top+"px",height:a+"px",opacity:1}),s("body").append(e),void 0!==i.resize&&i.resize(),e.find("cq-scroll").each((function(){this.resize()}))}}openMenu(t,e){setTimeout((function(){s(t).find("input[cq-focus]:first-child").focus()}),0),this.activeMenuStack.push(t),t.show(e),s("cq-context,*[cq-context]").each((function(){this.CIQ&&this.CIQ.UI&&this.CIQ.UI.context&&this.CIQ.UI.context.stx&&this.CIQ.UI.context.stx.modalBegin()}))}registerForResize(t){this.registeredForResize.push(t)}restoreLift(t){var e=s(t);if(e.length){var i=e[0].remember;e.detach(),e.css(i.css),s(i.parentNode).append(e)}}topMenu(){var t=this.activeMenuStack;return t.length?t[t.length-1]:null}unregisterForResize(t){for(var e=this.registeredForResize,i=0;i<e.length;i++)if(e[i]===t)return void e.splice(i,1)}}i.UI.UIManager=v,i.UI.getUIManager=function(){if(i.UI._uiManager)return i.UI._uiManager;let t=document.querySelector("cq-ui-manager");return t||(t=new i.UI.UIManager,t.connectedCallback()),i.UI._uiManager=t,t},customElements.define("cq-ui-manager",v);const{qs:b,qsa:y,channelWrite:q,channelRead:x,channelSubscribe:C}=i.UI.BaseComponent.prototype;class w{createChart(t,e=null){e=e||i.getDefaultConfig();const n=Object.assign({container:t},e.chartEngineParams),s=new i.ChartEngine(n),{quoteFeeds:a,marketFactory:o,simulateL2:r}=e;return a&&a.forEach((({quoteFeed:t,behavior:e,filter:i})=>{s.attachQuoteFeed(t,e,i)})),o&&s.setMarketFactory(o),this.initExtensions({stx:s,config:e,type:"addOns"}),this.initStorage(s,e),r&&r(s),s}createChartAndUI({container:t,config:e}){const n=o(t),s=this.createChart(b(".chartContainer",n),e);i.UI.ensureComponentsRegistered();const a=new i.UI.Context(s,n);return a.config=e,t.context=a,new i.UI.Layout(a),new i.UI.StudyEdit(null,a),this.initLookup(a),this.initContainerListeners(a),this.initEventMarkers(a),this.initDrawingTools(a),this.initDrawingEditListeners(a),this.initDialogHandler(a),this.initColorPicker(),this.initExtensions({stx:s,uiContext:a,config:e,type:"plugins"}),this.loadChart(a),e.language&&i.I18N.setLanguage(s,e.language),i.UI.BaseComponent.buildReverseBindings(n),i.UI.begin(),a;function o(t){return t.nodeName.match(/cq-context/i)||t.getAttribute("cq-container")?t:t.querySelector("cq-context, [cq-context]")}}initContainerListeners(t){const{config:{channels:{breakpoint:e,sidenavSize:n,sidepanelSize:s,drawingPalettes:a,pluginPanelHeight:o}},stx:r,topNode:c}=t;i.UI.addResizeListener(c,(()=>this.notifySizeChanges(t))),this.notifySizeChanges(t),C(e,this.breakpointSetter(t),r),C(n,this.sidenavSizeSetter(t),r),C(s,this.sidepanelSizeSetter(t),r),C(a,this.chartPositionSetter(t),r),C(o,this.chartAreaTopSetter(t),r);const l=this.initKeystrokeHub(t),h=this.getKeystrokeHubSetter(t,l);c.addEventListener("mouseover",h)}initLookup(t){const{config:e,topNode:i}=t,{restoreDrawings:n,initKeystrokeHub:s}=this;s(t),t.changeSymbol=function(i){const{stx:s,loader:a}=this;a&&a.show(),i.symbol==i.symbol.toLowerCase()&&(i.symbol=i.symbol.toUpperCase());const{removeSeries:o,loadError:r}=e.onNewSymbolLoad||{};o&&Object.values(s.chart.series).filter(o).forEach((t=>s.removeSeries(t.id))),s.loadChart(i,(function(i){a&&a.hide(),i?r&&r(i,t):e.restore&&n(s,s.chart.symbol,e.chartId)}))};const a=y(e.selector.lookupComponent,i);e.LookupDriver&&a.length&&(t.setLookupDriver(new e.LookupDriver),a.forEach((t=>t.setCallback(((t,e)=>t.changeSymbol(e))))),t.UISymbolLookup=a)}initKeystrokeHub(t){return document.body.keystrokeHub||(document.body.keystrokeHub=new i.UI.KeystrokeHub(document.body,t,{cb:i.UI.KeystrokeHub.defaultHotKeys})),document.body.keystrokeHub}getKeystrokeHubSetter(t,e){return function(){e.context!==t&&(e.setActiveContext(t),y("cq-lookup").forEach((t=>t.removeAttribute("cq-keystroke-default"))),b("cq-menu.ciq-search cq-lookup",t.topNode).setAttribute("cq-keystroke-default",""))}}initDialogHandler(t){const{config:{channels:e,dialogs:n},stx:s}=t;function a({type:t=null,params:e={}}={}){if(!t)return;const s=n[t]||n[i.makeCamelCase(t)];if(!s)return;let a=b(s.tag);if(!a){const t=o(),e=document.createElement("cq-dialog");a=document.createElement(s.tag),Object.entries(s.attributes||{}).forEach((([t,e])=>a.setAttribute(t,e))),e.append(a),t.append(e)}function o(){let t=b(".cq-dialogs");return t||(t=document.createElement("div"),t.classList.add("cq-dialogs"),document.body.append(t),t)}a&&a.open&&a.open(e)}C(e.dialog,a,s)}initDrawingTools(t){const{stx:e,config:i,topNode:n}=t;function s(t){n.classList[t?"add":"remove"]("toolbar-on"),e.resizeChart()}C(i.channels.drawing,s,e)}initDrawingEditListeners(t){const{config:e,stx:n}=t,s=new i.UI.DrawingEdit(null,t);let a=!0;const o=e.channels.drawing;s.node.addEventListener("drawing-edit-begin",(function(t){x(o,n)||(a=!1,q(o,!0,n))}),!1),s.node.addEventListener("drawing-edit-end",(function({detail:t}){a||("edit"!==t.action&&(a=!0),"close"===t.action&&q(o,!1,n))}),!1)}initColorPicker(){document.querySelector("cq-color-picker")||document.body.append(document.createElement("cq-color-picker"))}loadChart(t){const{stx:e,topNode:i,config:n,loader:s}=t;s&&s.show(),n.restore&&(this.restorePreferences(e,i.id),this.restoreLayout(e,(function(){s&&s.hide()}),n.chartId));const{initialSymbol:a}=n;a&&!e.chart.symbol&&t.UISymbolLookup[0].selectItem("string"==typeof a?{symbol:a}:a),e.termStructure&&e.setChartType("termstructure")}notifySizeChanges(t){const{stx:e,topNode:{clientWidth:i,clientHeight:n},config:{channels:s}}=t,a=x(s.containerSize,e);if(a&&a.width===i&&a.height===n)return;const o=this.getBreakpoint(i);q(s.breakpoint,o,e),q(s.containerSize,{width:i,height:n},e),e.resizeChart()}getBreakpoint(t){return t>700?"break-lg":t>584?"break-md":"break-sm"}initEventMarkers(t){if(i.UI.Markers&&i.Marker.Implementation){const e=new i.Marker.Implementation(t.stx),n=t.config.selector.markersMenuItem;new i.UI.Markers(t,{menuItemSelector:n,implementation:e})}}initExtensions({stx:t,uiContext:e,config:n,type:s}){const a=n[s];Object.entries(a).filter((([,t])=>!!t)).forEach((([n,a])=>{const o=a.moduleName||i.capitalize(n);try{if(!i[o])return void(i.debug&&console.log(`${o} not available for ${s} with params:`,a));const n=Object.assign({stx:t,context:e},a),r=new i[o](n);a.postInstall&&a.postInstall({uiContext:e,extension:r})}catch(t){i.debug&&console.error("Error configuring "+s+" using params ",a,"error",t)}}))}initStorage(t,e){if(!e.restore)return;const n=i.ensureDefaults(e.callbacks||{},{layout:this.getSaveLayout(e),symbolChange:this.getSaveLayout(e),drawing:this.getSaveDrawings(e),newChart:this.retoggleEvents,preferences:this.savePreferences});for(var s in n)t.addEventListener(s,n[s])}getSaveLayout(t){return function({stx:e}){var n=JSON.stringify(e.exportLayout(!0));i.localStorageSetItem("myChartLayout"+(t.chartId||""),n)}}restoreLayout(t,e,n){const{restoreDrawings:s}=this;n||(n="");var a=i.localStorage.getItem("myChartLayout"+n);function o(){s(t,t.chart.symbol,n),e&&e()}t.importLayout(JSON.parse(a),{managePeriodicity:!0,cb:o}),t.termStructure&&t.setCandleWidth(1)}getSaveDrawings(t){return function({stx:e,symbol:n}){var s=e.exportDrawings(),a=t.chartId?t.chartId+"~"+n:n;0===s.length?i.localStorage.removeItem(a):i.localStorageSetItem(a,JSON.stringify(s))}}restoreDrawings(t,e,n){const s=n?n+"~"+e:e,a=i.localStorage.getItem(s);if(null!==a){var o=JSON.parse(a);o&&(t.importDrawings(o),t.draw())}}savePreferences({stx:t}){i.localStorageSetItem("myChartPreferences",JSON.stringify(t.exportPreferences()))}restorePreferences(t,e){e||(e="");var n=i.localStorage.getItem("myChartPreferences"+e);n&&t.importPreferences(JSON.parse(n))}retoggleEvents({stx:t}){s(t.container).find(".stx-markers .ciq-active").triggerHandler("stxtap")}chartPositionSetter(t){const e=b(".chartContainer",t.topNode);return function(t){if(!t)return;const{top:i,left:n}=t;e.style.marginTop=i+"px",e.style.marginLeft=n+"px"}}sidenavSizeSetter(t){const e=b(".ciq-chart-area",t.topNode);return function(t){e.style.left=t+"px"}}chartAreaTopSetter(t){const e=b(".ciq-chart-area",t.topNode);return function(i){const n=Object.values(i||{}).reduce(((t,e)=>t+e),0);e.style.marginTop=n+"px",t.stx.resizeChart()}}sidepanelSizeSetter(t){const e=b(".ciq-chart-area",t.topNode),i=b("cq-tradingcentral",t.topNode);return function(t){e.style.right=t+"px",i&&(i.style.marginRight=t+"px")}}breakpointSetter(t){return function(e){t.topNode.classList.remove("break-lg","break-md","break-sm"),t.topNode.classList.add(e)}}}return i.UI.Chart=w,t}(i(7249),i(9106))}()},93588:function(t,e,i){var n,s,a,o=i(19755);s=[i(96614)],n=function(t){var e=t.CIQ;class i extends e.UI.BaseComponent{connectedCallback(){this.type=this.getAttribute("cq-type")||"helicopter",this.init()}init(){if(this.attached)return;const{markups:t}=this.constructor;this.addDefaultMarkup(this,t[this.type])}}e.UI.AbstractMarker=i,i.markups={helicopter:'\n\t\t<div class="stx-marker-templates" style="left: -1000px; visibility:hidden;">\n\t\t\t\x3c!-- Abstract Markers. You can remove this unless you actually need a helicopter. Seriously though, markers can be anything you want them to be! --\x3e\n\t\t\t<div class="abstract">\n\t\t\t\t<div class="stx-marker abstract">\n\t\t\t\t\t<div class="stx-marker-content">\n\t\t\t\t\t\t<div class="sample">\n\t\t\t\t\t\t\t<div stage>\n\t\t\t\t\t\t\t\t<div helicopter>\n\t\t\t\t\t\t\t\t\t<div propeller style="height: 160px;">\n\t\t\t\t\t\t\t\t\t\t<div spinner style="-webkit-transform-origin: 40px 0 0; transform-origin: 40px 0 0;">\n\t\t\t\t\t\t\t\t\t\t\t<div style="-webkit-transform: rotateY(0deg) translateX(40px); transform: rotateY(0deg) translateX(40px);"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div style="-webkit-transform: rotateY(-90deg) translateX(40px); transform: rotateY(-90deg) translateX(40px);"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div style="-webkit-transform: rotateY(-180deg) translateX(40px); transform: rotateY(-180deg) translateX(40px);"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div style="-webkit-transform: rotateY(-270deg) translateX(40px); transform: rotateY(-270deg) translateX(40px);"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div heli-body></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="text">This is an example of a complex marker which can contain html, video, images, css, and animations.</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t'},e.UI.addComponentDefinition("cq-abstract-marker",i);class n extends e.UI.ModalTag{constructor(){super(),this.nameValueStore=new e.NameValueStore}close(){this.node.css({display:"none"});var t=this;this.nameValueStore.get("cq-advertisement",(function(e,i){if(!e){var n=new Date;t.sleepAmount||(t.sleepAmount={units:1,unitType:"day"});var s=t.sleepAmount.units,a=t.sleepAmount.unitType;"minute"==a?n.setMinutes(n.getMinutes()+s):"hour"==a?n.setHours(n.getHours()+s):"day"==a?n.setDate(n.getDate()+s):"week"==a?n.setDate(n.getDate()+7*s):"month"==a&&n.setMonth(n.getMonth()+s);var o=n.getTime();i&&"object"==typeof i||(i={}),i[t.selector]=o,t.nameValueStore.set("cq-advertisement",i)}}))}makeMarker(){this.markerExists||(new e.Marker({stx:this.context.stx,xPositioner:"none",label:"advertisement",permanent:!0,node:this.node[0]}),this.markerExists=!0)}setNameValueStore(t){this.nameValueStore=t}setSleepAmount(t,e){this.sleepAmount={units:t,unitType:e}}show(t,e){if(this.selector&&this.node.find(this.selector).removeClass("ciq-show"),this.selector=t,!this.selector){var i=this.node.find("div:first-of-type");this.selector="."+i.attr("class")}this.ignoreSleep=e;var n=this;function s(){n.makeMarker(),n.node.css({display:"block"}),n.node.find(n.selector).addClass("ciq-show"),n.node.css({height:"0px"}),setTimeout((function(){n.node.css({height:n.node[0].scrollHeight+"px"})}),0)}e?s():this.nameValueStore.get("cq-advertisement",(function(t,e){if(!t){e&&"object"==typeof e||(e={});var i=e[n.selector];i&&i>Date.now()||s()}}))}watchForRemoteClose(t){t||(t=1e3);var e=this;setInterval((function(){"none"!=e.node.css("display")&&e.nameValueStore.get("cq-advertisement",(function(t,i){if(!t){i&&"object"==typeof i||(i={});var n=i[e.selector];n&&n>Date.now()&&e.close()}}))}),t)}}e.UI.Advertisement=n,e.UI.addComponentDefinition("cq-advertisement",n);class s extends e.UI.DialogContentTag{constructor(){super()}open(t){this.addDefaultMarkup(),super.open(t);var i=this.context.stx,n=t.aggregationType,s={kagi:{title:"Set Reversal Percentage"},renko:{title:"Set Brick Size"},linebreak:{title:"Set Price Lines"},rangebars:{title:"Set Range"},pandf:{title:"Set Point & Figure Parameters"}};i.layout.aggregationType!=n&&i.setAggregationType(n);var a=s[n],r=this.node;for(var c in r.find(".title").text(i.translateIf(a.title)),s)r.find(".ciq"+c).css(n===c?{display:""}:{display:"none"});r.find(".ciq"+n+" input").each((function(){var t=this.name;"box"!=t&&"reversal"!=t||(t="pandf."+t);var n=e.deriveFromObjectChain(i.layout,t);n&&!n.obj[n.member]&&i.chart.defaultChartStyleConfig[this.name]&&o(this).val(i.chart.defaultChartStyleConfig[this.name])}))}}e.UI.AggregationDialog=s,s.markup='\n\t\t<h4 class="title"></h4>\n\t\t<div stxtap="hide()" class="ciq-icon ciq-close"></div>\n\t\t<div style="text-align:center;margin-top:10px;">\n\t\t\t<div class="ciqkagi">\n\t\t\t\t<i>Enter value and hit "Enter"</i>\n\t\t\t\t<p>\n\t\t\t\t\t<input name="kagi" stxtap="Layout.setAggregationEdit(\'kagi\')">\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div class="ciqrenko">\n\t\t\t\t<i>Enter value and hit "Enter"</i>\n\t\t\t\t<p>\n\t\t\t\t\t<input name="renko" stxtap="Layout.setAggregationEdit(\'renko\')">\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div class="ciqlinebreak">\n\t\t\t\t<i>Enter value and hit "Enter"</i>\n\t\t\t\t<p>\n\t\t\t\t\t<input name="priceLines" stxtap="Layout.setAggregationEdit(\'priceLines\')">\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div class="ciqrangebars">\n\t\t\t\t<i>Enter value and hit "Enter"</i>\n\t\t\t\t<p>\n\t\t\t\t\t<input name="range" stxtap="Layout.setAggregationEdit(\'rangebars\')">\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div class="ciqpandf">\n\t\t\t\t<i>Enter box size and hit "Enter"</i>\n\t\t\t\t<p>\n\t\t\t\t\t<input name="box" stxtap="Layout.setAggregationEdit(\'pandf.box\')">\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\t<i>Enter reversal and hit "Enter"</i>\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\t<input name="reversal" stxtap="Layout.setAggregationEdit(\'pandf.reversal\')">\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<p>or</p>\n\t\t\t<p>\n\t\t\t\t<div class="ciq-btn" stxtap="Layout.setAggregationEdit(\'auto\')">Auto Select</div>\n\t\t\t</p>\n\t\t</div>\n\n\t',e.UI.addComponentDefinition("cq-aggregation-dialog",s);class a extends e.UI.ModalTag{constructor(){super(),this.messages={sources:{simulator:"Simulated data.",demo:"Demo data.",xignite:'<a target="_blank" href="https://www.xignite.com">Market Data</a> by Xignite.',fis_mm:'<a target="_blank" href="https://www.fisglobal.com/">Market Data</a> by FIS MarketMap.',Twiggs:'Formula courtesy <a target="_blank" href="https://www.incrediblecharts.com/indicators/twiggs_money_flow.php">IncredibleCharts</a>.'},exchanges:{RANDOM:"Data is randomized.","REAL-TIME":"Data is real-time.",DELAYED:"Data delayed 15 min.",RATES:"Yield data latest from source, bid/ask simulated.",BATS:"BATS BZX real-time.",EOD:"End of day data."}}}insert(t,i){var n=e.UI.makeFromTemplate(this.template);return new e.Marker({stx:t,node:n[0],xPositioner:"none",yPositioner:"none",label:"component",panelName:i,permanent:!0}),n}setContext(t){this.addDefaultMarkup(),this.template=this.node.find("template");var i=this.insert(t.stx,"chart"),n=this;this.addInjection("append","createDataSet",(function(){var t,s;this.chart.attribution&&((t=n.messages.sources[this.chart.attribution.source])||(t=""),(s=n.messages.exchanges[this.chart.attribution.exchange])||(s=""),t+s!=i.attr("lastAttrib")&&(i.find("cq-attrib-source").html(t),i.find("cq-attrib-quote-type").html(s),e.I18N.translateUI(null,i[0]),i.attr("lastAttrib",t+s)));t:for(var a in this.layout.studies){var o=this.layout.studies[a].type;if(n.messages.sources[o]){for(var r=0;r<this.markers.attribution.length;r++)if(this.markers.attribution[r].params.panelName==this.layout.studies[a].panel)continue t;if(!this.panels[a])continue;(t=n.messages.sources[o])||(t=""),(s=n.messages.exchanges[o])||(s="");var c=n.insert(this,a);c.find("cq-attrib-source").html(t),c.find("cq-attrib-quote-type").html(s),e.I18N.translateUI(null,c[0])}}}))}}e.UI.Attribution=a,a.markup="\n\t\t<template>\n\t\t\t<cq-attrib-container>\n\t\t\t\t<cq-attrib-source></cq-attrib-source>&nbsp;\n\t\t\t\t<cq-attrib-quote-type></cq-attrib-quote-type>\n\t\t\t</cq-attrib-container>\n\t\t</template>\n\t",e.UI.addComponentDefinition("cq-attribution",a),t.$$$;var r=t.quoteFeedSimulator;class c extends HTMLElement{get config(){return JSON.parse(this.getAttribute("chart-constructor"))}get defer(){return JSON.parse(this.getAttribute("defer-start"))}get drawingToolbar(){return JSON.parse(this.getAttribute("toolbar-active"))}constructor(){super()}connectedCallback(){if(this.defer)return;let t=Object.assign({container:document.querySelector(".chartContainer")},this.config);this.preferences&&(t.preferences=this.preferences),this.stx=new e.ChartEngine(t),this.startChart()}disconnectedCallback(){this.stx.destroy()}startChart(t,e,i){if(this.stx||(this.stx=t),!this.stx)throw new Error("no CIQ.ChartEngine created!\nDouble check that you have passed an engine into this function.");this.configureDataSource(e,i),this.configureMarkets(),this.configureAddOns(),this.startUI()}configureDataSource(t,e){t?this.stx.attachQuoteFeed(t,e):this.stx.attachQuoteFeed(r,{refreshInterval:1})}startUI(){this.setHeight(),this.startComponentUI()}configureMarkets(){this.stx.setMarketFactory(e.Market.Symbology.factory)}configureAddOns(){e.RangeSlider&&new e.RangeSlider({stx:this.stx}),e.Animation&&new e.Animation(this.stx,{tension:.3}),e.ExtendedHours&&new e.ExtendedHours({stx:this.stx,filter:!0}),e.InactivityTimer&&(this.inactivityTimer=new e.InactivityTimer({stx:this.stx,minutes:30})),e.Tooltip&&new e.Tooltip({stx:this.stx,ohl:!0,volume:!0,series:!0,studies:!0}),e.FullScreen&&new e.FullScreen({stx:this.stx})}startComponentUI(){var t=this.stx,i=e.UI.getMyContext(t.container);i||(i=new e.UI.Context(this.stx,document.querySelector("cq-context, [cq-context]"))),i.stx=this.stx,new e.UI.StudyEdit(null,i),new e.UI.KeystrokeHub(document.querySelector("body"),i,{cb:e.UI.KeystrokeHub.defaultHotKeys}),i.loader&&i.loader.show(),e.I18N.wordlists&&e.I18N.localize(t,t.preferences.language),this.restoreLayout(t,(function(){i.loader&&i.loader.hide()})),this.restorePreferences(t),t.addEventListener("layout",this.saveLayout),t.addEventListener("symbolChange",this.saveLayout),t.addEventListener("preferences",this.savePreferences),t.addEventListener("newChart",this.retoggleEvents),t.addEventListener("drawing",this.saveDrawings)}restoreLayout(t,i){var n=e.localStorage.getItem("myChartLayout"),s=this;function a(){s.restoreDrawings(t,t.chart.symbol),i&&i()}t.importLayout(JSON.parse(n),{managePeriodicity:!0,cb:a})}saveLayout(t){var i=JSON.stringify(t.stx.exportLayout(!0));e.localStorageSetItem("myChartLayout",i)}restorePreferences(t){var i=e.localStorage.getItem("myChartPreferences");i&&t.importPreferences(JSON.parse(i))}savePreferences(t){e.localStorageSetItem("myChartPreferences",JSON.stringify(t.stx.exportPreferences()))}retoggleEvents(t){var i=document.querySelector(".stx-markers .ciq-radio.ciq-active");i&&e.UI.BaseComponent.activate(i.parentElement)}saveDrawings(t){var i=t.stx.exportDrawings();0===i.length?e.localStorage.removeItem(t.symbol):e.localStorageSetItem(t.symbol,JSON.stringify(i))}restoreDrawings(t,i){var n=e.localStorage.getItem(i);if(null!==n){var s=JSON.parse(n);s&&(t.importDrawings(s),t.draw())}}showMarkers(t){this.hideMarkers(),this.createSampleEvents(t),this.stx.draw()}hideMarkers(){e.Marker.removeByLabel(this.stx,"circle"),e.Marker.removeByLabel(this.stx,"square"),e.Marker.removeByLabel(this.stx,"callout"),e.Marker.removeByLabel(this.stx,"helicopter")}createSampleEvents(t){let i=this.stx;var n=i.masterData.length,s=[];n>=5&&s.push({x:i.masterData[n-5].DT,type:t,category:"news",headline:"This is a Marker for a News Item"}),n>=15&&s.push({x:i.masterData[n-15].DT,type:t,category:"earningsUp",headline:"This is a Marker for Earnings (+)"}),n>=25&&s.push({x:i.masterData[n-25].DT,type:t,category:"earningsDown",headline:"This is a Marker for Earnings (-)"}),n>=35&&s.push({x:i.masterData[n-35].DT,type:t,category:"dividend",headline:"This is a Marker for Dividends"}),n>=45&&s.push({x:i.masterData[n-45].DT,type:t,category:"filing",headline:"This is a Marker for a Filing"}),n>=55&&s.push({x:i.masterData[n-55].DT,type:t,category:"split",headline:"This is a Marker for a Split"});for(var a="Like all ChartIQ markers, the object itself is managed by the chart, so when you scroll the chart the object moves with you. It is also destroyed automatically for you when the symbol is changed.",o=0;o<s.length;o++){var r=s[o];r.story=a;var c={stx:i,label:t,xPositioner:"date",x:r.x,node:new e.Marker.Simple(r)};new e.Marker(c)}}setHeight(){var t=this.parentElement.clientHeight;this.drawingToolbar?this.style.height=t-45+"px":this.style.height=t+"px"}}e.UI.ChartIQChart=c,e.UI.addComponentDefinition("chartiq-chart",c);class l extends e.UI.ContextTag{setContext(){this.contextSet||(this.contextSet=!0,this.addDefaultMarkup())}}e.UI.ChartLegend=l,l.markup='\n\t\t<cq-study-legend cq-marker-label="Plots" cq-clone-to-panels="Plots" cq-panel-only cq-marker cq-hovershow cq-content-keys="cq-label,cq-comparison-label">\n\t\t\t<cq-comparison>\n\t\t\t\t<cq-comparison-key cq-panel-only cq-all-series>\n\t\t\t\t\t<template cq-comparison-item>\n\t\t\t\t\t\t<cq-comparison-item>\n\t\t\t\t\t\t\t<cq-swatch cq-overrides="auto"></cq-swatch>\n\t\t\t\t\t\t\t<cq-comparison-label>AAPL</cq-comparison-label>\n\t\t\t\t\t\t\t\x3c!-- cq-comparison-price displays the current price with color animation --\x3e\n\t\t\t\t\t\t\t<cq-comparison-price cq-animate></cq-comparison-price>\n\t\t\t\t\t\t\t\x3c!-- cq-comparison-tick-price displays the price for the active crosshair item --\x3e\n\t\t\t\t\t\t\t\x3c!-- <cq-comparison-tick-price></cq-comparison-tick-price>\t--\x3e\n\t\t\t\t\t\t\t<cq-comparison-loader></cq-comparison-loader>\n\t\t\t\t\t\t\t<div class="stx-btn-ico ciq-close"></div>\n\t\t\t\t\t\t</cq-comparison-item>\n\t\t\t\t\t</template>\n\t\t\t\t</cq-comparison-key>\n\t\t\t</cq-comparison>\n\t\t\t<template cq-study-legend>\n\t\t\t\t<cq-item>\n\t\t\t\t\t<cq-label></cq-label>\n\t\t\t\t\t<span class="ciq-edit"></span>\n\t\t\t\t\t<div class="ciq-icon ciq-close"></div>\n\t\t\t\t</cq-item>\n\t\t\t</template>\n\t</cq-study-legend>\n\t',e.UI.addComponentDefinition("cq-chart-legend",l);class h extends e.UI.ModalTag{constructor(){super(),this.previousClose=null}begin(){var t=this;this.addDefaultMarkup(),this.addInjection("append","createDataSet",(function(){t.update()})),this.update()}disconnectedCallback(){this.context&&e.UI.unobserveProperty("symbolObject",this.context.stx.chart,this.listener),super.disconnectedCallback()}initialize(t){this.params=t||{},void 0===this.params.autoStart&&(this.params.autoStart=!0),this.marker=null,this.params.autoStart&&this.begin()}setContext(t){var i=this,n=this.context.stx;this.listener=function(t){i.previousClose=n.mostRecentClose("iqPrevClose")},e.UI.observeProperty("symbolObject",n.chart,this.listener),this.initialize()}update(){var t=this.context.stx,i=o(this),n=i.find("cq-symbol"),s=i.find("cq-symbol-description"),a=i.find("cq-current-price"),r=i.find("cq-todays-change"),c=i.find("cq-todays-change-pct"),l=i.find("cq-chart-price"),h=i.find("cq-change"),d=this.node.truthyAttr("cq-browser-tab"),u=l.length,p=t.chart.symbol,m=t.chart.symbolDisplay,g=t.internationalizer,f=!1;p?i.addClass("stx-show"):i.removeClass("stx-show");var v=n.textBetter(p);if(t.isHistoricalModeSet)return a.textBetter(""),void h.css({display:"none"});var b="",y=0,q="",x=t.getFirstLastDataRecord(t.chart.dataSet,"Close",!0),C="",w="";if(x&&(C=x.Close),u){""!==C&&(w=t.formatYAxisPrice(C,t.chart.panel,t.chart.decimalPlaces));var k=parseFloat(a.text());if(a.textBetter(w)){f=!0;var I=a.attr("cq-animate");void 0!==I&&e.UI.animatePrice(a,C,k,"fade"==I)}}if(s.textBetter(m||p),(u||d)&&p&&(v||f)){var S=x&&x.iqPrevClose;S||0===S||(S=this.previousClose),C||0===C?(y=(b=e.fixPrice(C-S))/S*100,q=S<=0||C<0?"N/A":g?g.percent2.format(y/100):y.toFixed(2)+"%",h.css({display:"block"})):h.css({display:"none"});var T=Math.abs(b),E=t.formatYAxisPrice(T,t.chart.panel,t.chart.decimalPlaces);T&&r.textBetter(E),c.length&&c.textBetter(q),""!==q&&b>0?l.removeClass("stx-down").addClass("stx-up"):""!==q&&b<0?l.removeClass("stx-up").addClass("stx-down"):l.removeClass("stx-down").removeClass("stx-up"),C=void 0!==C?C:"",b=void 0!==b?b:"",this.title=p+"   "+w+"    ",b>0?this.title+=" "+E:b<0&&(this.title+=" "+E),d&&(document.title=this.title)}}}e.UI.ChartTitle=h,h.markup='\n\t\t<cq-symbol></cq-symbol>\n\t\t<cq-chart-price>\n\t\t\t<cq-current-price cq-animate></cq-current-price>\n\t\t\t<cq-change>\n\t\t\t\t<div class="ico"></div>\n\t\t\t\t<cq-todays-change></cq-todays-change> (\n\t\t\t\t<cq-todays-change-pct></cq-todays-change-pct>)\n\t\t\t</cq-change>\n\t\t</cq-chart-price>\n\t',e.UI.addComponentDefinition("cq-chart-title",h);class d extends e.UI.ModalTag{constructor(){super()}connectedCallback(){this.attached||super.connectedCallback()}setContext(t){this.addDefaultMarkup();var e=this.node;e[0].addEventListener("touchstart",(function(t){t.stopPropagation()})),e[0].addEventListener("mousedown",(function(t){t.stopPropagation()})),e.find("input").stxtap((function(){this.focus()}))}}e.UI.ChartcontrolGroup=d,d.markup='\n\t\t<cq-menu class="ciq-search">\n\t\t\t<cq-lookup cq-keystroke-claim cq-uppercase></cq-lookup>\n\t\t</cq-menu>\n\t\t<cq-toggle class="ciq-draw" cq-member="drawing"><span></span><cq-tooltip>Draw</cq-tooltip></cq-toggle>\n\t\t<cq-toggle class="ciq-CH" cq-member="crosshair"><span></span><cq-tooltip>Crosshair</cq-tooltip></cq-toggle>\n\t\t<cq-menu class="ciq-menu ciq-period">\n\t\t\t<span><cq-clickable stxbind="Layout.periodicity">1D</cq-clickable></span>\n\t\t\t<cq-menu-dropdown>\n\t\t\t\t<cq-menu-container cq-name="menuPeriodicity"></cq-menu-container>\n\t\t\t</cq-menu-dropdown>\n\t\t</cq-menu>\n\t',e.UI.addComponentDefinition("cq-chartcontrol-group",d);class u extends e.UI.ContextTag{constructor(){super()}connectedCallback(){if(!this.attached){super.connectedCallback();var t=this;o(this).stxtap((function(){t.runMethod()}))}}runMethod(){var t=this.node.attr("cq-selector"),e=this.node.attr("cq-method");const{context:i}=this;if(/-dialog/.test(t)&&"open"===e&&i.config)this.channelWrite(i.config.channels.dialog,{type:t.replace(/cq-|-dialog/g,""),params:{context:i,caller:this}},i.stx);else{var n=this;o(t).each((function(){this[e]&&this[e].call(this,{context:n.context,caller:n})}))}}}e.UI.Clickable=u,e.UI.addComponentDefinition("cq-clickable",u);class p extends e.UI.BaseComponent{constructor(){super()}connectedCallback(){if(!this.attached){var t=this;o(this).stxtap(e),super.connectedCallback()}function e(){t.tap()}}tap(){e.UI.containerExecute(this,"close")}}e.UI.Close=p,e.UI.addComponentDefinition("cq-close",p);class m extends e.UI.ContextTag{setContext(){this.contextSet||(this.contextSet=!0,this.addDefaultMarkup())}}e.UI.ComparisonLookup=m,e.UI.addComponentDefinition("cq-comparison-lookup",m),m.markup='\n\t\t<cq-comparison cq-marker>\n\t\t\t<cq-menu class="cq-comparison-new" cq-focus="input">\n\t\t\t\t<cq-comparison-add-label class="ciq-no-share">\n\t\t\t\t\t<cq-comparison-plus></cq-comparison-plus><span>Compare</span><span>...</span>\n\t\t\t\t</cq-comparison-add-label>\n\t\t\t\t<cq-comparison-add>\n\t\t\t\t\t<cq-comparison-lookup-frame>\n\t\t\t\t\t\t<cq-lookup cq-keystroke-claim cq-uppercase></cq-lookup>\n\t\t\t\t\t</cq-comparison-lookup-frame>\n\t\t\t\t\t<cq-swatch cq-no-close></cq-swatch>\n\t\t\t\t\t<span><cq-accept-btn class="stx-btn">ADD</cq-accept-btn></span>\n\t\t\t\t</cq-comparison-add>\n\t\t\t</cq-menu>\n\t\t</cq-comparison>\n\t';class g extends e.UI.ModalTag{constructor(){super(),this.swatchColors=[],this.loading=[]}connectedCallback(){this.attached||(super.connectedCallback(),this.swatchColors=["#8ec648","#00afed","#ee652e","#912a8e","#fff126","#e9088c","#ea1d2c","#00a553","#00a99c","#0056a4","#f4932f","#0073ba","#66308f","#323390"])}configureUI(){var t=this.node,i=t.find("cq-accept-btn");this.template=t.find("*[cq-comparison-item]");var n=t.find("cq-swatch").attr("cq-colors");n&&(this.swatchColors=n.split(","));for(var s=0;s<this.swatchColors.length;s++)this.swatchColors[s]=e.convertToNativeColor(this.swatchColors[s]);var a=t.find("cq-lookup");a.length&&a[0].setCallback(function(t){return function(){t.selectItem.apply(t,arguments)}}(this)),i.stxtap((function(t){a[0].forceInput(),t.stopPropagation()}))}pickSwatchColor(){var t=o(this),e=this.context.stx,i=t.find("cq-swatch");if(i.length){var n=i[0].style.backgroundColor,s={};for(var a in e.chart.series){var r=e.chart.series[a];r.parameters.isComparison&&(s[r.parameters.color]=!0)}if(""===n||s[n])for(var c=0;c<this.swatchColors.length;c++)if(!s[this.swatchColors[c]])return void(i[0].style.backgroundColor=this.swatchColors[c])}}position(){var t=this.context.stx,e=t.barFromPixel(t.cx);this.tick=t.tickFromPixel(t.cx);var i=t.chart.xaxis[e],n=this;function s(){var e;for(var s in n.timeout=null,t.chart.series){e||(e=n.node.find("cq-comparison-key"));var a=e.find('cq-comparison-item[cq-symbol="'+s+'"] cq-comparison-tick-price');if(a.textBetter(""),a.length&&i&&i.data){var o=t.chart.series[s].parameters.symbol;a.textBetter(t.padOutPrice(i.data[o]));var r=i.data[o];null!==r&&("object"==typeof r&&(r=r.Close),a.textBetter(t.padOutPrice(r)))}}}if(this.tick!=this.prevTick){this.timeout&&clearTimeout(this.timeout);var a=0;this.timeout=setTimeout(s,a)}this.prevTick=this.tick}removeSeries(t,e){this.context.stx.removeSeries(t)}renderLegend(){function t(t,e,i){return function(){t.nomore=!0,i.parameters.permanent||t.removeSeries(e,i),t.modalEnd()}}this.pickSwatchColor();var i=o(this),n=i.parents(".stx-holder")[0],s=i.find("cq-comparison-key").cqvirtual();if(s.length){var a=this.context.stx;a.getDefaultColor();var r=void 0!==s.attr("cq-panel-only"),c=void 0===s.attr("cq-all-series");for(var l in a.chart.seriesRenderers){var h=a.chart.seriesRenderers[l];if(h!=a.mainSeriesRenderer&&(!c||h.params.isComparison)&&(!r||n&&h.params.panel==n.panel.name))for(var d=0;d<h.seriesParams.length;d++){var u=h.seriesParams[d],p=e.UI.makeFromTemplate(this.template),m=p.find("cq-comparison-swatch"),g=p.find("cq-swatch"),f=p.find("cq-comparison-label"),v=p.find("cq-comparison-description"),b=p.find("cq-comparison-loader"),y=p.find(".ciq-close"),q=a.chart.series[u.id],x=q.parameters,C=x.color||h.colors[q.id].color,w="auto"==C;w&&(C=a.defaultColor),m.css({background:C}),g.length&&(g[0].seriesId=u.id,g[0].setColor(C,!1,w)),x.opacity&&(m.css({opacity:x.opacity}),g.css({opacity:x.opacity})),f.text(a.translateIf(q.display)),v.text(a.translateIf(q.description)),p.attr("cq-symbol",q.id);var k=x.symbol,I=a.mostRecentClose(k);if(I||0===I){var S=p.find("cq-comparison-price");S.length&&S.text(a.padOutPrice(I))}this.loading[x.symbolObject.symbol]?b.addClass("stx-show"):b.removeClass("stx-show"),x.error&&p.attr("cq-error",!0),!x.color||x.permanent?y.hide():y.stxtap(t(this,q.id,q)),s.append(p)}}s.cqrender().parents("cq-study-legend").each((function(){this.displayLegendTitle()}))}}setColor(t,e){e.seriesId&&this.context.stx.modifySeries(e.seriesId,{color:t})}startPriceTracker(t){var e=this;this.addInjection("append","createDataSet",(function(){t&&e.updatePrices(),this.chart.dataSet&&this.chart.dataSet.length?e.node.attrBetter("cq-show"):e.node.removeAttrBetter("cq-show")}))}startTickPriceTracker(){this.prevTick=null,this.addInjection("prepend","headsUpHR",function(t){return function(){t.position()}}(this))}selectItem(t,e){var i=this;function n(t,e){t&&(e.parameters.error=!0),i.loading[e.parameters.symbolObject.symbol]=!1,i.renderLegend()}var s=this.node.find("cq-swatch"),a="auto",o=null,r=1;if(s[0]){var c=s[0].style;a=c.backgroundColor,o=c.borderTopStyle,r=c.width||1}var l=t.stx;this.loading[e.symbol]=!0;for(var h={name:"comparison "+e.symbol,symbolObject:e,isComparison:!0,color:a,pattern:o,width:r||1,data:{useDefaultQuoteFeed:!0},forceData:!0},d=l.getSeries({symbolObject:e}),u=0;u<d.length;u++)if(d[u].parameters.isComparison)return void(this.loading[e.symbol]=!1);e.symbol&&e.symbol.trim().length>0&&(!t.stx.chart.symbol||t.stx.chart.symbol.toLowerCase()!==e.symbol.toLowerCase())?l.addSeries(e.symbol,h,n):this.loading[e.symbol]=!1}setContext(t){this.node.attr("cq-show","true"),this.configureUI();var i=this;function n(t){i.renderLegend()}if(this.context.stx.chart,this.eventListeners.push(this.context.stx.addEventListener("layout",n)),this.eventListeners.push(this.context.stx.addEventListener("theme",n)),this.context.stx.append("modifySeries",(function(){i.renderLegend()})),this.renderLegend(),this.template.length){var s=e.UI.makeFromTemplate(this.template);this.startPriceTracker(s.find("cq-comparison-price").length),s.find("cq-comparison-tick-price")&&this.startTickPriceTracker()}}updatePrices(){var t,i=this.context.stx,n=i.isHistoricalModeSet,s=e.ChartEngine.isDailyInterval(i.layout.interval);for(var a in i.chart.series){t||(t=this.node.find("cq-comparison-key"));var o=t.find('cq-comparison-item[cq-symbol="'+a+'"] cq-comparison-price');if(o.length){i.chart.series[a].parameters.symbol;var r=i.chart.series[a].lastQuote;if(!r||!r.DT||!r.Close&&0!==r.Close)continue;if(!s&&i.chart.market&&null===i.chart.market.getSession(r.DT))continue;var c=r.Close,l=i.chart.series[a].parameters.subField||"Close",h=parseFloat(o.text());if(c&&(c[l]||0===c[l])&&(c=c[l]),!c&&0!==c&&i.chart.series[a].lastQuote&&(c=i.chart.series[a].lastQuote[l]),o.textBetter(i.padOutPrice(n?"":c)),n)return;void 0!==o.attr("cq-animate")&&e.UI.animatePrice(o,c,h)}}}}e.UI.Comparison=g,e.UI.addComponentDefinition("cq-comparison",g);class f extends e.UI.ContextTag{constructor(){super()}get active(){return this.context.stx.currentVectorParameters["active"+this._scope]}set active(t){this.context.stx.currentVectorParameters["active"+this._scope]=t}get color(){return this.context.stx.currentVectorParameters["color"+this._scope]}set color(t){this.context.stx.currentVectorParameters["color"+this._scope]=t}get lineWidth(){return this.context.stx.currentVectorParameters["lineWidth"+this._scope]}set lineWidth(t){this.context.stx.currentVectorParameters["lineWidth"+this._scope]=t}get pattern(){return this.context.stx.currentVectorParameters["pattern"+this._scope]}set pattern(t){this.context.stx.currentVectorParameters["pattern"+this._scope]=t}connectedCallback(){if(!this.attached){Object.defineProperty(this,"_scope",{configurable:!0,enumerable:!1,value:this.getAttribute("cq-cvp-header")||"",writable:!1});var t=o('template[cq-cvp-controller], template[cvp-controller="true"]');if(0===this.children.length&&t.length){e.UI.makeFromTemplate(t,this);var i=this.querySelector(".ciq-heading");i&&(i.innerHTML=this._scope)}super.connectedCallback()}}emit(t,e){this.toolbar?this.toolbar.emit(t,e):this.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:e}))}getColor(t){var i=o(t.node||o(this).find("cq-line-color")),n=this.color;"transparent"!=n&&"auto"!=n||(n=""),o(i).css({background:n});var s=e.getBackgroundColor(this.parentNode);if(!n||Math.abs(e.hsl(s)[2]-e.hsl(n)[2])<.2){var a=e.chooseForegroundColor(s);i.css({border:"solid "+a+" 1px"}),n||i.css({background:"linear-gradient(to bottom right, "+a+","+a+" 49%, "+s+" 50%, "+s+")"})}else i.css({border:""})}pickColor(t){var e=o("cq-color-picker")[0],i=this,n=o(t.node).attr("cq-overrides");if(!e)return console.error("CVPController.prototype.pickColor: no <cq-color-picker> available");n&&(t.overrides=n.split(",")),e.callback=function(e){i.color=e,i.getColor(t),i.emit("change",{color:e})},t.context=this.context,e.display(t)}setContext(){this.setStyle()}setStyle(t,e,i){e=e||"1",i=i||"dotted",this.lineWidth=parseInt(e,10),this.pattern=i;var n=o(this).find("*[cq-cvp-line-style]");this.lineStyleClassName&&n.removeClass(this.lineStyleClassName),i&&"none"!==i?(this.lineStyleClassName="ciq-"+i+"-"+this.lineWidth,n.addClass(this.lineStyleClassName)):this.lineStyleClassName=null,this.emit("change",{lineWidth:e,pattern:i})}sync(t){var e=t["active"+this._scope],i=t["color"+this._scope],n=t["lineWidth"+this._scope],s=t["pattern"+this._scope],a="ciq-active",r=o(this).find(".ciq-checkbox");e?r.addClass(a):r.removeClass(a),this.active=!!e,this.color=i||"",this.getColor({}),this.setStyle(null,n,s)}toggleActive(t){var e=o(t.node),i="ciq-active";this.active?(this.active=!1,e.removeClass(i)):(this.active=!0,e.addClass(i)),this.emit("change",{active:this.active})}}e.UI.CVPController=f,e.UI.addComponentDefinition("cq-cvp-controller",f);class v extends e.UI.BaseComponent{constructor(){super(),this.activeAttributes={}}connectedCallback(){if(!this.attached){this.isDialog=!0,super.connectedCallback();var t=this;this.node.stxtap(n);var i=e.UI.getUIManager();i.registerForResize(this),this.uiManager=i}function n(e){t.tap(e)}}disconnectedCallback(){this.uiManager.unregisterForResize(this),super.disconnectedCallback()}addActiveAttribute(t){this.activeAttributes[t]=!0}center(){var t=this.node.parent();"BODY"==t[0].tagName&&(t=o(window));var e=t.guaranteedWidth(),i=t.guaranteedHeight(),n=this.node.outerWidth(),s=this.node.outerHeight(),a=e/2-n/2,r=i/2-s/2;a<0&&(a=0),i>2*s&&r+s/2>i/3&&(r=i/3-s/2),r<0&&(r=0),this.node.css({top:r+"px",left:a+"px"})}close(){this.uiManager.closeMenu(this),this.onClose&&this.onClose()}hide(){if(!o(this).find(":invalid").length){for(var t in this.node.children().each((function(){"function"==typeof this.hide&&this.hide()})),this.active=!1,this.uiManager.overlay&&this.uiManager.overlay.removeAttrBetter("cq-active"),this.activeAttributes)this.node.removeAttrBetter(t);this.activeAttributes={},o(this).find("input").each((function(){this==document.activeElement&&this.blur()}))}}open(t){this.uiManager.openMenu(this,t);const{context:e}=t||{};if(!e||!e.config)return void(this.onClose=null);const{config:{channels:i},stx:n}=e;this.onClose=()=>{this.channelWrite(i.dialog,{},n),this.onClose=null}}resize(){this.params&&this.params.x?this.stxContextMenu():this.center(),o(this.node).find("cq-scroll").each((function(){this.resize()}))}show(t){this.params=t,t||(t=this.params={});var i=this;if(!this.uiManager.overlay&&!t.bypassOverlay){this.uiManager.overlay=o("<cq-dialog-overlay></cq-dialog-overlay>");var n=t.context||e.UI.getMyContext(this);n&&n.node.append(this.uiManager.overlay)}i.active=!0,setTimeout((function(){for(var e in i.uiManager.overlay&&!t.bypassOverlay&&i.uiManager.overlay.attrBetter("cq-active"),i.activeAttributes["cq-active"]=!0,i.activeAttributes)i.node.attrBetter(e);i.resize()}))}stxContextMenu(){var t=this.node.parent();"BODY"==t[0].tagName&&(t=o(window));var e=t.guaranteedWidth(),i=t.guaranteedHeight(),n=this.node.outerWidth(),s=this.node.outerHeight(),a=this.params.x,r=this.params.y,c=!1;this.node.find("cq-menu.stxMenuActive:has(.context-menu-right)").each((function(){var t=o(this),e=t.find(".context-menu-right"),i=t.nextAll().length+1;n+=e.outerWidth(),s+=e.outerHeight()-t.outerHeight()*i,c=!0})),a+n>e&&(a=e-n),r+s>i&&(r=i-s),r<0&&(r=0),c&&(this.params.x=a,this.params.y=r),this.node.css({top:r+"px",left:a+"px"})}tap(t){this.uiManager.topMenu()!==this&&t.currentTarget.active||t.stopPropagation()}}e.UI.Dialog=v,e.UI.addComponentDefinition("cq-dialog",v);class b extends e.UI.DialogContentTag{constructor(){super()}open(t){this.addDefaultMarkup(),this.drawing=t.drawing;var e=o(this).find("[cq-edit-text]");return this.drawing.edit?e.show():e.hide(),super.open(t)}}e.UI.DrawingContext=b,b.markup='\n\t\t<div stxtap="DrawingEdit.text()" cq-edit-text>Edit Text</div>\n\t\t<div stxtap="DrawingEdit.edit()">Edit Settings</div>\n\t\t<div stxtap="DrawingEdit.clone()">Clone Drawing</div>\n\t\t<cq-menu stxtap="resize()" cq-close-top="cq-dialog[cq-drawing-context]">\n\t\t\t<cq-menu-dropdown cq-no-scroll="true" class="context-menu-right">\n\t\t\t\t<cq-item stxtap="DrawingEdit.reorderLayer(\'top\')">Bring to Top</cq-item>\n\t\t\t\t<cq-item stxtap="DrawingEdit.reorderLayer(\'up\')">Bring Forward</cq-item>\n\t\t\t\t<cq-item stxtap="DrawingEdit.reorderLayer(\'down\')">Send Backward</cq-item>\n\t\t\t\t<cq-item stxtap="DrawingEdit.reorderLayer(\'bottom\')">Send to Bottom</cq-item>\n\t\t\t</cq-menu-dropdown>\n\t\t\t\x3c!-- element here so that <cq-menu-dropdown> can keep "top: auto;" --\x3e\n\t\t\t<div>Layer Management<div class="context-button-right-arrow"></div></div>\n\t\t</cq-menu>\n\t\t<div stxtap="DrawingEdit.remove()">Delete Drawing</div>\n\t',e.UI.addComponentDefinition("cq-drawing-context",b);class y extends e.UI.DialogContentTag{constructor(){super()}add(){var t=o(this).find("[cq-custom-fibonacci-setting] input").val();if(t&&(t=parseFloat(t)/100,!isNaN(t))){for(var i,n,s=this.context.stx.currentVectorParameters.fibonacci.fibs||[],a=0;a<s.length;a++)if((i=s[a]).level>t){(n=e.clone(i)).level=t,n.display=!0,s.splice(a,0,n);break}n||(i=s.length?e.clone(s[0]):{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},(n=e.clone(i)).level=t,n.display=!0,s.push(n)),this.open()}}close(){if(this.opener){var t=new Event("change",{bubbles:!0,cancelable:!0});this.opener.dispatchEvent(t)}super.close()}open(t){this.addDefaultMarkup(),super.open(t),t&&(this.opener=t.caller);var i,n=this.context.stx.currentVectorParameters,s=n.vectorType,a=o(this);if(n.fibonacci&&"fibtimezone"!=s){a.find(".title").text("Fibonacci Settings");var r=n.fibonacci.fibs||[];(i=a.find("cq-fibonacci-settings")).emptyExceptTemplate();for(var c=0;c<r.length;c++){var l=r[c];if(!("fibarc"===s&&l.level<0)){var h=e.UI.makeFromTemplate(this.node.find("template"),i),d=100*l.level;h.find(".ciq-heading").text(d.toFixed(1)+"%");var u=h.find("input");l.display&&u.prop("checked",!0),this.setChangeEvent(u,"fib",l.level),h.find(".stx-data").append(u)}}}else a.find(".title").text("Settings"),(i=a.find("cq-fibonacci-settings")).emptyExceptTemplate();o(this).find("[cq-custom-fibonacci-setting] input").val("")}setChangeEvent(t,e,i){var n=this;function s(){return function(){var t=n.context.stx.currentVectorParameters,e=t.vectorType;if(t.fibonacci&&"fibtimezone"!=e){var s=t.fibonacci.fibs||[];if("checkbox"==this.type)for(var a=0;a<s.length;a++){var o=s[a];o.level===i&&(o.display=!!this.checked)}}}}t.change(s())}}e.UI.FibSettingsDialog=y,y.markup='\n\t\t<h4 class="title">Settings</h4>\n\t\t<cq-scroll cq-no-maximize>\n\t\t\t<cq-fibonacci-settings>\n\t\t\t\t<template cq-fibonacci-setting>\n\t\t\t\t\t<cq-fibonacci-setting>\n\t\t\t\t\t\t<div class="ciq-heading"></div>\n\t\t\t\t\t\t<div class="stx-data">\n\t\t\t\t\t\t\t<input type="checkbox">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</cq-fibonacci-setting>\n\t\t\t\t</template>\n\t\t\t</cq-fibonacci-settings>\n\t\t\t<div cq-custom-fibonacci-setting>\n\t\t\t\t<input class="ciq-heading" type="text">%\n\t\t\t\t<div class="ciq-btn stx-data" stxtap="add()">Add</div>\n\t\t\t</div>\n\t\t</cq-scroll>\n\t\t<div class="ciq-dialog-cntrls">\n\t\t\t<div class="ciq-btn" stxtap="close()">Done</div>\n\t\t</div>\n\t',e.UI.addComponentDefinition("cq-fib-settings-dialog",y);class q extends e.UI.BaseComponent{constructor(){super()}connectedCallback(){this.attached||(this.innerHTML=this.render(),this.generateTable(2,2),this.highlightTable(1,1))}get maxcols(){return this.getAttribute("maxcols")||4}set maxcols(t){this.setAttribute("maxcols",t)}get maxrows(){return this.getAttribute("maxrows")||4}set maxrows(t){this.setAttribute("maxrows",t)}generateTable(t,e){var i=this;function n(t){let e=parseInt(t.target.dataset.column)+1;e>i.maxcols&&(e=i.maxcols);let n=parseInt(t.target.dataset.row)+1;n>i.maxrows&&(n=i.maxrows),i.generateTable(e,n),i.highlightTable(parseInt(t.target.dataset.column),parseInt(t.target.dataset.row))}let s=this.querySelector("table");if(s){this.cleanTable(t,e),t=t||1,e=e||1;for(let i=1;i<=e;i++){let a;s.childNodes[i-1]?a=s.childNodes[i-1]:(a=document.createElement("tr"),s.appendChild(a));for(let s=1;s<=t;s++)if(!a.childNodes[s-1]){let o=document.createElement("td");o.dataset.row=i,o.dataset.column=s,o.dataset.rows=e,o.dataset.columns=t,o.addEventListener("mouseenter",n),o.addEventListener("click",function(t){this.triggerUpdateGridEvent(t.target.dataset.column,t.target.dataset.row)}.bind(this)),o.appendChild(document.createElement("div")),a.appendChild(o)}}}}triggerUpdateGridEvent(t,e){document.querySelector("body").dispatchEvent(new CustomEvent("update-grid",{detail:{columns:t,rows:e},bubbles:!0,composed:!0}))}highlightTable(t,e){for(let i of this.querySelectorAll("td"))i.dataset.column<=t&&i.dataset.row<=e?i.classList.add("highlight"):i.classList.remove("highlight");this.querySelector(".row.count").innerHTML=e,this.querySelector(".column.count").innerHTML=t}cleanTable(t,e){let i=this.querySelector("table");for(;i.childNodes.length>e;)i.removeChild(i.lastChild);for(let e of i.childNodes)for(;e.childNodes.length>t;)e.removeChild(e.lastChild)}render(){return'\n\t\t\t\t<style>\n\t\t\t\t\tcq-grid-size-picker, cq-grid-size-picker tr, cq-grid-size-picker td{\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t}\n\n\t\t\t\t\tcq-grid-size-picker tr{\n\t\t\t\t\t\tmargin: 0;\n\t\t\t\t\t\tpadding: 0;\n\t\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\t\tline-height: 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tcq-grid-size-picker td{\n\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\theight: 19px;\n\t\t\t\t\t\twidth: 19px;\n\t\t\t\t\t\tmargin: 0;\n\t\t\t\t\t\tpadding: 0;\n\t\t\t\t\t\ttext-align: center;\n\t\t\t\t\t}\n\n\t\t\t\t\tcq-grid-size-picker td div{\n\t\t\t\t\t\tpointer-events: none;\n\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\theight: 15px;\n\t\t\t\t\t\twidth: 15px;\n\t\t\t\t\t\tmargin: 2px;\n\t\t\t\t\t\tpadding: 0;\n\t\t\t\t\t\tborder: solid 1px #ccc;\n\t\t\t\t\t\tborder-color: var(--grid-size-border-color, #ccc);\n\t\t\t\t\t\tbackground: #eee; /* keep a hard coded style in case the var function is unavailable */\n\t\t\t\t\t\tbackground-color: var(--grid-size-background-color, #eee);\n\t\t\t\t\t\ttext-align: center;\n\t\t\t\t\t}\n\n\t\t\t\t\tcq-grid-size-picker td:hover div, cq-grid-size-picker td.highlight div{\n\t\t\t\t\t\tborder-color: #666;\n\t\t\t\t\t\tborder-color: var(--grid-size-border-hl-color, #666);\n\t\t\t\t\t\tbackground: #ccc;\n\t\t\t\t\t\tbackground-color: var(--grid-size-background-hl-color, #ccc);\n\t\t\t\t\t}\n\n\t\t\t\t\tcq-grid-size-picker p{\n\t\t\t\t\t\twidth:100%;\n\t\t\t\t\t\tline-height: 1em;\n\t\t\t\t\t\ttext-align: center;\n\t\t\t\t\t\tmargin: 5px 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tcq-grid-size-picker .multiply{\n\t\t\t\t\t\ttransform: rotate(45deg);\n\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t}\n\t\t\t\t</style>\n\n\t\t\t\t<table class="grid-size-picker"></table>\n\t\t\t\t<p><span class="row count">1</span> <span class="multiply">+</span> <span class="column count">1</span></p>\n\t\t\t'}}e.UI.GridSizePicker=q,e.UI.addComponentDefinition("cq-grid-size-picker",q);class x extends e.UI.ContextTag{setContext(){if(!this.hasAttribute("cq-filter"))return;const t=this.getAttribute("cq-filter")||"Search";this.createFilter(t)}createFilter(t){const e=document.createElement("div");e.classList.add("searchFilter"),this.appendChild(e);const i=document.createElement("input");i.type="search",i.placeholder=t,e.appendChild(i),this.searchWrapper=e;const n=this.nextElementSibling,s=({target:{value:t}})=>{const e=new RegExp(t,"i");this.qsa("cq-item",n).forEach((i=>{const n=t&&!e.test(i.textContent)?"add":"remove";i.classList[n]("item-hidden")}))};i.addEventListener("input",s),i.addEventListener("keyup",s);const a=this.getAttribute("cq-filter-min")||15,o=()=>{const t=this.qsa("cq-item",n).length;e.classList[t>a?"add":"remove"]("active")};void 0!==typeof MutationObserver?(new MutationObserver(o).observe(this.parentElement,{childList:!0,subtree:!0}),o()):e.classList.add("active")}}e.UI.Heading=x,e.UI.addComponentDefinition("cq-heading",x);class C extends e.UI.ContextTag{setContext(t){this.addDefaultMarkup();const i=new e.UI.HeadsUp(this,t,{followMouse:!0,autoStart:!1});let n=t.config?t.config.channels.headsUp:"layout.headsUp";this.channelSubscribe(n,(t=>i["dynamic"===t?"begin":"end"]()))}}C.markup='\n\t\t<svg version="1.1" x="0px" y="0px" viewBox="0 0 215 140" enableBackground="new 0 0 215 140">\n\t\t\t<defs>\n\t\t\t\t<filter id="ciq-hu-shadow" height="130%">\n\t\t\t\t\t<feGaussianBlur in="SourceAlpha" stdDeviation="1"></feGaussianBlur>\n\t\t\t\t\t<feOffset dx="0" dy="1" result="offsetblur"></feOffset>\n\t\t\t\t\t<feComponentTransfer>\n\t\t\t\t\t\t<feFuncA type="linear" slope="0.2"></feFuncA>\n\t\t\t\t\t</feComponentTransfer>\n\t\t\t\t\t<feMerge>\n\t\t\t\t\t\t<feMergeNode></feMergeNode>\n\t\t\t\t\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t\t\t\t\t</feMerge>\n\t\t\t\t</filter>\n\t\t\t</defs>\n\t\t\t<polygon\n\t\t\t\tclass="ciq-hu-bg" style="stroke-width: 1;"\n\t\t\t\tpoints="198.4,124.4 1,124.4 1,1 214,1 214,137.8"\n\t\t\t\tfilter="url(#ciq-hu-shadow)"\n\t\t\t\t/>\n\t\t\t<path class="ciq-hu-stroke"\n\t\t\t\tfill="#398DFF"\n\t\t\t\td="M213,2v133.6l-13.7-11.8l-0.6-0.5H198H2V2H213 M215,0H0v125.4h198l17,14.6V0L215,0z">\n\t\t\t</path>\n\t\t</svg>\n\t\t<div>\n\t\t\t<cq-hu-col1>\n\t\t\t\t<cq-hu-date></cq-hu-date>\n\t\t\t\t<cq-hu-price></cq-hu-price>\n\t\t\t\t<cq-volume-grouping>\n\t\t\t\t\t<div>Volume</div>\n\t\t\t\t\t<div><cq-volume-visual></cq-volume-visual></div>\n\t\t\t\t\t<div><cq-hu-volume></cq-hu-volume><cq-volume-rollup></cq-volume-rollup></div>\n\t\t\t\t</cq-volume-grouping>\n\t\t\t</cq-hu-col1>\n\t\t\t<cq-hu-col2>\n\t\t\t\t<div>Open</div><cq-hu-open></cq-hu-open>\n\t\t\t\t<div>Close</div><cq-hu-close></cq-hu-close>\n\t\t\t\t<div>High</div><cq-hu-high></cq-hu-high>\n\t\t\t\t<div>Low</div><cq-hu-low></cq-hu-low>\n\t\t\t</cq-hu-col2>\n\t\t</div>\n\t',e.UI.HeadsUpDynamic=C,e.UI.addComponentDefinition("cq-hu-dynamic",C);class w extends e.UI.ContextTag{setContext(t){this.addDefaultMarkup();const i=new e.UI.HeadsUp(this,t,{autoStart:!0});let n=t.config?t.config.channels.headsUp:"layout.headsUp";this.channelSubscribe(n,(t=>i["static"===t?"begin":"end"]()))}}w.markup="\n\t\t<div>\n\t\t\t<div>Price</div><cq-hu-price></cq-hu-price>\n\t\t\t<div>Open</div><cq-hu-open></cq-hu-open>\n\t\t\t<div>Close</div><cq-hu-close></cq-hu-close>\n\t\t</div>\n\t\t<div>\n\t\t\t<div>Vol</div>\n\t\t\t<cq-volume-section>\n\t\t\t\t<cq-hu-volume></cq-hu-volume>\n\t\t\t\t<cq-volume-rollup></cq-volume-rollup>\n\t\t\t</cq-volume-section>\n\t\t\t<div>High</div><cq-hu-high></cq-hu-high>\n\t\t\t<div>Low</div><cq-hu-low></cq-hu-low>\n\t\t</div>\n\t",e.UI.HeadsUpStatic=w,e.UI.addComponentDefinition("cq-hu-static",w);class k extends e.UI.ContextTag{setContext(t){let i=this.constructor.markup;const n=this.getAttribute("cq-toggles");n&&(i=i.replace(/dynamic,static,null/,n)),this.addDefaultMarkup(this,i),this.tooltip=this.querySelector("cq-tooltip");let s=t.config?t.config.channels:{headsUp:"layout.headsUp",crosshair:"layout.crosshair"};this.channelSubscribe(s.headsUp,(()=>this.applyValues(s))),this.channelSubscribe(s.crosshair,(t=>{(e.isMobile||t)&&"dynamic"===this.channelRead(s.headsUp)&&setTimeout((()=>this.channelWrite(s.headsUp,"static")))})),this.initInfoComponents(t)}setTooltip(t){const{context:{stx:e},tooltip:i}=this;i.innerText=e.translateIf(`Info ${t||"off"}`)}initInfoComponents(t){const e=this.querySelector("cq-toggle").getAttribute("cq-toggles");["dynamic","static"].forEach((function(i){if(new RegExp(i).test(e)&&!t.topNode.querySelector(`cq-hu-${i}`)){const e=document.createElement(`cq-hu-${i}`);t.topNode.append(e)}}))}applyValues(t){const i=this.channelRead(t.crosshair),n=this.channelRead(t.headsUp);"dynamic"===n&&(i||e.isMobile)&&setTimeout((()=>this.channelWrite(t.headsUp,"static"))),e.isMobile&&"static"===n&&setTimeout((()=>this.channelWrite(t.crosshair,!0))),this.setTooltip(n)}}k.markup='\n\t\t<cq-toggle\n\t\t\tclass="ciq-HU"\n\t\t\tcq-member="headsUp"\n\t\t\tcq-toggles="dynamic,static,null">\n\t\t\t<span></span>\n\t\t\t<cq-tooltip>Info</cq-tooltip>\n\t\t</cq-toggle>\n\t',e.UI.InfoToggle=k,e.UI.addComponentDefinition("cq-info-toggle",k);let I=!1;class S extends HTMLElement{connectedCallback(){if(this.hasAttribute("attached"))return;this.setAttribute("attached","");var t=this;function i(i){e.localStorageSetItem("myChartPreferences"+t.id,JSON.stringify(i.stx.exportPreferences()))}function n(i){var n=JSON.stringify(i.stx.exportLayout(!0));e.localStorageSetItem("myChartLayout"+t.id,n)}function s(i){var n=i.stx.exportDrawings();0===n.length?e.localStorage.removeItem(t.id+"~"+i.symbol):e.localStorageSetItem(t.id+"~"+i.symbol,JSON.stringify(n))}const a=this.getAttribute("env-container")||"body",o=this.getAttribute("tmpl-src");var r=this.querySelector("cq-context");r||(r=this.appendChild(document.createElement("cq-context")));const c=this.hasAttribute("no-save");this.style.visibility="hidden",e.loadUI(o,r,(function(e){if(e)return;var o=t.querySelector("cq-chart-title");o&&o.removeAttribute("cq-browser-tab");for(var r=t.querySelectorAll("cq-ui-manager, cq-dialog, cq-color-picker"),l=0;l<r.length;l++){var h=r[l];h.parentNode.removeChild(h),I||document.querySelector(a).appendChild(h)}I=!0;const d={extendedHours:!0,rangeSlider:!0,inactivityTimer:!0,initialSymbol:t.getAttribute("symbol"),storage:!c},u={layout:n,symbolChange:n,drawing:s,preferences:i};t.signalEvent=new CustomEvent("signal-chart-ready",{detail:{node:t,params:d,callbacks:u}}),t.setAttribute("cq-event-flag",""),t.style.visibility="",document.body.dispatchEvent(t.signalEvent)}))}disconnectedCallback(){this.stx.destroy()}}e.UI.InstantChart=S,customElements.define("cq-instant-chart",S);class T extends e.UI.DialogContentTag{constructor(){super()}close(){o("cq-language-dialog").closest("cq-dialog,cq-menu").each((function(){this.close()}))}open(t){this.addDefaultMarkup(),super.open(t);var i=this.node.find("cq-languages");i.emptyExceptTemplate();var n=this.node.find("template"),s=e.I18N.languages;if(s)for(var a in s){var o=e.UI.makeFromTemplate(n,i);o.find("cq-language-name").text(s[a]),o.find("cq-flag").attr("cq-lang",a),o.stxtap(r(a))}function r(t){return function(){e.UI.contextsForEach((function(){var i=this.stx;i.preferences.language=t,i.changeOccurred("preferences"),e.I18N.localize(i,t),i.draw()}))}}}}e.UI.LanguageDialog=T,T.markup='\n\t\t<h4 class="title">Choose language</h4>\n\t\t<cq-close></cq-close>\n\t\t<cq-languages>\n\t\t\t<template><div><cq-flag></cq-flag><cq-language-name></cq-language-name></div></template>\n\t\t</cq-languages>\n\t',e.UI.addComponentDefinition("cq-language-dialog",T);class E extends e.UI.ContextTag{constructor(){super()}setContext(t){this.context.setLoader(this)}show(){o(this).addClass("stx-show")}hide(){o(this).removeClass("stx-show")}}e.UI.Loader=E,e.UI.addComponentDefinition("cq-loader",E);class U extends e.UI.ContextTag{constructor(){super(),this.usingEmptyDriver=!1,this.currentFilter=null,this.params={}}acceptText(t,i){var n=this;this.params.driver||(this.context.lookupDriver?this.setDriver(this.context.lookupDriver):(this.setDriver(new e.ChartEngine.Driver.Lookup),this.usingEmptyDriver=!0));var s=this.params.driver.exchanges;function a(t){n.params.driver.exchanges=s,n.results(t)}var o=this.getAttribute("cq-exchanges");o&&(this.params.driver.exchanges=o.split(",")),this.params.driver.acceptText(t,i,null,a)}attachDriver(t){this.driver=t}close(){this.node.closest("cq-dialog,cq-menu").each((function(){this.close()}))}forceInput(){var t=this.input[0];this.selectItem({symbol:t.value}),e.blur(this.input),this.close(),t.value=""}initialize(){this.addDefaultMarkup();var t=o(this);this.resultList=t.find("cq-scroll"),this.input=t.find("input"),this.input.length||(this.input=t.append(o("<input type='hidden'>")),this.input[0].value=""),this.input.stxtap((function(){this.focus()}));var e=this;this.input.on("paste",(function(t){var i=t.target;setTimeout((function(){e.acceptText(i.value,e.currentFilter)}),0)}));var i=t.find("cq-lookup-filters");i&&i.find("cq-filter").stxtap((function(){i.find("cq-filter").removeClass("true");var t=o(this);t.addClass("true");var n=t.find("translate");n.length?e.currentFilter=n.attr("original"):e.currentFilter=this.innerHTML,e.acceptText(e.input[0].value,e.currentFilter)})),void 0!==t.attr("cq-keystroke-claim")&&this.addClaim(this)}isActive(){return""!==this.input[0].value}keyStroke(t,i,n,s){if(s.ctrl||"Meta"==i||"Win"==i)return!1;var a=o(this).parents().addBack(),r=this.input[0],c=!1,l=document.activeElement===r;if(!l&&(n.altKey||document.activeElement&&("INPUT"==document.activeElement.tagName||"TEXTAREA"==document.activeElement.tagName)))return!1;var h=!1,d=!1;if(a.hasClass("stxMenuActive")&&(d=!0),(l||d)&&(h=!0),!h){if(void 0===this.node.attr("cq-keystroke-default"))return;if(!d&&this.uiManager.topMenu())return}if((" "===i||"Spacebar"===i)&&""===r.value)return!1;var u=this;if(s.key&&1==s.key.length&&n.which>=32&&n.which<=222&&(l||(r.value=r.value+s.key),u.acceptText(r.value,u.currentFilter),c=!0),"Delete"==i||"Backspace"==i||"Del"==i){if(this.context.stx.anyHighlighted)return!1;r.value.length&&(window.getSelection().toString()?r.value="":(l||(r.value=r.value.substring(0,r.value.length-1)),r.value.length&&u.acceptText(r.value,u.currentFilter)),c=!0),"Backspace"==i&&(c=!0)}if("Escape"!==i&&"Esc"!==i||!d||(r.value="",this.close(),e.blur(r),c=!0),"Enter"===i&&""!==r.value&&this.isActive()){var p=this.node.find("cq-scroll");if((l=p.length&&p[0].focused())&&l.selectFC)l.selectFC.apply(l,{});else{var m=r.value;this.node.truthyAttr("cq-uppercase")&&(m=m.toUpperCase()),this.selectItem({symbol:m})}e.blur(this.input),this.close(),r.value="",c=!0}return c?(!this.usingEmptyDriver&&(r.value.length||"Escape"!=i&&"Esc"!=i&&"Enter"!=i&&l)?this.open():this.close(),!l||{allowDefault:!0}):void 0}open(){this.node.closest("cq-dialog,cq-menu").each((function(){this.open()}))}results(t){function i(t,i){return function(n){e.blur(t.input),t.selectItem(i),t.input[0].value=""}}this.resultList.empty();for(var n=0;n<t.length;n++){for(var s=t[n],a="<cq-item>",r=0;r<s.display.length;r++)a+="<SPAN>"+s.display[r]+"</SPAN>";var c=o(a+="</cq-item>");this.resultList.append(c),c[0].selectFC=i(this,s.data),c.stxtap(c[0].selectFC)}var l=this.node.find("cq-scroll");l.length&&l[0].top()}selectItem(t,e){this.params.cb&&this.params.cb(this.context,t,e)}setCallback(t){this.params.cb=t}setContext(t){this.initialize();const e=this.querySelector("cq-lookup-input input"),{config:i,stx:n}=t;i&&this.channelSubscribe(i.channels.breakpoint,(t=>{var i=n.termStructure?"Entity":"Symbol";"break-lg"===t&&(i="Enter "+i),e.setAttribute("placeholder","break-sm"===t?"":i)}))}setDriver(t){this.params.driver=t}}e.UI.SymbolLookup=U,U.markup='\n\t\t<cq-lookup-input cq-no-close>\n\t\t\t<input type="text" spellcheck="off" autocomplete="off" autocorrect="off" autocapitalize="off" name="symbol" placeholder="">\n\t\t\t<cq-lookup-icon></cq-lookup-icon>\n\t\t</cq-lookup-input>\n\t\t<cq-lookup-results>\n\t\t\t<cq-lookup-filters cq-no-close>\n\t\t\t\t<cq-filter class="true">ALL</cq-filter>\n\t\t\t\t<cq-filter>STOCKS</cq-filter>\n\t\t\t\t<cq-filter>FX</cq-filter>\n\t\t\t\t<cq-filter>INDEXES</cq-filter>\n\t\t\t\t<cq-filter>FUNDS</cq-filter>\n\t\t\t\t<cq-filter>FUTURES</cq-filter>\n\t\t\t</cq-lookup-filters>\n\t\t\t<cq-scroll></cq-scroll>\n\t\t</cq-lookup-results>\n\t',e.UI.addComponentDefinition("cq-lookup",U);class L extends e.UI.ContextTag{setContext(t){const e=this.getAttribute("cq-name");if(e&&t.config){const i=t.config.getMenu(e);this.addDefaultMarkup(this,i.join(""))}}}e.UI.MenuContainer=L,e.UI.addComponentDefinition("cq-menu-container",L);class D extends HTMLElement{constructor(){super(),this.node=o(this),this.activeClassName="stxMenuActive",this.active=!1}get focusElement(){return this.getAttribute("cq-focus")}connectedCallback(){if(!this.attached&&(this.uiManager=e.UI.getUIManager(),this.attached=!0,!this.node.attr("readonly"))){var t=this,i=this.node[0];this.node.stxtap(n),i.addEventListener("stxtap",s,!0)}function n(e){t.tap(e)}function s(e){t.captureTap(e)}}captureTap(t){var e=o(t.target).parents().addBack();this.noClose=e.filter((function(){var t=o(this).attr("cq-no-close");return void 0!==t&&!1!==t})).length,this.noClose||(this.noClose=e.filter((function(){return o(this).is("cq-separator,cq-heading")})).length)}close(){this.uiManager.closeMenu(this)}hide(){this.active&&(this.unlift(),this.node.removeClass(this.activeClassName),this.active=!1,o(this).find("input").each((function(){this==document.activeElement&&this.blur()})))}lift(){for(var t=this.lifts=this.uiManager.findLifts(this),e=0;e<t.length;e++)this.uiManager.lift(t[e])}open(t){for(var e=this.uiManager.activeMenuStack,i=0;i<e.length;i++)if(e[i]===this)return;this.uiManager.openMenu(this,t)}show(t){this.active||(this.active=!0,this.node.addClass(this.activeClassName),this.lift(),this.node.find("cq-scroll").each((function(){this.resize()})))}tap(t){var e=this.uiManager;if(this.active)t.stopPropagation(),this.noClose||e.closeMenu(this);else if(!this.active){if(t.stopPropagation(),o(t.target).parents("cq-menu-dropdown").length)return;for(var i=!1,n=this.node.parents("cq-menu,cq-dialog"),s=0;s<n.length;s++)n[s].active&&(i=!0);if(i||e.closeMenu(),this.open(),this.focusElement){const t=this.querySelector(this.focusElement);t&&t.focus()}}}unlift(){var t=this.lifts;if(t){for(var e=0;e<t.length;e++)this.uiManager.restoreLift(t[e]);this.lifts=null}}}e.UI.Menu=D,e.UI.addComponentDefinition("cq-menu",D);class M extends e.UI.ContextTag{constructor(){super(),this.dragging=!1,this.paletteRegistry=[],this.mouseOutCk=!1}connectedCallback(){this.attached||super.connectedCallback()}initListeners(){this.node=o(this);const{stx:t,config:e}=this.context,i=this,n=i.handleResize.bind(this);function s(){i.context.stx.showCrosshairs(),i.mouseOutCk=setTimeout((()=>i.stopDrag()),500)}function a(){i.context.stx.undisplayCrosshairs(),i.dragging&&(1!==event.buttons?i.stopDrag():clearTimeout(i.mouseOutCk))}function r(t){i.dragging&&(t.stopPropagation(),i.dragging.classList.contains("dragging")&&i.dragging.setTransformPosition(t.clientX,t.clientY),i.dragging.classList.contains("resizing")&&i.dragging.setHeightToPosition(t.clientY))}function c(e){i.setChartDimensions(),t.resizeChart()}this.setVerticalPaletteHeight(),this.addEventListener("mouseup",this.stopDrag.bind(this)),this.addEventListener("mouseleave",s),this.addEventListener("mouseenter",a),this.addEventListener("mousemove",r),this.addEventListener("mousedown",this.stopContext.bind(this)),t.append("resizeChart",(()=>n({resizeChart:!1}))),e&&e.channels.drawing&&this.channelSubscribe(e.channels.drawing,c)}setContext(){this.initListeners()}palettePublish(t,e){for(var i=0;i<this.paletteRegistry.length;i++)this.paletteRegistry[i](t,e)}paletteSubscribe(t){return this.paletteRegistry.push(t),this.palettePublish.bind(this)}getBounds(){return this.parentNode.getBoundingClientRect()}getChartBounds(){let t=this.parentNode.getBoundingClientRect(),e={top:0,left:0,height:t.height,width:t.width};for(var i=this.querySelectorAll('[docked="true"]'),n=0;n<i.length;n++){var s=i[n];"vertical"===s.orientation?(e.width-=s.getWidth(),e.left+=s.getWidth()):"horizontal"===s.orientation&&(e.height-=s.getHeight(),e.top+=s.getHeight())}return e}getChartBoundsOffset(){let t=this.parentNode.getBoundingClientRect(),e=this.getChartBounds();return e.top+=t.top,e.left+=t.left,e}startContext(){this.classList.add("context")}stopContext(){this.classList.remove("context"),this.palettePublish("context","stop")}startDrag(t,e){for(var i=this.querySelectorAll('[docked="false"]'),n=0;n<i.length;n++)i[n].style.zIndex=1;e=e||"dragging",this.dragging=t,this.classList.add("dragging"),this.dragging.classList.add(e),this.dragging.style.zIndex=10}stopDrag(){this.classList.remove("dragging"),this.dragging=!1,this.resizing=!1,o(this.node).find('[docked="false"]').each((function(){this.node.removeClass("dragging resizing")}))}startResize(t){this.resizing=t,this.classList.add("dragging"),this.dragging.classList.add("dragging")}handleResize({resizeChart:t=!0}={}){this.palettePublish("dockWillResize"),this.setChartDimensions(),this.setVerticalPaletteHeight();let e=document.body.classList.contains("break-sm");for(var i=this.querySelectorAll('[docked="false"]'),n=0;n<i.length;n++){var s=i[n];e?s.dock():s.checkPosition()}this.palettePublish("dockDidResize"),t&&this.context.stx.resizeChart()}setVerticalPaletteHeight(){o(this.node).find("[orientation=vertical]").each(function(t,e){"true"===o(e).attr("docked")&&o(e).css("height",this.parentNode.clientHeight+"px")}.bind(this))}setChartDimensions(){const t=this.context.stx.chart.container,{top:e,left:i,width:n,height:s}=this.getChartBounds(),{config:a}=this.context;a?this.channelWrite(a.channels.drawingPalettes,{top:e,left:i,width:n,height:s}):(t.style.width=n+"px",t.style.height=s+"px",t.style.top=e+"px",t.style.left=i+"px");for(var o=this.querySelectorAll('[orientation="horizontal"]'),r=0;r<o.length;r++){var c=o[r];c.style.left=i+1+"px",c.style.width=n+"px"}for(var l=this.querySelectorAll('[orientation="vertical"]'),h=0;h<l.length;h++){var d=l[h];"false"===d.docked?d.style.top=e+"px":d.style.top=0}}dockAllPalettes(){for(var t=this.querySelectorAll('[docked="false"]'),e=0;e<t.length;e++)t[e].dock()}}e.UI.PaletteDock=M,e.UI.addComponentDefinition("cq-palette-dock",M);class A extends e.UI.ContextTag{constructor(){super(),this.dragMargin=10}connectedCallback(){this.attached||super.connectedCallback()}init(){this.node=o(this),this.isDragging=!1,this.minHeight=parseInt(this.getAttribute("min-height"),10),isNaN(this.minHeight)&&(this.minHeight=25),this.paletteDock=this.parentElement.parentElement,this.dragStrip=this.querySelector(".drag-strip"),this.resizeStrip=this.querySelector(".resize-strip"),this.dragStrip&&this.dragStrip.addEventListener("mousedown",function(t){this.paletteDock.hasOwnProperty("dragging")&&this.paletteDock.startDrag(this)}.bind(this)),this.resizeStrip&&this.resizeStrip.addEventListener("mousedown",function(t){this.paletteDock.hasOwnProperty("dragging")&&this.paletteDock.startDrag(this,"resizing")}.bind(this)),this.paletteDock.paletteSubscribe&&(this.sendMessage=this.paletteDock.paletteSubscribe(this.handleMessage.bind(this)))}get hide(){return this.getAttribute("hide")}set hide(t){this.setAttribute("hide",t)}get docked(){return this.getAttribute("docked")}set docked(t){this.setAttribute("docked",t)}get orientation(){return this.getAttribute("orientation")}set orientation(t){this.setAttribute("orientation",t)}static get observedAttributes(){return["docked","hide"]}attributeChangedCallback(t,e,i){"docked"===t&&("false"===i?(this.setTransform(100,70),this.setHeightByScale(.8)):this.style.transform="")}handleMessage(t,e){return{id:t,message:e}}detach(t,e){let i=document.body.classList.contains("break-sm");if("true"===this.docked&&!i){this.docked="false",t=t||10,e=e||10;let i={top:0,left:0,width:0,height:0};this.paletteDock.getBounds&&(i=this.paletteDock.getChartBoundsOffset()),t>i.left+i.width-this.clientWidth&&(t=i.left+i.width-this.clientWidth),this.setTransformPosition(t,e),this.paletteDock.setChartDimensions(),this.paletteDock.setVerticalPaletteHeight()}}dock(){"false"===this.docked&&(this.docked="true",this.paletteDock.setChartDimensions(),this.paletteDock.setVerticalPaletteHeight())}getHeight(){return this.clientHeight}getWidth(){return this.clientWidth}checkPosition(){let t={top:0,left:0,width:0,height:0};this.paletteDock.getBounds&&(t=this.paletteDock.getChartBoundsOffset());const e=this.style.transform.split(/\w+\(|\);?/)[1].split(/,\s?/g).map((function(t){return parseInt(t)}));e[0]+=t.left+.5*this.dragStrip.clientWidth,e[1]+=t.top+.5*this.dragStrip.clientHeight,this.setTransformPosition(e[0],e[1])}setTransformPosition(t,e){let i={top:0,left:0,width:0,height:0};this.paletteDock.getBounds&&(i=this.paletteDock.getChartBoundsOffset());let n=Math.floor(e-i.top-.5*this.dragStrip.clientHeight),s=Math.floor(t-i.left-.5*this.dragStrip.clientWidth);n=Math.min(Math.max(n,this.dragMargin),i.height-(this.dragStrip.clientHeight+this.dragMargin)),s=Math.min(Math.max(s,this.dragMargin),i.width-(this.dragStrip.clientWidth+this.dragMargin)),this.setTransform(s,n)}setTransform(t,e){this.style.transform="translate3d("+t+"px,"+e+"px, 0px)"}setHeightToPosition(t){let e={top:0,left:0,width:0,height:0};this.paletteDock.getBounds&&(e=this.paletteDock.getBounds());let i=this.getBoundingClientRect(),n=t-i.top;"vertical"===this.orientation&&n>this.minHeight&&n+(i.top-e.top)<e.height&&this.setHeight(n)}setHeightByScale(t){this.style.height=Math.floor(parseInt(this.style.height,10)*t)+"px"}setHeight(t){this.style.height=t+"px"}}e.UI.Palette=A,e.UI.addComponentDefinition("cq-palette",A);class P extends e.UI.ContextTag{constructor(){super()}pairUp(t){this.undo=o(t)[0],this.undo.redoButton=this;var e=this;o(this).stxtap((function(){e.undo.redo()}))}}e.UI.Redo=P,e.UI.addComponentDefinition("cq-redo",P);class N extends e.UI.BaseComponent{constructor(){super(),this.node=o(this)}connectedCallback(){if(!this.attached&&(super.connectedCallback(),void 0===this.node.attr("cq-no-scroll"))){this.node.css({"overflow-y":"auto"}),this.uiManager=e.UI.getUIManager(),this.uiManager.length>0&&(this.uiManager=this.uiManager[0]);var t=this.node;t.perfectScrollbar&&t.perfectScrollbar({suppressScrollX:!0}),void 0===t.attr("cq-no-claim")&&this.addClaim(this),this.addEventListener(e.wheelEvent,(function(t){t.stopPropagation()}),{passive:!0});var i=this;e.UI.addResizeListener(this,(function(){i.resize()})),this.resize()}}disconnectedCallback(){e.UI.removeResizeListener(this),super.disconnectedCallback()}focused(){var t=this.node.find("cq-item[cq-focused]");return t.length?t[0]:null}keyStroke(t,e,i){var n=this.node;if(!n.is(":trulyvisible"))return!1;switch(e){case"ArrowUp":case"ArrowDown":case"Enter":case" ":case"Up":case"Down":case"Spacebar":break;default:return!1}var s=n.find("cq-item");if(s.length){var a=n.find("cq-item[cq-focused]");if(" "==e||"Spacebar"==e||"Enter"==e)return!(!a.length||!a[0].selectFC||(a[0].selectFC.call(a,i),0));if(!a.length)return o(s[0]).attr("cq-focused","true"),this.scrollToElement(s[0]),!0;s.removeAttr("cq-focused");for(var r=0;r<s.length&&s[r]!==a[0];r++);return"ArrowUp"!=e&&"Up"!=e||--r<0&&(r=0),"ArrowDown"!=e&&"Down"!=e||++r>=s.length&&(r=s.length-1),o(s[r]).attr("cq-focused","true"),this.scrollToElement(s[r]),!0}}resize(){var t=this.node,i=e.UI.getMyContext(this);if(!t.parents(".sharing").length&&void 0===t.attr("cq-no-resize")){void 0!==t.attr("cq-no-maximize")&&(this.noMaximize=!0);var n,s=t[0].getBoundingClientRect(),a=t.prop("reduceMenuHeight")||45;if(n=i&&i.topNode?i.topNode.offsetHeight:window.innerHeight){var r=n-s.top-a,c=t.parents(".stx-holder,.stx-subholder,.chartContainer");c.length&&c.each((function(){var t=o(this),e=t[0].getBoundingClientRect().top+t.height();r=Math.min(r,e-s.top-5)}));for(var l=t.nextAll(),h=0;h<l.length;h++){var d=o(l[h]);d.is(":visible")&&(r-=d.outerHeight())}this.noMaximize||t.css({height:r+"px"}),t.css({"max-height":r+"px"}),t.perfectScrollbar&&t.perfectScrollbar("update")}}}scrollToElement(t){var e=this.clientHeight,i=this.scrollTop,n=t.offsetTop+t.clientHeight;t.offsetTop>i&&n<e+i||(this.scrollTop=Math.max(n-e,0),this.node.perfectScrollbar&&this.node.perfectScrollbar("update"))}top(){this.scrollTop=0,this.node.perfectScrollbar&&this.node.perfectScrollbar("update")}refresh(){this.node.perfectScrollbar&&this.node.perfectScrollbar("update")}}e.UI.Scroll=N,e.UI.addComponentDefinition("cq-scroll",N);class H extends e.UI.ContextTag{setContext(){this.addDefaultMarkup()}tap(t){const{context:e}=this;e.config?this.channelWrite(e.config.channels.dialog,{type:"share",params:{context:e}},e.stx):document.querySelector("cq-share-dialog").open({context:e})}}H.markup='<div stxtap="tap();">Share</div>',e.UI.ShareButton=H,e.UI.addComponentDefinition("cq-share-button",H);class z extends e.UI.DialogContentTag{constructor(){super()}open(t){this.addDefaultMarkup(),this.setState("share-create"),super.open(t)}close(){this.setState("share-create"),super.close()}setState(t){this.addDefaultMarkup(),this.node.find("div[cq-share-dialog-div]")[0].className=t}share(){var t=this.context.stx,i=this;i.setState("share-generate"),o("cq-share-dialog .share-link-div").html(""),e.UI.bypassBindings=!0,e.Share.createImage(t,{hide:[".stx_chart_controls",".stx-btn-panel",".stx_jump_today",".stx-baseline-handle",".ciq-edit",".ciq-close","cq-marker-label"]},(function(n){e.UI.bypassBindings=!1;var s=e.uniqueID(),a="https://share.chartiq.com",r=t.getStartDateOffset(),c={layout:t.exportLayout(),drawings:t.exportDrawings(),xOffset:r,startDate:t.chart.dataSegment[r].Date,endDate:t.chart.dataSegment[t.chart.dataSegment.length-1].Date,id:s,symbol:t.chart.symbol},l=a+"/upload/"+s,h={id:s,image:n,config:c};i.setState("share-upload"),e.Share.uploadImage(n,l,h,(function(t,n){i.setState("share-copy"),null!==t?e.alert("error: "+t):o("cq-share-dialog .share-link-div").html(a+n)}))}))}copy(){var t=o("cq-share-dialog .share-link-div")[0].innerText,i=document.createElement("input");if(i.type="text",i.value=t,i.contentEditable=!0,i.readOnly=!0,document.body.appendChild(i),i.focus(),i.select(),!e.isIE){var n=document.createRange();n.selectNodeContents(i);var s=window.getSelection();s.removeAllRanges(),s.addRange(n),i.setSelectionRange(0,t.length)}document.execCommand("copy"),document.body.removeChild(i),this.setState("share-copied")}}e.UI.ShareDialog=z,z.markup='\n\t\t<h4 class="title">Share Your Chart</h4>\n\t\t<cq-close></cq-close>\n\t\t<div cq-share-dialog-div>\n\t\t\t<cq-separator></cq-separator>\n\t\t\t<cq-share-create class="ciq-btn" stxtap="share()">Create Image</cq-share-create>\n\t\t\t<cq-share-generating>Generating Image</cq-share-generating>\n\t\t\t<cq-share-uploading>Uploading Image</cq-share-uploading>\n\t\t\t<div class="share-link-div"></div>\n\t\t\t<cq-share-copy class="ciq-btn" stxtap="copy()">Copy Link to Clipboard</cq-share-copy>\n\t\t\t<cq-share-copied>Link Copied!</cq-share-copied>\n\t',e.UI.addComponentDefinition("cq-share-dialog",z);class _ extends e.UI.ContextTag{set(t,e,i,n,s,a){var o=this;o.context.loader&&o.context.loader.show();var r={multiplier:e,base:i};n&&(r.periodicity={interval:n,period:s||1,timeUnit:a}),o.context.stx.setSpan(r,(function(){o.context.loader&&o.context.loader.hide()}))}setContext(t){const e=t.config&&t.config.getMenu("rangeMenu");this.addDefaultMarkup(this,e&&e.join(""))}}_.markup='\n\t\t<div stxtap="set(1,\'today\');">1D</div>\n\t\t<div stxtap="set(5,\'day\',30,2,\'minute\');">5D</div>\n\t\t<div stxtap="set(1,\'month\',30,8,\'minute\');">1M</div>\n\t\t<div class="hide-sm" stxtap="set(3,\'month\');">3M</div>\n\t\t<div class="hide-sm" stxtap="set(6,\'month\');">6M</div>\n\t\t<div class="hide-sm" stxtap="set(1,\'YTD\');">YTD</div>\n\t\t<div stxtap="set(1,\'year\');">1Y</div>\n\t\t<div class="hide-sm" stxtap="set(5,\'year\',1,1,\'week\');">5Y</div>\n\t\t<div class="hide-sm" stxtap="set(1,\'all\');">All</div>\n\t',e.UI.ShowRange=_,e.UI.addComponentDefinition("cq-show-range",_);class F extends e.UI.ContextTag{setContext({config:{channels:t},stx:e}){const i=this.querySelector("div"),n=this.getAttribute("cq-on")||"sidenavOn",s=this.getAttribute("cq-off")||"sidenavOff",a=()=>{const e="break-sm"===this.channelRead(t.breakpoint),s=e&&this.channelRead(t.sidenav)===n;i.classList.remove("sidenav","ciq-toggles"),i.classList.add(e?"sidenav":"ciq-toggles"),i.classList[s?"add":"remove"]("active"),this.channelWrite(t.sidenavSize,s?i.offsetWidth:0)};this.channelSubscribe(t.sidenav,a),this.channelSubscribe(t.breakpoint,a),this.channelSubscribe(t.tfc,(e=>{e&&this.channelWrite(t.sidenav,s)}))}}e.UI.SideNav=F,e.UI.addComponentDefinition("cq-side-nav",F);class R extends e.UI.ContextTag{constructor(){super(),this.callbacks=[]}setContext(t){const{config:e,stx:i}=t;if(!e)return;const n=this.resizeMyself.bind(this),{node:s}=this;function a(){setTimeout(n)}function o(t){t?s.attr("cq-active",!0):s.removeAttr("cq-active"),a()}this.channelSubscribe(e.channels.breakpoint,a),this.channelSubscribe(e.channels.tfc,o,i)}close(){this.node.removeAttr("cq-active"),this.node.children().each((function(){this.sidePanelActiveClass?o(this).removeClass(this.sidePanelActiveClass):o(this).removeAttr(this.sidePanelActiveAttribute)}));var t=this;setTimeout((function(){t.resizeMyself()}),0)}nonAnimatedWidth(){var t=0;return this.node.children().width((function(e,i){t+=i})),t}open(t){this.close();var e=this.node.find(t.selector);t.className?(e.addClass(t.className),e.each((function(){this.sidePanelActiveClass=t.className}))):(e.attr(t.attribute,"true"),e.each((function(){this.sidePanelActiveAttribute=t.attribute}))),this.node.attr("cq-active","true");var i=this;setTimeout((function(){i.resizeMyself()}),0)}registerCallback(t){this.callbacks.push(t)}resizeMyself(){var t=0;this.node.children().width((function(e,i){t+=i})),this.node.css({width:t+"px"});for(var e=0;e<this.callbacks.length;e++)this.callbacks[e].call(this,t);const{config:i,stx:n}=this.context||{};i&&this.channelWrite(i.channels.sidepanelSize,t,n)}}e.UI.SidePanel=R,e.UI.addComponentDefinition("cq-side-panel",R);class O extends e.UI.ContextTag{constructor(){super()}disconnectedCallback(){this.context&&e.UI.unobserveProperty("studyLibraryHash",this.context.stx.chart,this.listener),super.disconnectedCallback()}initialize(t){this.addDefaultMarkup(),this.params=t||{},this.alwaysDisplayDialog=this.params.alwaysDisplayDialog||!1,this.excludedStudies=this.params.excludedStudies||[],this.params.template||(this.params.template="template"),this.params.template=this.node.find(this.params.template),this.renderMenu();var i=this,n=this.context.stx;this.listener=function(t){i.renderMenu()},e.UI.observeProperty("studyLibraryHash",n.chart,this.listener)}setContext({config:t}){t&&t.menuStudiesConfig&&this.initialize(Object.assign({},t.menuStudiesConfig))}renderMenu(){var t,i=this.context.stx,n=[];for(var s in e.Studies.studyLibrary)!(t=e.Studies.studyLibrary[s])||this.excludedStudies[s]||this.excludedStudies[t.name]||void 0!==t.siqList||(t.name||(t.name=s),n.push(s));n.sort((function(t,i){var n=e.Studies.studyLibrary[t],s=e.Studies.studyLibrary[i];return n.name<s.name?-1:n.name>s.name?1:0}));for(var a=o(this.node),r=this,c=function(t,e){return function(e){p(e.target,t),a.resize()}},l=a.find("cq-studies-content");l.length>0&&l[0].firstChild;)l[0].removeChild(l[0].firstChild);for(var h=0;h<n.length;h++){var d=e.UI.makeFromTemplate(this.params.template);t=e.Studies.studyLibrary[n[h]],d.append(e.translatableTextNode(i,t.name)),this.makeTap(d[0],c(n[h],this.context)),a.find("cq-studies-content").append(d)}function u(t,e){const{context:i}=r;if(i.config)r.channelWrite(i.config.channels.dialog,{type:"study",params:Object.assign({},t,{context:i,addWhenDone:e})},i.stx);else{t.context=r.context;const i=document.querySelector("cq-study-dialog");i.addWhenDone=e,i.open(t)}}function p(t,i){var n=r.context.stx;function s(t,e,n){if(!0===t)return u(e,n),!0;if("object"==typeof t)for(var s in t)if(s==i&&t[s])return u(e,n),!0}if(!s(r.params.dialogBeforeAddingStudy,{stx:n,name:i},!0)){var a=e.Studies.addStudy(n,i);s(r.alwaysDisplayDialog,{sd:a,stx:n})}}}}e.UI.StudiesComponent=O,O.markup="\n\t\t<template>\n\t\t\t<cq-item><cq-label></cq-label></cq-item>\n\t\t</template>\n\t\t<cq-studies-content></cq-studies-content>\n\t",e.UI.addComponentDefinition("cq-studies",O);class B extends e.UI.DialogContentTag{setContext(t){this.addDefaultMarkup(),super.setContext(t)}}e.UI.StudyContext=B,B.markup='\n\t\t<div stxtap="StudyEdit.edit()">Edit Settings...</div>\n\t\t<div stxtap="StudyEdit.remove()">Delete Study</div>\n\t',e.UI.addComponentDefinition("cq-study-context",B);class W extends e.UI.DialogContentTag{constructor(){super()}connectedCallback(){this.attached||(super.connectedCallback(),this.queuedUpdates={})}close(){if(this.addWhenDone){var t=this.helper,i=e.Studies.addStudy(t.stx,t.name);e.isEmpty(this.queuedUpdates)||(t.sd=i,t.updateStudy(this.queuedUpdates),this.queuedUpdates={})}}disconnectedCallback(){e.UI.unobserveProperty("signal",this.helper),super.disconnectedCallback()}hide(){e.isEmpty(this.queuedUpdates)||(this.helper.updateStudy(this.queuedUpdates),this.queuedUpdates={}),this.node.find("cq-menu").each((function(){this.unlift&&this.unlift()})),this.node.find("cq-swatch").each((function(){this.colorPicker&&this.colorPicker.close()}))}makeMenu(t,i,n,s){var a=e.UI.makeFromTemplate(this.menuTemplate),r=a.find("cq-menu-dropdown");for(var c in n){var l=o("<cq-item></cq-item>");l.text(n[c]),l.attr("stxtap","StudyDialog.setSelectOption('"+s+"')"),r.append(l),l[0].cqMenuWrapper=r.parents("cq-menu")[0],l.attr("name",t),l.attr("value",c),l[0].context=this.context}return a.find("cq-selected").text(this.helper.stx.translateIf(i)),a}open(t){this.addDefaultMarkup(),this.selectTemplates(),super.open(t),t.axisSelect=this.getAttribute("cq-study-axis"),""===t.axisSelect&&(t.axisSelect=!0),t.panelSelect=this.getAttribute("cq-study-panel"),""===t.panelSelect&&(t.panelSelect=!0),void 0!==t.addWhenDone&&(this.addWhenDone=t.addWhenDone);var i=this;this.context.stx,e.UI.unobserveProperty("signal",this.helper),this.helper=new e.Studies.DialogHelper(t),e.UI.observeProperty("signal",this.helper,(function(e){i.refreshParameters(t)}));var n=o(this);n.find(".title").text(this.helper.title);var s=n.find("cq-study-inputs");function a(t){return(t=t.replace(/-/g,"")).search(/^\d{8}$/)||(t=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8)),t}function r(t){return(t=t.replace(/:/g,"")).search(/^\d{4,6}$/)||(t=t.substring(0,2)+":"+t.substring(2,4)+(4==t.length?"":":"+t.substring(4,6))),t}s.empty();for(var c=0;c<this.helper.inputs.length;c++){var l=this.helper.inputs[c],h=e.UI.makeFromTemplate(this.inputTemplate,s);this.menuTemplate=h.find("template[cq-menu]"),h.find(".ciq-heading").text(l.heading),h[0].fieldName=l.name;var d,u=null,p=this.helper.attributes[l.name];if("number"==l.type)for(d in(u=o("<input>")).attr("type","number"),u.val(l.value),this.setChangeEvent(u,"inputs",l.name),p){var m=p[d];(e.isIE||e.isEdge)&&"step"==d&&Math.floor(m)!=m&&(m="any"),u.attr(d,m)}else if("text"==l.type||"date"==l.type||"time"==l.type)for(d in(u=o("<input>")).attr("type",e.UI.supportedInputType(l.type)),"date"==l.type?u.val(a(l.value)):"time"==l.type?u.val(r(l.value)):u.val(l.value),this.setChangeEvent(u,"inputs",l.name),p)u.attr(d,p[d]);else if("select"==l.type)u=this.makeMenu(l.name,l.value,l.options,"inputs"),p&&p.readonly&&u.attr("readonly",p.readonly);else if("checkbox"==l.type)for(d in(u=o("<input>")).attr("type","checkbox"),l.value&&u.prop("checked",!0),this.setChangeEvent(u,"inputs",l.name),p)u.attr(d,p[d]);p&&p.hidden&&h.hide(),u&&h.find(".stx-data").append(u)}var g=n.find("cq-study-outputs");for(g.empty(),c=0;c<this.helper.outputs.length;c++){var f=this.helper.outputs[c],v=e.UI.makeFromTemplate(this.outputTemplate,g);v[0].initialize({studyDialog:this,output:f.name,params:t}),v.find(".ciq-heading").text(f.heading),v.find(".ciq-heading")[0].fieldName=f.name;var b=v.find("cq-swatch"),y=f.color;"object"==typeof y&&(y=y.color),b[0].setColor(y,!1)}this.refreshParameters(t)}refreshParameters(t){var i=o(this).find("cq-study-parameters");i.empty();for(var n=0;n<this.helper.parameters.length;n++){var s=this.helper.parameters[n],a=e.UI.makeFromTemplate(this.parameterTemplate,i);if(this.menuTemplate=a.find("template[cq-menu]"),this.menuTemplate.length||!s.options){a.find(".ciq-heading").text(s.heading);var r,c=a.find("cq-swatch"),l=o("<input>"),h={};if(s.defaultValue.constructor==Boolean)for(r in l.attr("type","checkbox"),s.value&&l.prop("checked",!0),this.setChangeEvent(l,"parameters",s.name+"Enabled"),c.remove(),h=this.helper.attributes[s.name+"Enabled"])l.attr(r,h[r]);else if(s.defaultValue.constructor==String){var d=s.name;for(r in s.defaultColor?(a[0].initialize({studyDialog:this,parameter:s.name+"Color",params:t}),c[0].setColor(s.color,!1),d+="Value"):c.remove(),s.options?l=this.makeMenu(d,s.value,s.options,"parameters"):l.val(s.value),h=this.helper.attributes[d])l.attr(r,h[r])}else{if(s.defaultValue.constructor!=Number)continue;for(r in l.attr("type","number"),l.val(s.value),this.setChangeEvent(l,"parameters",s.name+"Value"),a[0].initialize({studyDialog:this,parameter:s.name+"Color",params:t}),c[0].setColor(s.color,!1),h=this.helper.attributes[s.name+"Value"]){var u=h[r];(e.isIE||e.isEdge)&&"step"==r&&Math.floor(u)!=u&&(u="any"),l.attr(r,u)}}h&&h.hidden&&a.not("hr").hide(),a.find(".stx-data").append(l)}else a.remove()}}setChangeEvent(t,e,i){var n=this;function s(){return function(){var t={};t[e]={},t[e][i]=this.value,"checkbox"!=this.type&&"radio"!=this.type||(t[e][i]=this.checked),n.updateStudy(t)}}t.change(s())}setContext(t){this.context=t,t.advertiseAs(this,"StudyDialog")}setSelectOption(t,e){var i=o(t.node),n=i.attr("name"),s=i.attr("value"),a=o(i[0].cqMenuWrapper);a.find("cq-selected").text(this.helper.stx.translateIf(s)),a[0].fieldValue=s,e||(e="inputs");var r={};r[e]={},r[e][n]=s,this.updateStudy(r)}updateStudy(t){o(this).find(":invalid").length||(this.addWhenDone?e.extend(this.queuedUpdates,t):this.helper.libraryEntry.deferUpdate?(e.extend(this.queuedUpdates,{inputs:t.inputs}),this.helper.updateStudy({outputs:t.outputs,parameters:t.parameters})):this.helper.updateStudy(t))}selectTemplates(){this.inputTemplate||(this.inputTemplate=this.querySelector("template[cq-study-input]"),this.outputTemplate=this.querySelector("template[cq-study-output]"),this.parameterTemplate=this.querySelector("template[cq-study-parameters]"))}}e.UI.StudyDialog=W,W.markup='\n\t\t<h4 class="title">Study here</h4>\n\t\t<cq-scroll cq-no-maximize>\n\t\t\t<cq-study-inputs>\n\t\t\t\t<template cq-study-input>\n\t\t\t\t\t<cq-study-input>\n\t\t\t\t\t\t<div class="ciq-heading"></div>\n\t\t\t\t\t\t<div class="stx-data">\n\t\t\t\t\t\t\t<template cq-menu>\n\t\t\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t\t\t<cq-selected></cq-selected>\n\t\t\t\t\t\t\t\t\t<cq-menu-dropdown cq-lift></cq-menu-dropdown>\n\t\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</cq-study-input>\n\t\t\t\t\t<hr>\n\t\t\t\t</template>\n\t\t\t</cq-study-inputs>\n\t\t\t<cq-study-outputs>\n\t\t\t\t<template cq-study-output>\n\t\t\t\t\t<cq-study-output>\n\t\t\t\t\t\t<div class="ciq-heading"></div>\n\t\t\t\t\t\t<cq-swatch cq-overrides="auto"></cq-swatch>\n\t\t\t\t\t</cq-study-output>\n\t\t\t\t\t<hr>\n\t\t\t\t</template>\n\t\t\t</cq-study-outputs>\n\t\t\t<cq-study-parameters>\n\t\t\t\t<template cq-study-parameters>\n\t\t\t\t\t<cq-study-parameter>\n\t\t\t\t\t\t<div class="ciq-heading"></div>\n\t\t\t\t\t\t<div class="stx-data"><cq-swatch cq-overrides="auto"></cq-swatch>\n\t\t\t\t\t\t\t<template cq-menu>\n\t\t\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t\t\t<cq-selected></cq-selected>\n\t\t\t\t\t\t\t\t\t<cq-menu-dropdown cq-lift></cq-menu-dropdown>\n\t\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</cq-study-parameter>\n\t\t\t\t\t<hr>\n\t\t\t\t</template>\n\t\t\t</cq-study-parameters>\n\t\t</cq-scroll>\n\t\t<div class="ciq-dialog-cntrls">\n\t\t\t<div class="ciq-btn" stxtap="close()">Done</div>\n\t\t</div>\n\t',e.UI.addComponentDefinition("cq-study-dialog",W);class V extends e.UI.DialogContentTag{constructor(){super()}}e.UI.StudyInput=V,e.UI.addComponentDefinition("cq-study-input",V);class j extends e.UI.ModalTag{constructor(){super()}connectedCallback(){this.attached||(super.connectedCallback(),void 0!==this.node.attr("cq-clone-to-panels")&&o("body").addClass("stx-panel-legend"))}begin(){if(!this.init){var t=this.context.stx,e=this.node;this.template=e.find("template[cq-study-legend]"),this.template.length||(this.template=e.find("template")),this.contentKeys=e.attr("cq-content-keys")||"cq-label",this.eventListeners.push(t.addEventListener("layout",this.renderLegend.bind(this))),e[0].hasAttribute("cq-marker")&&e.stxtap((function(){e.toggleClass("ciq-active")})),this.renderLegend(),this.init=!0}}launchColorPicker(){this.node.addClass("ciq-active")}renderLegend(){var t=this.context.stx;function i(t,i){return function(n){setTimeout((function(){i.permanent||e.Studies.removeStudy(t.context.stx,i),t.node[0].hasAttribute("cq-marker")&&t.context.stx.modalEnd(),t.renderLegend()}),0)}}function n(e,i){return function(n){var s=t.layout.studies[i];if(!s.permanent&&s.editFunction){n.stopPropagation(),e.uiManager.closeMenu();var a=e.context.getAdvertised("StudyEdit"),o={stx:t,sd:s,inputs:s.inputs,outputs:s.outputs,parameters:s.parameters};a.editPanel(o)}}}o(this.template).nextAll().remove();var s=void 0!==this.node.attr("cq-overlays-only"),a=void 0!==this.node.attr("cq-panel-only"),r=void 0!==this.node.attr("cq-custom-removal-only"),c=this.node.attr("cq-marker-label"),l=null,h=this.node.parents(".stx-holder")[0];for(var d in h&&(l=h.panel.name),t.layout.studies){var u=t.layout.studies[d];if(!u.customLegend&&(!r||u.study.customRemoval)&&(!a||u.panel==l)&&(!s||u.overlay||u.underlay)){var p=e.UI.makeFromTemplate(this.template,!0);p.find("cq-label").html(u.inputs.display);var m=p.find(".ciq-close");u.permanent?m.hide():m.stxtap(i(this,u));var g=p.find(".ciq-edit");g.length||(g=p.find("cq-label")),g.stxtap(n(this,d))}}void 0!==c&&(this.node.find("cq-marker-label").length||this.node.prepend("<cq-marker-label>"+c+"</cq-marker-label>")),this.displayLegendTitle()}displayLegendTitle(){function t(t,e){return Array.from(t.querySelectorAll(e)).some(i)}function i(t){for(;t;){if("template"===t.nodeName.toLowerCase())return!1;t=t.parentElement}return!0}t(this,this.contentKeys)?(this.node.css("display",""),this.node.parents("div.stx-panel-legend").css("width","")):(this.node.css("display","none"),this.node.parents("div.stx-panel-legend").css("width","0px")),e.I18N.translateUI(null,this.node[0])}setContext(t){var e=this;void 0!==e.node.attr("cq-clone-to-panels")&&(e.spawnPanelLegend(),t.stx.append("stackPanel",(function(t,i){e.spawnPanelLegend()}))),this.init||this.begin()}spawnPanelLegend(){var t=this.context.stx;function e(t){return function(e){t.toggleClass("ciq-active")}}for(var i in t.panels)if(i!=t.chart.panel.name){var n=o(t.panels[i].icons).find(".stx-panel-legend");if(n.length){var s=n.find(this.node[0].nodeName);if(!s.length){(s=this.node.clone()).attr("cq-marker-label",this.node.attr("cq-clone-to-panels")).removeAttr("cq-clone-to-panels").removeAttr("cq-overlays-only").removeAttr("cq-marker").stxtap(e(s)).find("cq-marker-label").remove();var a=o("<cq-study-legend-fixed-wrapper></cq-study-legend-fixed-wrapper>");a.append(s),n.append(a),s[0].begin()}}}}}e.UI.StudyLegend=j,e.UI.addComponentDefinition("cq-study-legend",j);class Y extends e.UI.BaseComponent{constructor(){super()}initialize(t){this.params=t}setColor(t){if(this.params){var e={outputs:{}};e.outputs[this.params.output]={},e.outputs[this.params.output].color=t,this.params.studyDialog.updateStudy(e)}}}e.UI.StudyOutput=Y,e.UI.addComponentDefinition("cq-study-output",Y);class X extends e.UI.DialogContentTag{constructor(){super()}initialize(t){this.params=t}setColor(t){if(this.params){var e={parameters:{}};e.parameters[this.params.parameter]=t,this.params.studyDialog.updateStudy(e)}}}e.UI.StudyParameter=X,e.UI.addComponentDefinition("cq-study-parameter",X);class Q extends HTMLElement{constructor(){super(),this.defaultColor=null}connectedCallback(){this.attached||(this.attached=!0,this.node=o(this),this.getAttribute("cq-static")?this.style.cursor="default":this.node.stxtap(function(t){return function(e){t.launchColorPicker(),e.stopPropagation()}}(this)))}getDefaultColor(){if(this.defaultColor)return this.defaultColor;var t=e.UI.getMyContext(this);return t?t.stx.defaultColor:"transparent"}setColor(t,i,n){var s=o(this),a=e.getBackgroundColor(this.parentNode),r=e.chooseForegroundColor(a),c=e.hsl(a);"auto"==t&&(n=!0),t||(t="transparent");var l=t;"auto"==t?l=this.getDefaultColor():0===t.indexOf("rgba(")&&(l=(l.split(",").slice(0,3).join(",")+")").replace(/rgba/,"rgb"));var h=e.hsl(l),d=e.isTransparent(t);s.css({background:l}),n||Math.abs(c[2]-h[2])<.2||d?(s.css({border:"solid "+r+" 1px"}),d&&s.css({background:"linear-gradient(to bottom right, transparent, transparent 49%, "+r+" 50%, transparent 51%, transparent)"})):s.css({border:""}),n&&(a=e.chooseForegroundColor(l),s.css({background:"linear-gradient(to bottom right, "+l+", "+l+" 49%, "+a+" 50%, "+a+")"})),!1!==i&&e.UI.containerExecute(this,"setColor",t,this)}launchColorPicker(){var t=o(this);e.UI.containerExecute(this,"launchColorPicker");var i=o("cq-color-picker")[0];i.callback=function(t){return function(e){t.setColor(e,null)}}(this);var n=this.node.attr("cq-overrides");n&&(n=n.split(",")),i.display({node:t,context:e.UI.getMyContext(this),overrides:n}),this.colorPicker=i}}e.UI.Swatch=Q,e.UI.addComponentDefinition("cq-swatch",Q);class K extends e.UI.DialogContentTag{constructor(){super()}applyChanges(){var t=this.context.stx;this.helper.update(t),t.changeOccurred("theme")}close(){this.helper.settings=this.revert,this.applyChanges(),super.close()}open(t){this.addDefaultMarkup(),super.open(t);var i=t.themeName;this.initiatingMenu=t.initiatingMenu,this.context=t.context,this.helper=new e.ThemeHelper({stx:this.context.stx}),this.revert=e.clone(this.helper.settings);var n=this;function s(t,e,i,s){var a=n.node.find('cq-theme-piece[cq-piece="'+t+'"]');a.length&&(a[0].piece={obj:e,field:i},"color"==s&&a.find("cq-swatch")[0].setColor(e[i],!1))}var a=this.helper.settings;s("cu",a.chartTypes["Candle/Bar"].up,"color","color"),s("cd",a.chartTypes["Candle/Bar"].down,"color","color"),s("wu",a.chartTypes["Candle/Bar"].up,"wick","color"),s("wd",a.chartTypes["Candle/Bar"].down,"wick","color"),s("bu",a.chartTypes["Candle/Bar"].up,"border","color"),s("bd",a.chartTypes["Candle/Bar"].down,"border","color"),s("lc",a.chartTypes.Line,"color","color"),s("mb",a.chartTypes.Mountain,"basecolor","color"),s("mc",a.chartTypes.Mountain,"color","color"),s("bg",a.chart.Background,"color","color"),s("gl",a.chart["Grid Lines"],"color","color"),s("dd",a.chart["Grid Dividers"],"color","color"),s("at",a.chart["Axis Text"],"color","color"),i||(i="My Theme"),this.node.find("cq-action input").val(i)}save(){var t=this.node.find("cq-action input").val(),i={settings:e.clone(this.helper.settings),name:t,builtIn:null};e.UI.contextsForEach((function(){this.stx.updateListeners("theme")}));var n=this;o("cq-themes").each((function(){i.builtIn=this.currentLoadedBuiltIn,this.addCustom(i,n.initiatingMenu)})),super.close()}setValue(t,e,i){t[e]=i,this.applyChanges()}}e.UI.ThemeDialog=K,K.markup='\n\t\t<h4 class="title">Create Custom Theme</h4>\n\t\t<cq-close></cq-close>\n\t\t<cq-scroll cq-no-maximize>\n\t\t\t<cq-section>\n\t\t\t\t<cq-placeholder>Candle Color\n\t\t\t\t\t<cq-theme-piece cq-piece="cu"><cq-swatch cq-overrides="Hollow"></cq-swatch></cq-theme-piece>\n\t\t\t\t\t<cq-theme-piece cq-piece="cd"><cq-swatch cq-overrides="Hollow"></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-placeholder>Candle Wick\n\t\t\t\t\t<cq-theme-piece cq-piece="wu"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t\t<cq-theme-piece cq-piece="wd"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-placeholder>Candle Border\n\t\t\t\t\t<cq-theme-piece cq-piece="bu"><cq-swatch cq-overrides="No Border"></cq-swatch></cq-theme-piece>\n\t\t\t\t\t<cq-theme-piece cq-piece="bd"><cq-swatch cq-overrides="No Border"></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-separator></cq-separator>\n\t\t\t\t<cq-placeholder>Line/Bar Chart\n\t\t\t\t\t<cq-theme-piece cq-piece="lc"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-separator></cq-separator>\n\t\t\t\t<cq-placeholder>Mountain Base\n\t\t\t\t\t<cq-theme-piece cq-piece="mb"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-placeholder>Mountain Peak\n\t\t\t\t\t<cq-theme-piece cq-piece="mc"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t</cq-section>\n\t\t\t<cq-section>\n\t\t\t\t<cq-placeholder>Background\n\t\t\t\t\t<cq-theme-piece cq-piece="bg"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-placeholder>Grid Lines\n\t\t\t\t\t<cq-theme-piece cq-piece="gl"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-placeholder>Date Dividers\n\t\t\t\t\t<cq-theme-piece cq-piece="dd"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t\t<cq-placeholder>Axis Text<cq-theme-piece cq-piece="at"><cq-swatch></cq-swatch></cq-theme-piece>\n\t\t\t\t</cq-placeholder>\n\t\t\t</cq-section>\n\t\t\t<cq-action>\n\t\t\t\t<input><div stxtap="save()" class="ciq-btn">Save</div>\n\t\t\t</cq-action>\n\t\t</cq-scroll>\n\t',e.UI.addComponentDefinition("cq-theme-dialog",K);class G extends e.UI.BaseComponent{constructor(){super()}setBoolean(t){e.UI.containerExecute(this,"setValue",this.piece.obj,this.piece.field,t)}setColor(t){"Hollow"!=t&&"No Border"!=t||(t="transparent",this.node.find("cq-swatch")[0].setColor("transparent",!1)),e.UI.containerExecute(this,"setValue",this.piece.obj,this.piece.field,t)}}e.UI.ThemePiece=G,e.UI.addComponentDefinition("cq-theme-piece",G);class Z extends e.UI.ContextTag{constructor(){super()}connectedCallback(){this.attached||super.connectedCallback()}setContext({config:t}){if(!t)return;const{chartId:e,themes:{builtInThemes:i,defaultTheme:n},nameValueStore:s}=t;this.initialize({builtInThemes:i,defaultTheme:n,nameValueStore:s,id:e})}addCustom(t,e){this.params.customThemes[t.name]=t,e===this&&(this.currentTheme=t.name),this.configureMenu(),this.persist()}configureMenu(){function t(t,e){return function(i){t.loadBuiltIn(e),t.params.callback&&t.params.callback({theme:t.currentTheme}),t.persist("current")}}function i(t,e){return function(i){t.loadCustom(e),t.params.callback&&t.params.callback({theme:t.currentTheme}),t.persist("current")}}var n,s;this.builtInMenu.emptyExceptTemplate(),this.customMenu.emptyExceptTemplate();var a=this.params.builtInThemes;for(var o in a)n=a[o],(s=e.UI.makeFromTemplate(this.builtInTemplate)).text(n),this.makeTap(s[0],t(this,o)),this.builtInMenu.append(s);e.I18N.translateUI(null,this.builtInMenu[0]);var r=this.params.customThemes;for(var c in r)n=c,(s=e.UI.makeFromTemplate(this.customTemplate)).find("cq-label").text(n),this.makeTap(s.find("cq-item")[0],i(this,c)),s[0].close=function(t,e){return function(){t.removeTheme(e)}}(this,c),this.customMenu.append(s)}initialize(t){if(!this.initialized){this.initialized=!0,this.addDefaultMarkup(),this.selectTemplates(this),this.params={},t&&(this.params=t),this.params.customThemes||(this.params.customThemes={}),this.params.builtInThemes||(this.params.builtInThemes={}),this.params.nameValueStore||(this.params.nameValueStore=new e.NameValueStore),this.params.id&&(this.id="themes_"+this.params.id);var i=this;this.params.nameValueStore?this.params.nameValueStore.get("CIQ.Themes.prototype.custom",(function(t,e){!t&&e&&(i.params.customThemes=e),i.params.nameValueStore.get(i.id+"CIQ.Themes.prototype.current",(function(t,e){!t&&e&&e.theme?i.loadTheme(e.theme):i.loadTheme(i.params.defaultTheme),i.configureMenu()}))})):this.loadTheme(i.params.defaultTheme)}}loadBuiltIn(t){this.currentLoadedBuiltIn&&o(this.context.topNode).removeClass(this.currentLoadedBuiltIn),o(this.context.topNode).addClass(t),this.currentLoadedBuiltIn=this.currentTheme=t,this.reinitializeChart()}loadCustom(t){this.currentLoadedBuiltIn&&o(this.context.topNode).removeClass(this.currentLoadedBuiltIn);var e=this.params.customThemes[t];e.builtIn&&o(this.context.topNode).addClass(e.builtIn),this.currentLoadedBuiltIn=e.builtIn,this.currentTheme=e.name,this.reinitializeChart(e)}loadTheme(t){this.params.customThemes[t]?this.loadCustom(t):this.params.builtInThemes[t]?this.loadBuiltIn(t):this.loadBuiltIn(this.params.defaultTheme)}newTheme(){const{context:t}=this;t.config?this.channelWrite(t.config.channels.dialog,{type:"theme",params:{context:t,initiatingMenu:this}},t.stx):document.querySelector("cq-theme-dialog").open({context:this.context,initiatingMenu:this})}persist(t){this.params.nameValueStore&&(t&&"current"!=t||this.params.nameValueStore.set(this.id+"CIQ.Themes.prototype.current",{theme:this.currentTheme}),t&&"custom"!=t||this.params.nameValueStore.set("CIQ.Themes.prototype.custom",this.params.customThemes))}removeTheme(t){var e=!1;o("cq-themes").each((function(){delete this.params.customThemes[t],this.configureMenu(),e||(this.persist(),e=!0)}))}selectTemplates(){this.builtInMenu||(this.builtInMenu=o(this).find("cq-themes-builtin"),this.builtInTemplate=this.builtInMenu.find("template"),this.customMenu=o(this).find("cq-themes-custom"),this.customTemplate=this.customMenu.find("template"))}reinitializeChart(t){this.context.stx.setThemeSettings(t?t.settings:null)}}e.UI.Themes=Z,Z.markup='\n\t\t<cq-themes-builtin cq-no-close>\n\t\t\t<template>\n\t\t\t\t<cq-item></cq-item>\n\t\t\t</template>\n\t\t</cq-themes-builtin>\n\t\t<cq-themes-custom cq-no-close>\n\t\t\t<template>\n\t\t\t\t<cq-theme-custom>\n\t\t\t\t\t<cq-item>\n\t\t\t\t\t\t<cq-label></cq-label>\n\t\t\t\t\t\t<cq-close></cq-close>\n\t\t\t\t\t</cq-item>\n\t\t\t\t</cq-theme-custom>\n\t\t\t</template>\n\t\t</cq-themes-custom>\n\t\t<cq-separator cq-partial></cq-separator>\n\t\t<cq-item stxtap="newTheme()"><cq-plus></cq-plus>New Theme</cq-item>\n\t',e.UI.addComponentDefinition("cq-themes",Z);class J extends e.UI.DialogContentTag{constructor(){super()}open(t){this.addDefaultMarkup(),super.open(t);var i=this.node,n=this;this.context=t.context;var s=this.context.stx;function a(t){return function(i){n.close();var a=e.timeZoneMap[t];e.ChartEngine.defaultDisplayTimeZone=a,s.setTimeZone(s.dataZone,a),s.chart.symbol&&s.draw()}}var o=i.find("ul"),r=i.find(".ciq-btn");for(var c in this.template||(this.template=o.find("li.timezoneTemplate")[0].cloneNode(!0)),o.empty(),e.timeZoneMap){var l=c,h=s.translateIf(l),d=this.template.cloneNode(!0);d.style.display="block",d.innerHTML=h,e.safeClickTouch(d,a(l)),o.append(d)}var u=i.find(".currentUserTimeZone");if(s.displayZone){var p=s.displayZone;for(var m in e.timeZoneMap)e.timeZoneMap[m]===s.displayZone&&(p=m);u.text(s.translateIf("Current Timezone is")+" "+s.translateIf(p)),r.show()}else u.text(s.translateIf("Your timezone is your current location")),r.hide()}removeTimezone(){e.ChartEngine.defaultDisplayTimeZone=null;var t=this.context.stx;t.displayZone=null,t.setTimeZone(),t.displayInitialized&&t.draw(),this.close()}}e.UI.TimezoneDialog=J,J.markup='\n\t\t<h4 class="title">Choose Timezone</h4>\n\t\t<cq-close></cq-close>\n\n\t\t<p>To set your timezone use the location button below, or scroll through the following list...</p>\n\t\t<p class="currentUserTimeZone"></p>\n\t\t<div class="detect">\n\t\t<div class="ciq-btn" stxtap="removeTimezone()">Use My Current Location</div>\n\t\t</div>\n\t\t<div class="timezoneDialogWrapper" style="max-height:360px; overflow: auto;">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li class="timezoneTemplate" style="display:none;cursor:pointer;"></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t<div class="instruct">(Scroll for more options)</div>\n\t',e.UI.addComponentDefinition("cq-timezone-dialog",J);class $ extends e.UI.ContextTag{constructor(){super()}connectedCallback(){this.attached||(this.params={member:null,obj:null,action:"class",value:"active",toggles:[],classes:{},callbacks:[]},super.connectedCallback())}disconnectedCallback(){e.UI.unobserveProperty(this.params.member,this.params.obj,this.listener),super.disconnectedCallback()}begin(){var t=this,i=this.context.stx;this.params.member&&(this.listener=function(e){t.updateFromBinding(t.params)},e.UI.observeProperty(t.params.member,t.params.obj,this.listener)),this.node.stxtap((function(){var e=t.params.toggles,n=t.params.obj;if(e.length>1){for(var s=0;s<e.length;s++){var a=e[s];if(t.currentValue==a){s<e.length-1?t.set(e[s+1]):t.set(e[0]);break}}s==e.length&&t.set(e[0])}else t.currentValue?t.set(!1):t.set(!0);i.draw(),n===i.layout&&i.changeOccurred("layout"),n===i.preferences&&i.changeOccurred("preferences")}))}registerCallback(t,e){!1!==e&&(e=!0),this.params.callbacks.push(t),e&&t.call(this,this.currentValue)}set(t){if(this.params.member)this.params.obj[this.params.member]=t;else{this.currentValue=t;for(var e=0;e<this.params.callbacks.length;e++)this.params.callbacks[e].call(this,this.currentValue)}this.updateClass()}setContext({config:t}){this.currentValue|=!1,this.params.obj=this.context.stx.layout;var e=this.node.attr("cq-member");if("headsUp"==e&&this.wrapInInfoToggle(),t&&t.channels&&t.channels[e]&&(e=t.channels[e]),e&&-1!==e.indexOf(".")){var i=e.split(".");this.params.obj=this.context.stx[i[0]],void 0===this.params.obj&&(this.context.stx[i[0]]=this.params.obj={}),e=i[1]}e&&(this.params.member=e);var n=this.node.attr("cq-action");n&&(this.params.action=n);var s=this.node.attr("cq-value");s&&(this.params.value=s);var a=this.node.attr("cq-toggles");a&&(this.params.toggles=a.split(","));for(var o=0;o<this.params.toggles.length;o++){var r=(a=this.params.toggles)[o];"null"===r?a[o]=null:"true"===r||"false"===r?a[o]="true"===r:isNaN(Number(r))||(a[o]=Number(r))}var c=this.node.attr("cq-toggle-classes");if(c){var l=c.split(/, |,/);this.params.removeClasses=c.split(/, | |,/).filter((t=>t)),this.params.classes=this.params.toggles.reduce((function(t,e,i){return t[e]=l[i].split(/ /),t}),{})}if(e&&void 0===this.params.obj[e]){const t=!(!a||!a.length)&&a[a.length-1];this.params.obj[e]=t}this.begin()}updateFromBinding(t){if(this.currentValue=t.obj[t.member],this.params.callbacks.length)for(var e=0;e<this.params.callbacks.length;e++)this.params.callbacks[e].call(this,this.currentValue);else"class"==this.params.action&&(this.currentValue?this.node.addClass(this.params.value):this.node.removeClass(this.params.value));this.updateClass(),"crosshair"==t.member&&!1===this.currentValue&&this.context.stx.doDisplayCrosshairs()}updateClass(){const{removeClasses:t,classes:e}=this.params;if(t&&void 0!==this.currentValue&&(this.classList.remove(...t),e[this.currentValue][0])){let t=e[this.currentValue];this.classList.add(...t)}}wrapInInfoToggle(){if(!e.findClosestParent(this,"cq-info-toggle")){var t=document.createElement("cq-info-toggle");this.parentNode.replaceChild(t,this),t.appendChild(this)}}}e.UI.Toggle=$,e.UI.addComponentDefinition("cq-toggle",$);class tt extends e.UI.ContextTag{constructor(){super()}connectedCallback(){this.attached||(super.connectedCallback(),this.node=o(this),this.params={toolSelection:this.node.find("*[cq-current-tool]"),lineSelection:this.node.find("*[cq-line-style]"),fontSizeSelection:this.node.find("*[cq-font-size]"),fontFamilySelection:this.node.find("*[cq-font-family]"),fontStyleToggle:this.node.find("cq-annotation-italic"),fontWeightToggle:this.node.find("cq-annotation-bold"),axisLabelToggle:this.node.find("cq-axis-label .ciq-checkbox"),fillColor:this.node.find("cq-fill-color").not("cq-cvp-controller"),lineColor:this.node.find("cq-line-color").not("cq-cvp-controller"),cvpControllers:this.node.find("cq-cvp-controller")},this.params.cvpControllers.prop("toolbar",this),this.noToolSelectedText="")}clearDrawings(){this.context.stx.clearDrawings(null,!1)}crosshairs(t){var e=this.context.stx;o(this.params.toolSelection).html(o(t.node).html()),e.changeVectorType(null),e.layout.crosshair=!0,e.doDisplayCrosshairs(),e.findHighlights(!1,!0),e.changeOccurred("layout"),e.draw(),e.updateChartAccessories(),this.node.find("*[cq-section]").removeClass("ciq-active"),this.emit()}defaultElements(t){var e=[];for(var i in t)"color"==i?e.push("cq-line-color"):"fillColor"==i?e.push("cq-fill-color"):"pattern"==i||"lineWidth"==i?e.push("cq-line-style"):"axisLabel"==i?e.push("cq-axis-label"):"font"==i?e.push("cq-annotation"):"parameters"==i&&e.push("cq-clickable");return e}emit(){var t=new Event("change",{bubbles:!0,cancelable:!0});this.node.find("*[cq-toolbar-dirty]").addClass("ciq-active"),this.dispatchEvent(t)}getFillColor(t){var i=o(t.node),n=this.context.stx.currentVectorParameters.fillColor;"transparent"!=n&&"auto"!=n||(n=""),i.css({background:n});var s=e.getBackgroundColor(this.parentNode);if(n&&Math.abs(e.hsl(s)[2]-e.hsl(n)[2])<.2){var a=e.chooseForegroundColor(s);i.css({border:"solid "+a+" 1px"})}else i.css({border:""})}getLineColor(t){var i=o(t.node),n=this.context.stx.currentVectorParameters.currentColor;"transparent"!=n&&"auto"!=n||(n=""),i.css({background:n});var s=e.getBackgroundColor(this.parentNode);if(!n||Math.abs(e.hsl(s)[2]-e.hsl(n)[2])<.2){var a=e.chooseForegroundColor(s);i.css({border:"solid "+a+" 1px"}),n||i.css({background:"linear-gradient(to bottom right, "+a+", "+a+" 49%, "+s+" 50%, "+s+")"})}else i.css({border:""})}noTool(){var t=this.context.stx;t.changeVectorType(null),t.layout.crosshair&&(t.layout.crosshair=!1,t.changeOccurred("layout"),t.doDisplayCrosshairs()),t.preferences.magnet&&this.toggleMagnet(this),o(this.params.toolSelection).text(this.noToolSelectedText),o(this.params.toolSelection).attr("cq-current-tool",""),this.node.find("*[cq-section]").removeClass("ciq-active"),this.emit()}pickFillColor(t){var e=t.node,i=o("cq-color-picker");if(i.length){var n=i[0],s=this;n.callback=function(t){s.context.stx.currentVectorParameters.fillColor=t,s.getFillColor({node:e}),s.emit()},n.display({node:e,context:this.context})}else console.log("DrawingToolbar.prototype.pickFillColor: no ColorPicker available")}pickLineColor(t){var e=t.node,i=o("cq-color-picker");if(i.length){var n=i[0],s=this;n.callback=function(t){s.context.stx.currentVectorParameters.currentColor=t,s.getLineColor({node:e}),s.emit()};var a=o(e).attr("cq-overrides");a&&(a=a.split(",")),n.display({node:e,context:this.context,overrides:a})}else console.log("DrawingToolbar.prototype.pickLineColor: no ColorPicker available")}restoreDefaultConfig(t,i){var n=this.context.stx;e.Drawing.restoreDefaultConfig(n,n.currentVectorParameters.vectorType,i),this.node.find("*[cq-toolbar-action='restore']").removeClass("ciq-active"),this.sync()}saveConfig(){var t=this.context.stx;e.Drawing.saveConfig(t,t.currentVectorParameters.vectorType),this.node.find("*[cq-toolbar-action='restore']").addClass("ciq-active"),this.sync()}setFibs(t,e){var i=this.context.stx.currentVectorParameters.fibonacci;if(i){for(var n=0;n<i.fibs.length;n++)i.fibs[n].parameters.lineWidth=t,i.fibs[n].parameters.pattern=e;i.timezone.parameters.lineWidth=t,i.timezone.parameters.pattern=e}}setFontFamily(t,e){var i=this.context.stx;i.currentVectorParameters.annotation.font.family="Default"==e?null:e,o(this.params.fontFamilySelection).text(e),this.emit()}setFontSize(t,e){this.context.stx.currentVectorParameters.annotation.font.size=e,o(this.params.fontSizeSelection).text(e),this.emit()}setContext(t){this.noToolSelectedText=o(this.params.toolSelection).text(),this.sync();var e=this;this.eventListeners.push(t.stx.addEventListener("theme",(function(t){e.sync()})))}setLine(t,e,i){var n=this.context.stx;n.currentVectorParameters.lineWidth=e,n.currentVectorParameters.pattern=i,this.setFibs(e,i),this.currentLineSelectedClass&&o(this.params.lineSelection).removeClass(this.currentLineSelectedClass),this.currentLineSelectedClass="ciq-"+i+"-"+parseInt(e,10),"none"==i?this.currentLineSelectedClass=null:o(this.params.lineSelection).addClass(this.currentLineSelectedClass),this.emit()}sync(t){var i=this.context.stx;t?i.currentVectorParameters=e.extend(i.currentVectorParameters||{},t):t=i.currentVectorParameters,this.setLine(null,t.lineWidth,t.pattern);var n=i.canvasStyle("stx_annotation"),s=t.annotation.font.size||n.fontSize;this.setFontSize(null,s);var a=t.annotation.font.family||n.fontFamily;this.setFontFamily(null,a);var r=t.annotation.font.style||n.fontStyle;o(this.params.fontStyleToggle)["italic"===r?"addClass":"removeClass"]("ciq-active");var c=t.annotation.font.weight||n.fontWeight;o(this.params.fontWeightToggle)["bold"===c||c>=700?"addClass":"removeClass"]("ciq-active"),o(this.params.axisLabelToggle)[t.axisLabel?"addClass":"removeClass"]("ciq-active"),this.getFillColor({node:o(this.params.fillColor)}),this.getLineColor({node:o(this.params.lineColor)}),o(this.params.cvpControllers).each((function(){this.sync(t)})),this.node.find("*[cq-toolbar-dirty]").removeClass("ciq-active")}toggleAxisLabel(t){var e=this.context.stx;!0===e.currentVectorParameters.axisLabel?(e.currentVectorParameters.axisLabel=!1,o(t.node).removeClass("ciq-active")):(e.currentVectorParameters.axisLabel=!0,o(t.node).addClass("ciq-active")),this.emit()}toggleFontStyle(t,e){var i=this.context.stx;"italic"==e?"italic"==i.currentVectorParameters.annotation.font.style?(i.currentVectorParameters.annotation.font.style=null,o(t.node).removeClass("ciq-active")):(i.currentVectorParameters.annotation.font.style="italic",o(t.node).addClass("ciq-active")):"bold"==e&&("bold"==i.currentVectorParameters.annotation.font.weight?(i.currentVectorParameters.annotation.font.weight=null,o(t.node).removeClass("ciq-active")):(i.currentVectorParameters.annotation.font.weight="bold",o(t.node).addClass("ciq-active"))),this.emit()}toggleMagnet(t){var i=o(t.node),n=this.context.stx;n.preferences.magnet?(i.removeClass("active"),n.preferences.magnet=!1):(i.addClass("active"),n.preferences.magnet=!0),e.clearCanvas(n.chart.tempCanvas,n)}tool(t,i){if(i||(i=t.node.getAttribute("cq-tool")),i){var n=this.context.stx;n.clearMeasure(),n.changeVectorType(i),o(this.params.toolSelection).html(o(t.node).html()),o(this.params.toolSelection).attr("cq-current-tool",i),this.node.find("*[cq-section]").removeClass("ciq-active");var s=e.Drawing.getDrawingParameters(n,i);if(s){this.node.find("*[cq-toolbar-action='save']").addClass("ciq-active");var a=n.preferences.drawings;a&&a[i]&&this.node.find("*[cq-toolbar-action='restore']").addClass("ciq-active"),"fibtimezone"===i&&delete s.parameters;var r=o(this.params.lineSelection).parent().find(".ciq-none");r.hide();for(var c=this.defaultElements(s),l=0;l<c.length;l++)o(this.node).find(c[l]).addClass("ciq-active"),"cq-fill-color"==c[l]&&r.show();for(c=e.Drawing[i].prototype.$controls,l=0;c&&l<c.length;l++)o(this.node).find(c[l]).addClass("ciq-active")}this.sync()}}}e.UI.DrawingToolbar=tt,e.UI.addComponentDefinition("cq-toolbar",tt);class et extends e.UI.ContextTag{constructor(){super(),this.redoButton=null,this.undostack=[],this.redostack=[],this.contexts=[]}connectedCallback(){if(!this.attached){super.connectedCallback();var t=this;o(this).stxtap((function(){t.undo()}))}}clear(t){this.setButtonStyle()}handleEvent(t,e,i){this.undostack.push({context:t,drawings:i.before}),this.redostack=[],this.setButtonStyle()}keyStroke(t,e,i,n){return"z"==e&&(n.ctrl||n.cmd)?(n.shift?this.redo():this.undo(),!0):"y"==e&&(n.ctrl||n.cmd)?(this.redo(),!0):void 0}manageContext(t){this.addClaim(this);var e=this;this.eventListeners.push(t.stx.addEventListener("undoStamp",(function(i){e.handleEvent(t,"undoStamp",i)}))),this.contexts.push(t)}redo(){var t=this.redostack.pop();if(t){var e=t.context;this.undostack.push({context:e,drawings:e.stx.exportDrawings()});var i=t.drawings;e.stx.abortDrawings(!0),e.stx.importDrawings(i),e.stx.changeOccurred("vector"),e.stx.draw()}this.setButtonStyle()}setButtonStyle(){this.undostack.length?o(this).attr("cq-active","true"):o(this).removeAttr("cq-active"),this.redoButton&&(this.redostack.length?o(this.redoButton).attr("cq-active","true"):o(this.redoButton).removeAttr("cq-active"))}setContext(t){this.manageContext(this.context);var e=this;this.addInjection("append","initializeChart",(function(){e.undostack=[],e.redostack=[],e.clear()}))}undo(){for(var t=!1,e=0;e<this.contexts.length;e++)this.contexts[e].stx.activeDrawing&&(this.contexts[e].stx.undo(),t=!0);if(!t){var i=this.undostack.pop();if(i){var n=i.context;this.redostack.push({context:n,drawings:n.stx.exportDrawings()});var s=i.drawings;n.stx.abortDrawings(!0),n.stx.importDrawings(s),n.stx.changeOccurred("vector"),n.stx.draw()}this.setButtonStyle()}}}e.UI.Undo=et,e.UI.addComponentDefinition("cq-undo",et);class it extends e.UI.DialogContentTag{constructor(){super()}open(t){this.addDefaultMarkup(),this.querySelector("input").value="",super.open(t)}save(){var t=this.node.find("input").val();if(t){var i=!1,n=this.context.stx.exportLayout();o("cq-views").each((function(){for(var s,a=this.params.viewObj,o=0;o<a.views.length&&(s=a.views[o],t!=e.first(s));o++);o==a.views.length&&((s={})[t]={},a.views.push(s)),s[t]=n,delete s[t].candleWidth,this.renderMenu(),i||(i=!0,this.params.nameValueStore.set("stx-views",a.views))})),this.close()}}}e.UI.ViewDialog=it,it.markup='\n\t\t<h4>Save View</h4>\n\t\t<div stxtap="close()" class="ciq-icon ciq-close"></div>\n\t\t<div style="text-align:center;margin-top:10px;">\n\t\t\t<i>Enter name of view:</i>\n\t\t\t<p>\n\t\t\t\t<input spellcheck="false" autocapitalize="off" autocorrect="off" autocomplete="off" maxlength="40" placeholder="Name"><br>\n\t\t\t</p>\n\t\t\t<span class="ciq-btn" stxtap="save()">Save</span>\n\t\t</div>\n\t',e.UI.addComponentDefinition("cq-view-dialog",it);class nt extends e.UI.ContextTag{constructor(){super()}connectedCallback(){super.connectedCallback(),this.addDefaultMarkup()}initialize(t){this.params=Object.assign({},t),this.params.viewObj||(this.params.viewObj={views:[]}),this.params.nameValueStore||(this.params.nameValueStore=new e.NameValueStore),this.params.template||(this.params.template="template[cq-view]"),this.params.template=this.node.find(this.params.template),this.params.template.detach();var i=this;this.params.nameValueStore.get("stx-views",(function(t,e){!t&&e&&(i.params.viewObj.views=e),i.params.cb&&i.params.cb.call(i),i.renderMenu()}))}setContext({config:t}){t&&t.menuViewConfig&&this.initialize(t.menuViewConfig)}renderMenu(){var t=o(this.node),i=this,n=i.context.stx;function s(t){return function(e){e.stopPropagation();var n=!1;o("cq-views").each((function(){this.params.viewObj.views.splice(t,1),n||(this.params.nameValueStore.set("stx-views",i.params.viewObj.views),n=!0),this.renderMenu()}))}}function a(t){return function(s){s.stopPropagation(),i.uiManager.closeMenu(),i.context.loader&&i.context.loader.show();var a=e.first(i.params.viewObj.views[t]);function o(){var e=function(){n.changeOccurred("layout"),i.context.loader&&i.context.loader.hide()};n.importLayout(i.params.viewObj.views[t][a],{managePeriodicity:!0,preserveTicksAndCandleWidth:!0,cb:e})}setTimeout(o,10)}}t.find("cq-views-content cq-item").remove();for(var r=0;r<this.params.viewObj.views.length;r++){var c=e.first(i.params.viewObj.views[r]);if("recent"!=c){var l=e.UI.makeFromTemplate(this.params.template),h=l.find("cq-label"),d=l.find("div");h.length&&(h.addClass("view-name-"+c),h.text(c)),d.length&&d.stxtap(s(r)),this.makeTap(l[0],a(r)),t.find("cq-views-content").append(l)}}var u=t.find("cq-view-save");if(u){const{context:t}=this,e=this;this.makeTap(u.find("cq-item")[0],(function(i){t.config?e.channelWrite(t.config.channels.dialog,{type:"view",params:{context:t}}):document.querySelector("cq-view-dialog").open({context:t})}))}this.params.renderCB&&this.params.renderCB(t)}}e.UI.Views=nt,nt.markup='\n\t\t<cq-heading>Saved Views</cq-heading>\n\t\t<cq-views-content>\n\t\t\t<template cq-view>\n\t\t\t\t<cq-item>\n\t\t\t\t\t<cq-label></cq-label>\n\t\t\t\t\t<div class="ciq-icon ciq-close"></div>\n\t\t\t\t</cq-item>\n\t\t\t</template>\n\t\t</cq-views-content>\n\t\t<cq-separator cq-partial></cq-separator>\n\t\t<cq-view-save>\n\t\t\t<cq-item><cq-plus></cq-plus>Save View</cq-item>\n\t\t</cq-view-save>\n\t',e.UI.addComponentDefinition("cq-views",nt);class st extends e.UI.ContextTag{static get observedAttributes(){return["corrective","decoration","impulse","show-lines"]}get corrective(){return this.getAttribute("corrective")}set corrective(t){t?this.setAttribute("corrective",t.join(" ")):this.removeAttribute("corrective")}get decoration(){return this.getAttribute("decoration")}set decoration(t){t?this.setAttribute("decoration",t):this.removeAttribute("decoration")}get impulse(){return this.getAttribute("impulse")}set impulse(t){t?this.setAttribute("impulse",t.join(" ")):this.removeAttribute("impulse")}get showLines(){return this.hasAttribute("show-lines")}set showLines(t){t?(this.setAttribute("show-lines",""),this.lineToggleCheckbox.classList.add("ciq-active")):this.removeAttribute("show-lines")}get template(){return this.getAttribute("template")}set template(t){return this.setAttribute("template",t)}static templates(){return{"Grand Supercycle":{impulse:["I","II","III","IV","V"],corrective:["a","b","c"],decoration:"enclosed"},Supercycle:{impulse:["I","II","III","IV","V"],corrective:["a","b","c"],decoration:"parentheses"},Cycle:{impulse:["I","II","III","IV","V"],corrective:["a","b","c"],decoration:null},Primary:{impulse:["1","2","3","4","5"],corrective:["A","B","C"],decoration:"enclosed"},Intermediate:{impulse:["1","2","3","4","5"],corrective:["A","B","C"],decoration:"parentheses"},Minor:{impulse:["1","2","3","4","5"],corrective:["A","B","C"],decoration:null},Minute:{impulse:["i","ii","iii","iv","v"],corrective:["a","b","c"],decoration:"enclosed"},Minuette:{impulse:["i","ii","iii","iv","v"],corrective:["a","b","c"],decoration:"parentheses"},"Sub-Minuette":{impulse:["i","ii","iii","iv","v"],corrective:["a","b","c"],decoration:null}}}attributeChangedCallback(t,e,i){if(!this.stx)return;let n,s=this.stx.currentVectorParameters,a=s.waveParameters||{};switch(t){case"template":let t=this.templates[i];t&&(n={decoration:t.decoration});break;case"impulse":n={impulse:i?i.split(" "):i};break;case"corrective":n={corrective:i?i.split(" "):i};break;case"decoration":n={decoration:i};break;case"show-lines":n={showLines:this.showLines}}s.waveParameters=Object.assign(a,n)}constructor(){super(),this.templates=st.templates()}connectedCallback(){if(!this.attached){this.template="Grand Supercycle";var t=document.querySelector('template[cq-wave-parameters], template[cq-wave-parameters="true"]');e.UI.makeFromTemplate(t,this),this.templateHeader=this.querySelector(".ciq-active-template"),this.impulseHeader=this.querySelector(".ciq-active-impulse"),this.correctiveHeader=this.querySelector(".ciq-active-corrective"),this.decorators={blank:this.querySelector(".ciq-btn:nth-of-type(1n)"),parentheses:this.querySelector(".ciq-btn:nth-of-type(2n)"),enclosed:this.querySelector(".ciq-btn:nth-of-type(3n)")},this.lineToggleCheckbox=this.querySelector("span.ciq-checkbox"),super.connectedCallback()}}disconnectedCallback(){super.disconnectedCallback()}activate(){this.stx&&(this.cvp=this.stx.currentVectorParameters,this.update(null,"template",this.template),this.showLines=!0)}setContext(){this.stx=this.context.stx}toggleLines(){let t=this.lineToggleCheckbox,e=t.classList.contains("ciq-active");this.showLines=!e,e?t.classList.remove("ciq-active"):t.classList.add("ciq-active")}update(t,e,i){if("template"===e){this.template=i,this.templateHeader.innerHTML=i;let t=this.templates[this.template];if(t){this.impulse=t.impulse,this.impulseHeader.innerHTML=t.impulse.join(" "),this.corrective=t.corrective,this.correctiveHeader.innerHTML=t.corrective.join(" ");for(let t in this.decorators)this.decorators[t].classList.remove("ciq-active");let e=t.decoration||"blank";this.decorators[e].classList.add("ciq-active"),this.decoration=e}else this.cvp.waveParameters={corrective:this.corrective.split(" "),impulse:this.impulse.split(" "),decoration:this.decoration}}else{if("decoration"===e){for(let t in this.decorators)this.decorators[t].classList.remove("ciq-active");t.node.classList.add("ciq-active"),this.decoration=t.node.getAttribute("decoration")}else if("showLines"===e);else{let t=i?i.split(","):i;this[e]=t,this[e+"Header"].innerHTML=t?t.join(" "):"- - -"}this.templateHeader.innerHTML=this.template="Custom"}}}e.UI.WaveParameters=st,e.UI.addComponentDefinition("cq-wave-parameters",st);class at extends e.UI.Dialog{constructor(){super(),this.params={colorMap:[["#ffffff","#e1e1e1","#cccccc","#b7b7b7","#a0a0a5","#898989","#707070","#626262","#555555","#464646","#363636","#262626","#1d1d1d","#000000"],["#f4977c","#f7ac84","#fbc58d","#fff69e","#c4de9e","#85c99e","#7fcdc7","#75d0f4","#81a8d7","#8594c8","#8983bc","#a187bd","#bb8dbe","#f29bc1"],["#ef6c53","#f38d5b","#f8ae63","#fff371","#acd277","#43b77a","#2ebbb3","#00bff0","#4a8dc8","#5875b7","#625da6","#8561a7","#a665a7","#ee6fa9"],["#ea1d2c","#ee652e","#f4932f","#fff126","#8ec648","#00a553","#00a99c","#00afed","#0073ba","#0056a4","#323390","#66308f","#912a8e","#e9088c"],["#9b0b16","#9e4117","#a16118","#c6b920","#5a852d","#007238","#00746a","#0077a1","#004c7f","#003570","#1d1762","#441261","#62095f","#9c005d"],["#770001","#792e03","#7b4906","#817a0b","#41661e","#005827","#005951","#003b5c","#001d40","#000e35","#04002c","#19002b","#2c002a","#580028"]]}}connectedCallback(){this.attached||(super.connectedCallback(),this.build())}build(){this.addDefaultMarkup();var t=o(this),e=t.attr("cq-colors");if(e){e=e.split(",");var i=Math.ceil(Math.sqrt(e.length));this.params.colorMap=[];for(var n=0,s=[],a=0;a<e.length;a++)n>=i&&(n=0,this.params.colorMap.push(s),s=[]),s.push(e[a]),n++;this.params.colorMap.push(s)}this.cqOverrides=t.find("cq-overrides"),this.template=this.cqOverrides.find("template"),this.initialize()}display(t){var i=o(t.node),n=i[0].getBoundingClientRect();this.picker.css({top:"0px",left:"0px"});var s=this.parentNode.getBoundingClientRect(),a=n.left-s.left+i.width()+10,r=n.top-s.top+5,c=o(document).width(),l=this.picker.width();a+l>c&&(a=c-l-20);var h=o(document).height(),d=this.picker.height();r+d>h&&(r=h-d-20),this.picker.css({left:a+"px",top:r+"px"}),this.cqOverrides.emptyExceptTemplate();var u=t.context||this.context||e.UI.getMyContext(this);if(t.overrides&&this.template.length)for(var p=0;p<t.overrides.length;p++){var m=t.overrides[p],g=e.UI.makeFromTemplate(this.template,!0);u.stx&&(m=u.stx.translateIf(m)),g.text(m),g.stxtap(function(t,e){return function(){t.pickColor(e)}}(this,m))}this.picker.hasClass("stxMenuActive")?u.e&&u.e.stopPropagation():this.picker[0].open({context:u})}initialize(){var t=this;function e(t,e){return function(){t.pickColor(e)}}this.picker=o(this),this.colors=this.picker.find("cq-colors"),this.colors.length||(this.colors=this.picker),this.colors.empty();for(var i=0;i<this.params.colorMap.length;i++)for(var n=this.params.colorMap[i],s=o("<UL></UL>").appendTo(this.colors),a=0;a<n.length;a++){var r=o("<LI></LI>").appendTo(s),c=o("<SPAN></SPAN>").appendTo(r);c.css({"background-color":n[a]}),c.stxtap(e(t,n[a]))}}pickColor(t){this.callback&&this.callback(t),this.close()}resize(){}setColors(t){this.params.colorMap=t,this.initialize()}}at.markup='\n\t\t<cq-colors></cq-colors>\n\t\t<cq-overrides>\n\t\t\t<template>\n\t\t\t\t<div class="ciq-btn"></div>\n\t\t\t</template>\n\t\t</cq-overrides>\n\t',e.UI.ColorPicker=at,e.UI.addComponentDefinition("cq-color-picker",at);class ot extends e.UI.Palette{constructor(){super(),this.mode="",this.callbacks=[],this.toolSettings={favList:[],toolGroup:""},this.toolShortcuts={},this.loadToolSettings()}setupKeyboardActivation(t){if(void 0!==this.getAttribute("cq-keystroke-claim")){let t=this.context.topNode.querySelectorAll("*[cq-tool][cq-tool-shortcut]");for(let e=0;e<t.length;e++){let i=t[e].getAttribute("cq-tool-shortcut");if(/^[A-Za-z]{1}$/g.test(i)){this.toolShortcuts[i.toUpperCase()]={toolName:t[e].getAttribute("cq-tool"),node:t[e]};let n=t[e].querySelector("label"),s=document.createElement("span");s.classList.add("shortcut"),s.innerHTML=" (Alt+"+i.toUpperCase()+")",n.appendChild(s)}else console.warn("cq-tool-shortcut attribute must be a single letter: "+i+" ignored.")}this.addClaim(this)}}keyStroke(t,e,i,n){if(i.altKey){let t=String.fromCharCode(i.which).toUpperCase(),e=this.toolShortcuts[t];e&&(this.channels&&this.channelWrite(this.channels.drawing,!0),this.tool({node:e.node},e.toolName))}else if("Escape"===i.key){let t=this.context.topNode.querySelector('*[cq-tool="notool"]');t&&this.noTool({node:t})}}handleMessage(t,e){switch(t){case"changeToolSettings":this.activateTool(e.activator,e.toolName);break;case"toggleDrawingPalette":this.togglePalette();break;case"hideDrawingPalette":case"dockWillResize":this.hidePalette();break;case"dockDidResize":this.resetScroller();break;case"context":"stop"===e&&(this.toolContextMenu.style.display="none")}}loadToolSettings(){if(window.localStorage){const t=JSON.parse(window.localStorage.getItem("CIQ.DrawingToolSettings"));t&&t.favList&&(this.toolSettings=Object.assign(this.toolSettings,t))}}storeToolSettings(){window.localStorage&&window.localStorage.setItem("CIQ.DrawingToolSettings",JSON.stringify(this.toolSettings))}setContext(t){const{config:e,stx:i}=t;e&&(this.addDefaultMarkup(this,this.getMarkup(e)),this.channels={drawing:e.channels.drawing}),this.init(),this.params={toolGroupSelection:this.querySelector("*[cq-tool-group-selection]")},this.setFavorites(),this.setMode("grid"),this.setEvenOdd(),this.toolContextMenu=this.createContextMenu(),this.addEventListener("contextmenu",function(t){if(t.preventDefault(),null!==t.target.getAttribute("cq-tool-group")){let e=t.target.getBoundingClientRect(),i=this.getBoundingClientRect();this.showToolContextMenu(t.target.getAttribute("cq-tool"),e.top+e.height-i.top,e.left-i.left)}}.bind(this)),this.setupKeyboardActivation(),this.pairUndoRedo(),this.toolSettings.toolGroup&&this.setToolGroup({node:this.querySelector('cq-item[cq-tool-group="'+this.toolSettings.toolGroup+'"]')},this.toolSettings.toolGroup),this.channels&&this.channelSubscribe(this.channels.drawing,(t=>{t?(this.resetScroller(),this.priorVectorType&&!i.currentVectorParameters.vectorType&&i.changeVectorType(this.priorVectorType)):(this.priorVectorType=i.currentVectorParameters.vectorType,i.changeVectorType(""))}))}pairUndoRedo(){const t=this.qs("cq-redo",this),e=this.qs("cq-undo",this);t.pairUp(e)}changeView(t,e){this.setMode(e);for(var i=0;i<this.callbacks.length;i++)this.callbacks[i].call(this,this.mode)}createContextMenu(){let t=document.createElement("div");t.className="menu-item",t.innerHTML="Add/Remove Favorite",t.addEventListener("mousedown",function(t){t.stopPropagation(),1===t.which&&(this.toggleFavorite(t.currentTarget.parentElement.getAttribute("context-tool")),this.paletteDock.stopContext(this))}.bind(this));let e=document.createElement("div");return e.appendChild(t),e.className="tool-context-menu",this.node.append(e),e}registerCallback(t){this.callbacks.push(t)}resetScroller(){const t=this.querySelector(".tool-group cq-scroll");if(!t)return!1;this.setEvenOdd(),t.refresh()}setActiveButton(t){o(this).find(".ciq-tool.active").removeClass("active"),o(t).find("label").html(),t.getAttribute("stxtap"),t.classList.add("active"),o(".ciq-mobile-palette-toggle").is(":visible")||this.togglePalette()}setMode(t){t="list"===t?t:"grid",this.mode=t,this.classList.remove("list"),this.classList.remove("grid"),this.classList.add(this.mode),this.resetScroller(),this.paletteDock.handleResize({resizeChart:!0})}setEvenOdd(t){o(this.node).find(".tool-group cq-scroll cq-item").filter(":visible").each((function(t){t%2?this.classList.add("odd"):this.classList.remove("odd")}))}setFavorites(){for(var t=this.querySelectorAll(".tool-group [cq-tool]"),e=0;e<t.length;e++){var i=t[e];if(null===i.querySelector(".fav-marker")){let t=document.createElement("div");t.className="fav-marker",t.addEventListener("click",this.handleFavoriteClick.bind(this)),t.addEventListener("touchstart",this.handleFavoriteClick.bind(this),!0),i.appendChild(t)}i.getAttribute("cq-tool-group").indexOf("favorite")>=0&&i.setAttribute("cq-tool-group",i.getAttribute("cq-tool-group").replace("favorite","")),this.toolSettings.favList.indexOf(i.getAttribute("cq-tool"))>=0&&i.setAttribute("cq-tool-group",i.getAttribute("cq-tool-group")+" favorite")}}handleFavoriteClick(t){t.stopPropagation(),t.preventDefault(),this.toggleFavorite(t.target.parentElement.getAttribute("cq-tool")),this.hidePalette()}addFavorite(t){this.toolSettings.favList.indexOf(t)<0&&(this.toolSettings.favList.push(t),this.storeToolSettings(),this.setFavorites())}showToolContextMenu(t,e,i){this.toolContextMenu.style.display="block",this.toolContextMenu.style.top=e+"px",this.toolContextMenu.style.left=i+"px",this.toolContextMenu.setAttribute("context-tool",t),this.paletteDock.startContext(this)}toggleFavorite(t){let e=this.toolSettings.favList.indexOf(t);e>=0?this.toolSettings.favList.splice(e,1):this.toolSettings.favList.push(t),this.storeToolSettings(),this.setFavorites()}setToolGroup(t,e){this.toolSettings.toolGroup=e,this.querySelector(".tool-group").setAttribute("tool-group-filter",this.toolSettings.toolGroup),this.querySelector(".tool-group cq-scroll").top(),this.setEvenOdd(e);for(var i=0;i<this.callbacks.length;i++)this.callbacks[i].call(this,this.mode);this.showPalette(),o(this.params.toolGroupSelection).html(t.node.innerHTML),this.storeToolSettings()}togglePalette(){this.classList.toggle("palette-hide")}hidePalette(){this.classList.add("palette-hide")}showPalette(){this.classList.remove("palette-hide")}activateTool(t,e){let i=null;i=!t.node&&e?this.querySelector("[cq-tool="+e+"]"):t.node,this.setActiveButton(i);var n=this.context.stx;n.clearMeasure(),n.changeVectorType(e)}noTool(t,e){this.tool(t,"notool")}tool(t,e){if(e||(e=t.node.getAttribute("cq-tool")),e){var i=t.node.querySelector("label").innerHTML;this.activateTool(t,e),this.sendMessage&&this.sendMessage("changeTool",{activator:t,toolName:e,toolLabel:i})}}clearDrawings(){this.sendMessage&&this.sendMessage("clearDrawings")}restoreDefaultConfig(t,e){this.sendMessage&&this.sendMessage("restoreDefaultConfig",{activator:t,all:e})}getMarkup(t){const e=t.getMenu("drawingTools",!0).join(""),i=t.drawingToolGrouping.map((t=>`<cq-item \n\t\t\t\t\tstxtap="setToolGroup('${t.toLowerCase()}')" \n\t\t\t\t\tcq-tool-group="${t.toLowerCase()}">${t}\n\t\t\t\t</cq-item>`)).join("");return this.constructor.markup.replace("{{tools}}",e).replace("{{toolGrouping}}",i)}}ot.markup='\n\t<div class="palette-container">\n\t\t<div class="drag-strip"></div>\n\t\t\t<div class="mini-widget-group">\n\t\t\t\t\t<cq-item class="ciq-mini-widget" cq-view="list" stxtap="changeView(\'list\')"><span class="icon"></span><label>List View</label></cq-item>\n\t\t\t\t\t<cq-item class="ciq-mini-widget" cq-view="grid" stxtap="changeView(\'grid\')"><span class="icon"></span><label>Grid View</label></cq-item>\n\t\t\t\t\t<cq-item class="ciq-mini-widget" cq-view="detach" stxtap="detach()"><span class="icon"></span><label>Detach</label></cq-item>\n\t\t\t\t\t<cq-item class="ciq-mini-widget" cq-view="attach" stxtap="dock()"><span class="icon"></span><label>Attach</label></cq-item>\n\t\t\t</div>\n\t\t\t<cq-separator></cq-separator>\n\t\t\t<div class="primary-tool-group">\n\t\t\t\t<cq-item class="ciq-tool active" cq-tool="notool" stxtap="tool()"><span class="icon pointer"></span><label>No Tool</label></cq-item>\n\t\t\t\t<cq-item class="ciq-tool" cq-tool="measure" stxtap="tool()"><span class="icon measure"></span><label>Measure</label></cq-item>\n\t\t\t\t<cq-undo class="ciq-tool"><span class="icon undo"></span><label>Undo</label></cq-undo>\n\t\t\t\t<cq-redo class="ciq-tool"><span class="icon redo"></span><label>Redo</label></cq-redo>\n\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t<span cq-tool-group-selection>All</span>\n\t\t\t\t\t<cq-menu-dropdown class="ciq-tool-group-selection">\n\t\t\t\t\t\t{{toolGrouping}}\n\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t</cq-menu>\n\t\t\t</div>\n\t\t\t<cq-separator></cq-separator>\n\t\t\t<div class="tool-group" tool-group-filter="all">\n\t\t\t\t<cq-scroll cq-no-resize>\n\t\t\t\t\t{{tools}}\n\t\t\t\t</cq-scroll>\n\t\t\t\t<cq-separator></cq-separator>\n\t\t\t\t<div class="mini-widget-group mini-widget-foot">\n\t\t\t\t\t<cq-toggle class="ciq-mini-widget ciq-magnet" cq-member="preferences.magnet" cq-toggles="true,75,false" cq-toggle-classes="active strong,active,"><span class="icon magnet"></span><label>Magnet</label></cq-toggle>\n\t\t\t\t\t<cq-item class="ciq-mini-widget" stxtap="clearDrawings()"><span class="icon clear"></span><label>Clear Drawings</label></cq-item>\n\t\t\t\t\t<cq-item class="ciq-mini-widget" stxtap="restoreDefaultConfig(true)"><span class="icon restore"></span><label>Restore Default Parameters</label></cq-item>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t<div class="resize-strip"></div>\n\t</div>\n\t',e.UI.DrawingPalette=ot,e.UI.addComponentDefinition("cq-drawing-palette",ot);class rt extends e.UI.Palette{constructor(){super()}setContext(t){this.addDefaultMarkup(),this.init(),this.node=o(this),this.params={lineSelection:this.node.find("*[cq-line-style]"),fontSizeSelection:this.node.find("*[cq-font-size]"),fontFamilySelection:this.node.find("*[cq-font-family]"),fontStyleToggle:this.node.find("cq-annotation-italic"),fontWeightToggle:this.node.find("cq-annotation-bold"),axisLabelToggle:this.node.find("cq-axis-label .ciq-checkbox"),fillColor:this.node.find("cq-fill-color").not("cq-cvp-controller"),lineColor:this.node.find("cq-line-color").not("cq-cvp-controller"),cvpControllers:this.node.find("cq-cvp-controller"),waveParameters:this.node.find("cq-wave-parameters")},this.params.cvpControllers.prop("toolbar",this),this.noToolSelectedText="",this.noToolSelectedText=o(this.params.toolSelection).text(),this.sync(),t.stx.setDrawingContainer(this);var e=this;t.stx.addEventListener("theme",(function(t){e.sync()}))}handleMessage(t,e){switch(t){case"changeTool":this.setActiveToolLabel(e.toolLabel),this.toolSettings(e.activator,e.toolName);break;case"clearDrawings":this.clearDrawings();break;case"restoreDefaultConfig":this.restoreDefaultConfig(e.activator,e.all)}}clearDrawings(){this.context.stx.clearDrawings(null,!1)}crosshairs(t){var e=this.context.stx;o(this.params.toolSelection).html(o(t.node).html()),e.changeVectorType(null),e.layout.crosshair=!0,e.doDisplayCrosshairs(),e.findHighlights(!1,!0),e.changeOccurred("layout"),e.draw(),e.updateChartAccessories(),this.node.find("*[cq-section]").removeClass("ciq-active"),this.emit()}tool(t,e){this.toolSettings(t,e),this.setActiveToolLabel(e),this.sendMessage("changeToolSettings",{activator:t,toolName:e})}toolSettings(t,i){var n=this.context.stx;this.node.find("*[cq-section]").removeClass("ciq-active");var s=e.Drawing.getDrawingParameters(n,i);if(s){this.node.find("*[cq-toolbar-action='save']").addClass("ciq-active");var a=n.preferences.drawings;a&&a[i]&&this.node.find("*[cq-toolbar-action='restore']").addClass("ciq-active"),"fibtimezone"===i&&delete s.parameters;var r=o(this.params.lineSelection).parent().find(".ciq-none");r.hide();for(var c=this.defaultElements(s),l=0;l<c.length;l++)o(this.node).find(c[l]).addClass("ciq-active"),"cq-fill-color"==c[l]&&r.show();for(c=e.Drawing[i].prototype.$controls,l=0;c&&l<c.length;l++)o(this.node).find(c[l]).addClass("ciq-active")}n.layout.crosshair&&(n.layout.crosshair=!1,n.changeOccurred("layout"),n.doDisplayCrosshairs()),"notool"===i?(n.changeVectorType(null),n.preferences.magnet&&this.toggleMagnet(this),this.hide="true"):this.hide="false",this.paletteDock.handleResize(),this.sync()}defaultElements(t){var e=[];for(var i in t)"color"==i?e.push("cq-line-color"):"fillColor"==i?e.push("cq-fill-color"):"pattern"==i||"lineWidth"==i?e.push("cq-line-style"):"axisLabel"==i?e.push("cq-axis-label"):"font"==i?e.push("cq-annotation"):"parameters"==i&&e.push("cq-clickable");return e}emit(){var t=new Event("change",{bubbles:!0,cancelable:!0});this.node.find("*[cq-toolbar-dirty]").addClass("ciq-active"),this.dispatchEvent(t)}getFillColor(t){var i=o(t.node),n=this.context.stx.currentVectorParameters.fillColor;"transparent"!=n&&"auto"!=n||(n=""),i.css({background:n});var s=e.getBackgroundColor(this.parentNode);if(n&&Math.abs(e.hsl(s)[2]-e.hsl(n)[2])<.2){var a=e.chooseForegroundColor(s);i.css({border:"solid "+a+" 1px"})}else i.css({border:""})}getLineColor(t){var i=o(t.node),n=this.context.stx.currentVectorParameters.currentColor;"transparent"!=n&&"auto"!=n||(n=""),i.css({background:n});var s=e.getBackgroundColor(this.parentNode);if(!n||Math.abs(e.hsl(s)[2]-e.hsl(n)[2])<.2){var a=e.chooseForegroundColor(s);i.css({border:"solid "+a+" 1px"}),n||i.css({background:"linear-gradient(to bottom right, "+a+", "+a+" 49%, "+s+" 50%, "+s+")"})}else i.css({border:""})}pickFillColor(t){var e=t.node,i=o("cq-color-picker");if(i.length){var n=i[0],s=this;n.callback=function(t){s.context.stx.currentVectorParameters.fillColor=t,s.getFillColor({node:e}),s.emit()},n.display({node:e,context:s.context})}else console.log("DrawingToolbar.prototype.pickFillColor: no ColorPicker available")}pickLineColor(t){var e=t.node,i=o("cq-color-picker");if(i.length){var n=i[0],s=this;n.callback=function(t){s.context.stx.currentVectorParameters.currentColor=t,s.getLineColor({node:e}),s.emit()};var a=o(e).attr("cq-overrides");a&&(a=a.split(",")),n.display({node:e,overrides:a,context:s.context})}else console.log("DrawingToolbar.prototype.pickLineColor: no ColorPicker available")}restoreDefaultConfig(t,i){var n=this.context.stx;e.Drawing.restoreDefaultConfig(n,n.currentVectorParameters.vectorType,i),this.node.find("*[cq-toolbar-action='restore']").removeClass("ciq-active"),this.sync()}saveConfig(){var t=this.context.stx;e.Drawing.saveConfig(t,t.currentVectorParameters.vectorType),this.node.find("*[cq-toolbar-action='restore']").addClass("ciq-active"),this.sync()}setFibs(t,e){var i=this.context.stx.currentVectorParameters.fibonacci;if(i){for(var n=0;n<i.fibs.length;n++)i.fibs[n].parameters.lineWidth=t,i.fibs[n].parameters.pattern=e;i.timezone.parameters.lineWidth=t,i.timezone.parameters.pattern=e}}setFontFamily(t,e){var i=this.context.stx;i.currentVectorParameters.annotation.font.family="Default"==e?null:e,o(this.params.fontFamilySelection).text(e),this.emit()}setFontSize(t,e){this.context.stx.currentVectorParameters.annotation.font.size=e,o(this.params.fontSizeSelection).text(e),this.emit()}setLine(t,e,i){var n=this.context.stx;n.currentVectorParameters.lineWidth=e,n.currentVectorParameters.pattern=i,this.setFibs(e,i),this.currentLineSelectedClass&&o(this.params.lineSelection).removeClass(this.currentLineSelectedClass),this.currentLineSelectedClass="ciq-"+i+"-"+parseInt(e,10),"none"==i?this.currentLineSelectedClass=null:o(this.params.lineSelection).addClass(this.currentLineSelectedClass),this.emit()}setActiveToolLabel(t){"No Tool"===t?t="":"freeform"===t?t="Doodle":t+=":",this.querySelector(".ciq-active-tool-label").innerHTML=t,this.querySelector(".ciq-mobile-palette-toggle span").innerHTML=t||"Select Tool"}sync(t){var i=this.context.stx;t?i.currentVectorParameters=e.extend(i.currentVectorParameters||{},t):t=i.currentVectorParameters;var n=this.params;this.setLine(null,t.lineWidth,t.pattern);var s=i.canvasStyle("stx_annotation"),a=t.annotation.font.size||s.fontSize;this.setFontSize(null,a);var r=t.annotation.font.family||s.fontFamily;this.setFontFamily(null,r);var c=t.annotation.font.style||s.fontStyle;o(n.fontStyleToggle)["italic"===c?"addClass":"removeClass"]("ciq-active");var l=t.annotation.font.weight||s.fontWeight;o(n.fontWeightToggle)["bold"===l||l>=700?"addClass":"removeClass"]("ciq-active"),o(n.axisLabelToggle)[t.axisLabel?"addClass":"removeClass"]("ciq-active"),this.getFillColor({node:o(n.fillColor)}),this.getLineColor({node:o(n.lineColor)}),o(n.cvpControllers).each((function(){this.sync(t)}));var h=n.waveParameters;h&&h[0]&&h[0].activate(),this.node.find("*[cq-toolbar-dirty]").removeClass("ciq-active")}toggleAxisLabel(t){var e=this.context.stx;!0===e.currentVectorParameters.axisLabel?(e.currentVectorParameters.axisLabel=!1,o(t.node).removeClass("ciq-active")):(e.currentVectorParameters.axisLabel=!0,o(t.node).addClass("ciq-active")),this.emit()}toggleFontStyle(t,e){var i=this.context.stx;"italic"==e?"italic"==i.currentVectorParameters.annotation.font.style?(i.currentVectorParameters.annotation.font.style=null,o(t.node).removeClass("ciq-active")):(i.currentVectorParameters.annotation.font.style="italic",o(t.node).addClass("ciq-active")):"bold"==e&&("bold"==i.currentVectorParameters.annotation.font.weight?(i.currentVectorParameters.annotation.font.weight=null,o(t.node).removeClass("ciq-active")):(i.currentVectorParameters.annotation.font.weight="bold",o(t.node).addClass("ciq-active"))),this.emit()}toggleMagnet(t){var i=o(t.node),n=this.context.stx;n.preferences.magnet?(i.removeClass("active"),n.preferences.magnet=!1):(i.addClass("active"),n.preferences.magnet=!0),e.clearCanvas(n.chart.tempCanvas,n)}togglePalette(){this.sendMessage("toggleDrawingPalette")}}rt.markup='\n\t<div class="palette-container">\n\t\t<div class="drag-strip"></div>\n\t\t\t<div class="drawing-settings-wrapper">\n\t\t\t\t\t<div class="mini-widget-group">\n\t\t\t\t\t\t<cq-item class="ciq-mini-widget" cq-view="detach" stxtap="detach()"><span class="icon"></span><label>Detach</label></cq-item>\n\t\t\t\t\t\t<cq-item class="ciq-mini-widget" cq-view="attach" stxtap="dock()"><span class="icon"></span><label>Attach</label></cq-item>\n\t\t\t\t\t</div>\n\t\t\t\t<cq-clickable class="ciq-select ciq-mobile-palette-toggle" stxtap="togglePalette()"><span>Select Tool</span></cq-clickable>\n\t\t\t\t<cq-toolbar-settings>\n\t\t\t\t\t<div class="ciq-active-tool-label ciq-heading"></div>\n\t\t\t\t\t<cq-fill-color cq-section class="ciq-color" stxbind="getFillColor()" stxtap="pickFillColor()">\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t</cq-fill-color>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<cq-line-color cq-section cq-overrides="auto" class="ciq-color" stxbind="getLineColor()" stxtap="pickLineColor()"><span></span></cq-line-color>\n\t\t\t\t\t\t<cq-line-style cq-section>\n\t\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t\t<span cq-line-style class="ciq-line ciq-selected"></span>\n\t\t\t\t\t\t\t\t<cq-menu-dropdown class="ciq-line-style-menu">\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(1,\'solid\')"><span class="ciq-line-style-option ciq-solid-1"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(3,\'solid\')"><span class="ciq-line-style-option ciq-solid-3"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(5,\'solid\')"><span class="ciq-line-style-option ciq-solid-5"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(1,\'dotted\')"><span class="ciq-line-style-option ciq-dotted-1"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(3,\'dotted\')"><span class="ciq-line-style-option ciq-dotted-3"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(5,\'dotted\')"><span class="ciq-line-style-option ciq-dotted-5"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(1,\'dashed\')"><span class="ciq-line-style-option ciq-dashed-1"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(3,\'dashed\')"><span class="ciq-line-style-option ciq-dashed-3"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(5,\'dashed\')"><span class="ciq-line-style-option ciq-dashed-5"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setLine(0,\'none\')" class="ciq-none">None</cq-item>\n\t\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t</cq-line-style>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<cq-cvp-controller cq-section cq-cvp-header="1"></cq-cvp-controller>\n\t\t\t\t\t<cq-cvp-controller cq-section cq-cvp-header="2"></cq-cvp-controller>\n\t\t\t\t\t<cq-cvp-controller cq-section cq-cvp-header="3"></cq-cvp-controller>\n\n\t\t\t\t\t<template cq-cvp-controller>\n\t\t\t\t\t\t<div cq-section>\n\t\t\t\t\t\t\t<div class="ciq-heading">Dev 1</div>\n\t\t\t\t\t\t\t<span stxtap="toggleActive()" class="ciq-checkbox">\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<cq-line-color cq-section cq-overrides="auto" class="ciq-color" stxbind="getColor()" stxtap="pickColor()">\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</cq-line-color>\n\t\t\t\t\t\t<cq-line-style cq-section>\n\t\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t\t<span cq-cvp-line-style class="ciq-line ciq-selected"></span>\n\t\t\t\t\t\t\t\t<cq-menu-dropdown class="ciq-line-style-menu">\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(1, \'solid\')"><span class="ciq-line-style-option ciq-solid-1"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(3, \'solid\')"><span class="ciq-line-style-option ciq-solid-3"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(5, \'solid\')"><span class="ciq-line-style-option ciq-solid-5"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(1, \'dotted\')"><span class="ciq-line-style-option ciq-dotted-1"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(3, \'dotted\')"><span class="ciq-line-style-option ciq-dotted-3"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(5, \'dotted\')"><span class="ciq-line-style-option ciq-dotted-5"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(1, \'dashed\')"><span class="ciq-line-style-option ciq-dashed-1"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(3, \'dashed\')"><span class="ciq-line-style-option ciq-dashed-3"></span></cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="setStyle(5, \'dashed\')"><span class="ciq-line-style-option ciq-dashed-5"></span></cq-item>\n\t\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t</cq-line-style>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<cq-axis-label cq-section>\n\t\t\t\t\t\t<div class="ciq-heading">Axis Label:</div>\n\t\t\t\t\t\t<span stxtap="toggleAxisLabel()" class="ciq-checkbox ciq-active"><span></span></span>\n\t\t\t\t\t</cq-axis-label>\n\t\t\t\t\t<cq-annotation cq-section>\n\t\t\t\t\t\t<cq-annotation-italic stxtap="toggleFontStyle(\'italic\')" class="ciq-btn" style="font-style:italic;">I</cq-annotation-italic>\n\t\t\t\t\t\t<cq-annotation-bold stxtap="toggleFontStyle(\'bold\')" class="ciq-btn" style="font-weight:bold;">B</cq-annotation-bold>\n\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t<span cq-font-size>12px</span>\n\t\t\t\t\t\t\t<cq-menu-dropdown class="ciq-font-size">\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'8px\')">8</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'10px\')">10</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'12px\')">12</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'13px\')">13</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'14px\')">14</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'16px\')">16</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'20px\')">20</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'28px\')">28</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'36px\')">36</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'48px\')">48</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontSize(\'64px\')">64</cq-item>\n\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t<span cq-font-family>Default</span>\n\t\t\t\t\t\t\t<cq-menu-dropdown class="ciq-font-family">\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontFamily(\'Default\')">Default</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontFamily(\'Helvetica\')">Helvetica</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontFamily(\'Courier\')">Courier</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontFamily(\'Garamond\')">Garamond</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontFamily(\'Palatino\')">Palatino</cq-item>\n\t\t\t\t\t\t\t\t<cq-item stxtap="setFontFamily(\'Times New Roman\')">Times New Roman</cq-item>\n\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t</cq-annotation>\n\t\t\t\t\t<cq-clickable cq-fib-settings cq-selector="cq-fib-settings-dialog" cq-method="open" cq-section><span class="ciq-icon-btn cq-icon-gear"><cq-tooltip>Settings</cq-tooltip></span></cq-clickable>\n\t\t\t\t\t<div class="ciq-drawing-edit-only" cq-section>\n\t\t\t\t\t\t<div cq-toolbar-action="done_edit" stxtap="DrawingEdit.endEdit(\'close\')" cq-section><cq-tooltip>Done Editing</cq-tooltip></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<br cq-section cq-wave-parameters>\x3c!-- This break is not displayed by default but uses  the .ciq-active class to be displayed and push cq-wave-parameters onto a new line in the toolbar --\x3e\n\t\t\t\t\t<cq-wave-parameters cq-section></cq-wave-parameters>\n\t\t\t\t\t<template cq-wave-parameters>\n\t\t\t\t\t\t<div class="ciq-wave-template" cq-section>\n\t\t\t\t\t\t\t<div class="ciq-heading">WAVE TEMPLATE</div>\n\t\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t\t<span class="ciq-active-template">WAVE TEMPLATE</span>\n\t\t\t\t\t\t\t\t<cq-menu-dropdown>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Grand Supercycle\')">Grand Supercycle</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Supercycle\')">Supercycle</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Cycle\')">Cycle</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Primary\')">Primary</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Intermediate\')">Intermediate</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Minor\')">Minor</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Minute\')">Minute</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Minuette\')">Minuette</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Sub-Minuette\')">Sub-Minuette</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'template\',\'Custom\')">Custom</cq-item>\n\t\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ciq-wave-impulse" cq-section>\n\t\t\t\t\t\t\t<div class="ciq-heading">IMPULSE</div>\n\t\t\t\t\t\t\t<cq-menu  class="ciq-select">\n\t\t\t\t\t\t\t\t<span class="ciq-active-impulse">IMPULSE</span>\n\t\t\t\t\t\t\t\t<cq-menu-dropdown>\n\t\t\t\t\t\t\t\t\t<cq-item stxTap="update(\'impulse\',null)">- - -</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'I,II,III,IV,V\')">I II III IV V</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'i,ii,iii,iv,v\')">i ii iii iv v</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'1,2,3,4,5\')">1 2 3 4 5</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'A,B,C,D,E\')">A B C D E</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'a,b,c,d,e\')">a b c d e</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'W,X,Y,X,Z\')">W X Y X Z</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'impulse\',\'w,x,y,x,z\')">w x y x z</cq-item>\n\t\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ciq-wave-corrective" cq-section>\n\t\t\t\t\t\t\t<div class="ciq-heading">CORRECTIVE</div>\n\t\t\t\t\t\t\t<cq-menu class="ciq-select">\n\t\t\t\t\t\t\t\t<span class="ciq-active-corrective">CORRECTIVE</span>\n\t\t\t\t\t\t\t\t<cq-menu-dropdown>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'corrective\',null)">- - -</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'corrective\',\'A,B,C\')">A B C</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'corrective\',\'a,b,c\')">a b c</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'corrective\',\'W,X,Y\')">W X Y</cq-item>\n\t\t\t\t\t\t\t\t\t<cq-item stxtap="update(\'corrective\',\'w,x,y\')">w x y</cq-item>\n\t\t\t\t\t\t\t\t</cq-menu-dropdown>\n\t\t\t\t\t\t\t</cq-menu>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class="ciq-icon-btn ciq-btn" decoration="none" stxtap="update(\'decoration\',null)" cq-section>\n\t\t\t\t\t\t\t<cq-tooltip>None</cq-tooltip>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="ciq-icon-btn ciq-btn" decoration="parentheses" stxtap="update(\'decoration\',\'parentheses\')" cq-section>\n\t\t\t\t\t\t\t<cq-tooltip>Parentheses</cq-tooltip>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="ciq-icon-btn ciq-btn" decoration="enclosed" stxtap="update(\'decoration\',\'enclosed\')" cq-section>\n\t\t\t\t\t\t\t<cq-tooltip>Enclosed</cq-tooltip>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class="ciq-heading ciq-show-lines"  cq-section>\n\t\t\t\t\t\t\tShow Lines: <span stxtap="toggleLines()" class="ciq-checkbox ciq-active"><span></span></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class="ciq-drawing-edit-hidden" cq-section>\n\t\t\t\t\t\t<div cq-toolbar-action="save" stxtap="saveConfig()" cq-section><div cq-toolbar-dirty></div><cq-tooltip>Save Config</cq-tooltip></div>\n\t\t\t\t\t\t<div cq-toolbar-action="restore" stxtap="restoreDefaultConfig()" cq-section><cq-tooltip>Restore Config</cq-tooltip></div>\n\t\t\t\t\t</div>\n\t\t\t\t</cq-toolbar-settings>\n\t\t\t\t<cq-measure><span class="mMeasure"></span></cq-measure>\n\t\t\t</div>\n\t\t<div class="resize-strip"></div>\n\t</div>\n\t',e.UI.DrawingSettings=rt,e.UI.addComponentDefinition("cq-drawing-settings",rt);class ct extends e.UI.Scroll{constructor(){super(),this.noMaximize=!0}}return e.UI.MenuDropDown=ct,e.UI.addComponentDefinition("cq-menu-dropdown",ct),t},void 0===(a="function"==typeof n?n.apply(e,s):n)||(t.exports=a)},9106:function(){(function(){"use strict";var t=new Set("annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" "));function e(e){var i=t.has(e);return e=/^[a-z][.0-9_a-z]*-[\-.0-9_a-z]*$/.test(e),!i&&e}function i(t){var e=t.isConnected;if(void 0!==e)return e;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function n(t,e){for(;e&&e!==t&&!e.nextSibling;)e=e.parentNode;return e&&e!==t?e.nextSibling:null}function s(t,e,i){i=void 0===i?new Set:i;for(var a=t;a;){if(a.nodeType===Node.ELEMENT_NODE){var o=a;e(o);var r=o.localName;if("link"===r&&"import"===o.getAttribute("rel")){if((a=o.import)instanceof Node&&!i.has(a))for(i.add(a),a=a.firstChild;a;a=a.nextSibling)s(a,e,i);a=n(t,o);continue}if("template"===r){a=n(t,o);continue}if(o=o.__CE_shadowRoot)for(o=o.firstChild;o;o=o.nextSibling)s(o,e,i)}a=a.firstChild?a.firstChild:n(t,a)}}function a(t,e,i){t[e]=i}function o(){this.a=new Map,this.f=new Map,this.c=[],this.b=!1}function r(t,e){t.b=!0,t.c.push(e)}function c(t,e){t.b&&s(e,(function(e){return l(t,e)}))}function l(t,e){if(t.b&&!e.__CE_patched){e.__CE_patched=!0;for(var i=0;i<t.c.length;i++)t.c[i](e)}}function h(t,e){var i=[];for(s(e,(function(t){return i.push(t)})),e=0;e<i.length;e++){var n=i[e];1===n.__CE_state?t.connectedCallback(n):p(t,n)}}function d(t,e){var i=[];for(s(e,(function(t){return i.push(t)})),e=0;e<i.length;e++){var n=i[e];1===n.__CE_state&&t.disconnectedCallback(n)}}function u(t,e,i){var n=(i=void 0===i?{}:i).u||new Set,a=i.h||function(e){return p(t,e)},o=[];if(s(e,(function(e){if("link"===e.localName&&"import"===e.getAttribute("rel")){var i=e.import;i instanceof Node&&(i.__CE_isImportDocument=!0,i.__CE_hasRegistry=!0),i&&"complete"===i.readyState?i.__CE_documentLoadHandled=!0:e.addEventListener("load",(function(){var i=e.import;if(!i.__CE_documentLoadHandled){i.__CE_documentLoadHandled=!0;var s=new Set(n);s.delete(i),u(t,i,{u:s,h:a})}}))}else o.push(e)}),n),t.b)for(e=0;e<o.length;e++)l(t,o[e]);for(e=0;e<o.length;e++)a(o[e])}function p(t,e){if(void 0===e.__CE_state){var n=e.ownerDocument;if((n.defaultView||n.__CE_isImportDocument&&n.__CE_hasRegistry)&&(n=t.a.get(e.localName))){n.constructionStack.push(e);var s=n.constructorFunction;try{try{if(new s!==e)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{n.constructionStack.pop()}}catch(t){throw e.__CE_state=2,t}if(e.__CE_state=1,e.__CE_definition=n,n.attributeChangedCallback)for(n=n.observedAttributes,s=0;s<n.length;s++){var a=n[s],o=e.getAttribute(a);null!==o&&t.attributeChangedCallback(e,a,null,o,null)}i(e)&&t.connectedCallback(e)}}}function m(t){var e=document;this.c=t,this.a=e,this.b=void 0,u(this.c,this.a),"loading"===this.a.readyState&&(this.b=new MutationObserver(this.f.bind(this)),this.b.observe(this.a,{childList:!0,subtree:!0}))}function g(t){t.b&&t.b.disconnect()}function f(){var t=this;this.b=this.a=void 0,this.c=new Promise((function(e){t.b=e,t.a&&e(t.a)}))}function v(t){if(t.a)throw Error("Already resolved.");t.a=void 0,t.b&&t.b(void 0)}function b(t){this.c=!1,this.a=t,this.j=new Map,this.f=function(t){return t()},this.b=!1,this.i=[],this.o=new m(t)}o.prototype.connectedCallback=function(t){var e=t.__CE_definition;e.connectedCallback&&e.connectedCallback.call(t)},o.prototype.disconnectedCallback=function(t){var e=t.__CE_definition;e.disconnectedCallback&&e.disconnectedCallback.call(t)},o.prototype.attributeChangedCallback=function(t,e,i,n,s){var a=t.__CE_definition;a.attributeChangedCallback&&-1<a.observedAttributes.indexOf(e)&&a.attributeChangedCallback.call(t,e,i,n,s)},m.prototype.f=function(t){var e=this.a.readyState;for("interactive"!==e&&"complete"!==e||g(this),e=0;e<t.length;e++)for(var i=t[e].addedNodes,n=0;n<i.length;n++)u(this.c,i[n])},b.prototype.l=function(t,i){var n=this;if(!(i instanceof Function))throw new TypeError("Custom element constructors must be functions.");if(!e(t))throw new SyntaxError("The element name '"+t+"' is not valid.");if(this.a.a.get(t))throw Error("A custom element with name '"+t+"' has already been defined.");if(this.c)throw Error("A custom element is already being defined.");this.c=!0;try{var s=function(t){var e=a[t];if(void 0!==e&&!(e instanceof Function))throw Error("The '"+t+"' callback must be a function.");return e},a=i.prototype;if(!(a instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var o=s("connectedCallback"),r=s("disconnectedCallback"),c=s("adoptedCallback"),l=s("attributeChangedCallback"),h=i.observedAttributes||[]}catch(t){return}finally{this.c=!1}i={localName:t,constructorFunction:i,connectedCallback:o,disconnectedCallback:r,adoptedCallback:c,attributeChangedCallback:l,observedAttributes:h,constructionStack:[]},function(t,e,i){t.a.set(e,i),t.f.set(i.constructorFunction,i)}(this.a,t,i),this.i.push(i),this.b||(this.b=!0,this.f((function(){return function(t){if(!1!==t.b){t.b=!1;for(var e=t.i,i=[],n=new Map,s=0;s<e.length;s++)n.set(e[s].localName,[]);for(u(t.a,document,{h:function(e){if(void 0===e.__CE_state){var s=e.localName,a=n.get(s);a?a.push(e):t.a.a.get(s)&&i.push(e)}}}),s=0;s<i.length;s++)p(t.a,i[s]);for(;0<e.length;){var a=e.shift();s=a.localName,a=n.get(a.localName);for(var o=0;o<a.length;o++)p(t.a,a[o]);(s=t.j.get(s))&&v(s)}}}(n)})))},b.prototype.h=function(t){u(this.a,t)},b.prototype.get=function(t){if(t=this.a.a.get(t))return t.constructorFunction},b.prototype.m=function(t){if(!e(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var i=this.j.get(t);return i||(i=new f,this.j.set(t,i),this.a.a.get(t)&&!this.i.some((function(e){return e.localName===t}))&&v(i)),i.c},b.prototype.s=function(t){g(this.o);var e=this.f;this.f=function(i){return t((function(){return e(i)}))}},window.CustomElementRegistry=b,b.prototype.define=b.prototype.l,b.prototype.upgrade=b.prototype.h,b.prototype.get=b.prototype.get,b.prototype.whenDefined=b.prototype.m,b.prototype.polyfillWrapFlushCallback=b.prototype.s;var y=window.Document.prototype.createElement,q=window.Document.prototype.createElementNS,x=window.Document.prototype.importNode,C=window.Document.prototype.prepend,w=window.Document.prototype.append,k=window.DocumentFragment.prototype.prepend,I=window.DocumentFragment.prototype.append,S=window.Node.prototype.cloneNode,T=window.Node.prototype.appendChild,E=window.Node.prototype.insertBefore,U=window.Node.prototype.removeChild,L=window.Node.prototype.replaceChild,D=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),M=window.Element.prototype.attachShadow,A=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),P=window.Element.prototype.getAttribute,N=window.Element.prototype.setAttribute,H=window.Element.prototype.removeAttribute,z=window.Element.prototype.getAttributeNS,_=window.Element.prototype.setAttributeNS,F=window.Element.prototype.removeAttributeNS,R=window.Element.prototype.insertAdjacentElement,O=window.Element.prototype.insertAdjacentHTML,B=window.Element.prototype.prepend,W=window.Element.prototype.append,V=window.Element.prototype.before,j=window.Element.prototype.after,Y=window.Element.prototype.replaceWith,X=window.Element.prototype.remove,Q=window.HTMLElement,K=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),G=window.HTMLElement.prototype.insertAdjacentElement,Z=window.HTMLElement.prototype.insertAdjacentHTML,J=new function(){};function $(t,e,n){function s(e){return function(n){for(var s=[],a=0;a<arguments.length;++a)s[a]=arguments[a];a=[];for(var o=[],r=0;r<s.length;r++){var c=s[r];if(c instanceof Element&&i(c)&&o.push(c),c instanceof DocumentFragment)for(c=c.firstChild;c;c=c.nextSibling)a.push(c);else a.push(c)}for(e.apply(this,s),s=0;s<o.length;s++)d(t,o[s]);if(i(this))for(s=0;s<a.length;s++)(o=a[s])instanceof Element&&h(t,o)}}void 0!==n.g&&(e.prepend=s(n.g)),void 0!==n.append&&(e.append=s(n.append))}var tt,et=window.customElements;if(!et||et.forcePolyfill||"function"!=typeof et.define||"function"!=typeof et.get){var it=new o;tt=it,window.HTMLElement=function(){function t(){var t=this.constructor,e=tt.f.get(t);if(!e)throw Error("The custom element being constructed was not registered with `customElements`.");var i=e.constructionStack;if(0===i.length)return i=y.call(document,e.localName),Object.setPrototypeOf(i,t.prototype),i.__CE_state=1,i.__CE_definition=e,l(tt,i),i;var n=i[e=i.length-1];if(n===J)throw Error("The HTMLElement constructor was either called reentrantly for this constructor or called multiple times.");return i[e]=J,Object.setPrototypeOf(n,t.prototype),l(tt,n),n}return t.prototype=Q.prototype,Object.defineProperty(t.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:t}),t}(),function(){var t=it;a(Document.prototype,"createElement",(function(e){if(this.__CE_hasRegistry){var i=t.a.get(e);if(i)return new i.constructorFunction}return e=y.call(this,e),l(t,e),e})),a(Document.prototype,"importNode",(function(e,i){return e=x.call(this,e,!!i),this.__CE_hasRegistry?u(t,e):c(t,e),e})),a(Document.prototype,"createElementNS",(function(e,i){if(this.__CE_hasRegistry&&(null===e||"http://www.w3.org/1999/xhtml"===e)){var n=t.a.get(i);if(n)return new n.constructorFunction}return e=q.call(this,e,i),l(t,e),e})),$(t,Document.prototype,{g:C,append:w})}(),$(it,DocumentFragment.prototype,{g:k,append:I}),function(){function t(t,n){Object.defineProperty(t,"textContent",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)n.set.call(this,t);else{var s=void 0;if(this.firstChild){var a=this.childNodes,o=a.length;if(0<o&&i(this)){s=Array(o);for(var r=0;r<o;r++)s[r]=a[r]}}if(n.set.call(this,t),s)for(t=0;t<s.length;t++)d(e,s[t])}}})}var e=it;a(Node.prototype,"insertBefore",(function(t,n){if(t instanceof DocumentFragment){var s=Array.prototype.slice.apply(t.childNodes);if(t=E.call(this,t,n),i(this))for(n=0;n<s.length;n++)h(e,s[n]);return t}return s=i(t),n=E.call(this,t,n),s&&d(e,t),i(this)&&h(e,t),n})),a(Node.prototype,"appendChild",(function(t){if(t instanceof DocumentFragment){var n=Array.prototype.slice.apply(t.childNodes);if(t=T.call(this,t),i(this))for(var s=0;s<n.length;s++)h(e,n[s]);return t}return n=i(t),s=T.call(this,t),n&&d(e,t),i(this)&&h(e,t),s})),a(Node.prototype,"cloneNode",(function(t){return t=S.call(this,!!t),this.ownerDocument.__CE_hasRegistry?u(e,t):c(e,t),t})),a(Node.prototype,"removeChild",(function(t){var n=i(t),s=U.call(this,t);return n&&d(e,t),s})),a(Node.prototype,"replaceChild",(function(t,n){if(t instanceof DocumentFragment){var s=Array.prototype.slice.apply(t.childNodes);if(t=L.call(this,t,n),i(this))for(d(e,n),n=0;n<s.length;n++)h(e,s[n]);return t}s=i(t);var a=L.call(this,t,n),o=i(this);return o&&d(e,n),s&&d(e,t),o&&h(e,t),a})),D&&D.get?t(Node.prototype,D):r(e,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){for(var t=[],e=0;e<this.childNodes.length;e++)t.push(this.childNodes[e].textContent);return t.join("")},set:function(t){for(;this.firstChild;)U.call(this,this.firstChild);T.call(this,document.createTextNode(t))}})}))}(),function(){function t(t,e){Object.defineProperty(t,"innerHTML",{enumerable:e.enumerable,configurable:!0,get:e.get,set:function(t){var n=this,a=void 0;if(i(this)&&(a=[],s(this,(function(t){t!==n&&a.push(t)}))),e.set.call(this,t),a)for(var r=0;r<a.length;r++){var l=a[r];1===l.__CE_state&&o.disconnectedCallback(l)}return this.ownerDocument.__CE_hasRegistry?u(o,this):c(o,this),t}})}function e(t,e){a(t,"insertAdjacentElement",(function(t,n){var s=i(n);return t=e.call(this,t,n),s&&d(o,n),i(t)&&h(o,n),t}))}function n(t,e){function i(t,e){for(var i=[];t!==e;t=t.nextSibling)i.push(t);for(e=0;e<i.length;e++)u(o,i[e])}a(t,"insertAdjacentHTML",(function(t,n){if("beforebegin"===(t=t.toLowerCase())){var s=this.previousSibling;e.call(this,t,n),i(s||this.parentNode.firstChild,this)}else if("afterbegin"===t)s=this.firstChild,e.call(this,t,n),i(this.firstChild,s);else if("beforeend"===t)s=this.lastChild,e.call(this,t,n),i(s||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");s=this.nextSibling,e.call(this,t,n),i(this.nextSibling,s)}}))}var o=it;M&&a(Element.prototype,"attachShadow",(function(t){return this.__CE_shadowRoot=M.call(this,t)})),A&&A.get?t(Element.prototype,A):K&&K.get?t(HTMLElement.prototype,K):r(o,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){return S.call(this,!0).innerHTML},set:function(t){var e="template"===this.localName,i=e?this.content:this,n=q.call(document,this.namespaceURI,this.localName);for(n.innerHTML=t;0<i.childNodes.length;)U.call(i,i.childNodes[0]);for(t=e?n.content:n;0<t.childNodes.length;)T.call(i,t.childNodes[0])}})})),a(Element.prototype,"setAttribute",(function(t,e){if(1!==this.__CE_state)return N.call(this,t,e);var i=P.call(this,t);N.call(this,t,e),e=P.call(this,t),o.attributeChangedCallback(this,t,i,e,null)})),a(Element.prototype,"setAttributeNS",(function(t,e,i){if(1!==this.__CE_state)return _.call(this,t,e,i);var n=z.call(this,t,e);_.call(this,t,e,i),i=z.call(this,t,e),o.attributeChangedCallback(this,e,n,i,t)})),a(Element.prototype,"removeAttribute",(function(t){if(1!==this.__CE_state)return H.call(this,t);var e=P.call(this,t);H.call(this,t),null!==e&&o.attributeChangedCallback(this,t,e,null,null)})),a(Element.prototype,"removeAttributeNS",(function(t,e){if(1!==this.__CE_state)return F.call(this,t,e);var i=z.call(this,t,e);F.call(this,t,e);var n=z.call(this,t,e);i!==n&&o.attributeChangedCallback(this,e,i,n,t)})),G?e(HTMLElement.prototype,G):R?e(Element.prototype,R):console.warn("Custom Elements: `Element#insertAdjacentElement` was not patched."),Z?n(HTMLElement.prototype,Z):O?n(Element.prototype,O):console.warn("Custom Elements: `Element#insertAdjacentHTML` was not patched."),$(o,Element.prototype,{g:B,append:W}),function(t){function e(e){return function(n){for(var s=[],a=0;a<arguments.length;++a)s[a]=arguments[a];a=[];for(var o=[],r=0;r<s.length;r++){var c=s[r];if(c instanceof Element&&i(c)&&o.push(c),c instanceof DocumentFragment)for(c=c.firstChild;c;c=c.nextSibling)a.push(c);else a.push(c)}for(e.apply(this,s),s=0;s<o.length;s++)d(t,o[s]);if(i(this))for(s=0;s<a.length;s++)(o=a[s])instanceof Element&&h(t,o)}}var n=Element.prototype;void 0!==V&&(n.before=e(V)),void 0!==V&&(n.after=e(j)),void 0!==Y&&a(n,"replaceWith",(function(e){for(var n=[],s=0;s<arguments.length;++s)n[s]=arguments[s];s=[];for(var a=[],o=0;o<n.length;o++){var r=n[o];if(r instanceof Element&&i(r)&&a.push(r),r instanceof DocumentFragment)for(r=r.firstChild;r;r=r.nextSibling)s.push(r);else s.push(r)}for(o=i(this),Y.apply(this,n),n=0;n<a.length;n++)d(t,a[n]);if(o)for(d(t,this),n=0;n<s.length;n++)(a=s[n])instanceof Element&&h(t,a)})),void 0!==X&&a(n,"remove",(function(){var e=i(this);X.call(this),e&&d(t,this)}))}(o)}(),document.__CE_hasRegistry=!0;var nt=new b(it);Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:nt})}}).call(self)},24475:function(t,e,i){var n,s,a;!function t(e,i,n){function s(o,r){if(!i[o]){if(!e[o]){if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[o]={exports:{}};e[o][0].call(l.exports,(function(t){var i=e[o][1][t];return s(i||t)}),l,l.exports,t,e,i,n)}return i[o].exports}for(var a=void 0,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,o){"use strict";var r=t("../main"),c=t("../plugin/instances");function l(t){t.fn.perfectScrollbar=function(t){return this.each((function(){if("object"==typeof t||void 0===t){var e=t;c.get(this)||r.initialize(this,e)}else{var i=t;"update"===i?r.update(this):"destroy"===i&&r.destroy(this)}}))}}s=[i(19755)],void 0===(a="function"==typeof(n=l)?n.apply(o,s):n)||(e.exports=a),e.exports=l},{"../main":7,"../plugin/instances":18}],2:[function(t,e,i){"use strict";i.add=function(t,e){t.classList?t.classList.add(e):function(t,e){var i=t.className.split(" ");i.indexOf(e)<0&&i.push(e),t.className=i.join(" ")}(t,e)},i.remove=function(t,e){t.classList?t.classList.remove(e):function(t,e){var i=t.className.split(" "),n=i.indexOf(e);n>=0&&i.splice(n,1),t.className=i.join(" ")}(t,e)},i.list=function(t){return t.classList?Array.prototype.slice.apply(t.classList):t.className.split(" ")}},{}],3:[function(t,e,i){"use strict";var n={};n.e=function(t,e){var i=document.createElement(t);return i.className=e,i},n.appendTo=function(t,e){return e.appendChild(t),t},n.css=function(t,e,i){return"object"==typeof e?function(t,e){for(var i in e){var n=e[i];"number"==typeof n&&(n=n.toString()+"px"),t.style[i]=n}return t}(t,e):void 0===i?function(t,e){return window.getComputedStyle(t)[e]}(t,e):function(t,e,i){return"number"==typeof i&&(i=i.toString()+"px"),t.style[e]=i,t}(t,e,i)},n.matches=function(t,e){return void 0!==t.matches?t.matches(e):void 0!==t.matchesSelector?t.matchesSelector(e):void 0!==t.webkitMatchesSelector?t.webkitMatchesSelector(e):void 0!==t.mozMatchesSelector?t.mozMatchesSelector(e):void 0!==t.msMatchesSelector?t.msMatchesSelector(e):void 0},n.remove=function(t){void 0!==t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)},n.queryChildren=function(t,e){return Array.prototype.filter.call(t.childNodes,(function(t){return n.matches(t,e)}))},e.exports=n},{}],4:[function(t,e,i){"use strict";var n=function(t){this.element=t,this.events={}};n.prototype.bind=function(t,e){void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e),this.element.addEventListener(t,e,!1)},n.prototype.unbind=function(t,e){var i=void 0!==e;this.events[t]=this.events[t].filter((function(n){return!(!i||n===e)||(this.element.removeEventListener(t,n,!1),!1)}),this)},n.prototype.unbindAll=function(){for(var t in this.events)this.unbind(t)};var s=function(){this.eventElements=[]};s.prototype.eventElement=function(t){var e=this.eventElements.filter((function(e){return e.element===t}))[0];return void 0===e&&(e=new n(t),this.eventElements.push(e)),e},s.prototype.bind=function(t,e,i){this.eventElement(t).bind(e,i)},s.prototype.unbind=function(t,e,i){this.eventElement(t).unbind(e,i)},s.prototype.unbindAll=function(){for(var t=0;t<this.eventElements.length;t++)this.eventElements[t].unbindAll()},s.prototype.once=function(t,e,i){var n=this.eventElement(t),s=function(t){n.unbind(e,s),i(t)};n.bind(e,s)},e.exports=s},{}],5:[function(t,e,i){"use strict";e.exports=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}()},{}],6:[function(t,e,i){"use strict";var n=t("./class"),s=t("./dom"),a=i.toInt=function(t){return parseInt(t,10)||0},o=i.clone=function(t){if(null===t)return null;if(t.constructor===Array)return t.map(o);if("object"==typeof t){var e={};for(var i in t)e[i]=o(t[i]);return e}return t};i.extend=function(t,e){var i=o(t);for(var n in e)i[n]=o(e[n]);return i},i.isEditable=function(t){return s.matches(t,"input,[contenteditable]")||s.matches(t,"select,[contenteditable]")||s.matches(t,"textarea,[contenteditable]")||s.matches(t,"button,[contenteditable]")},i.removePsClasses=function(t){for(var e=n.list(t),i=0;i<e.length;i++){var s=e[i];0===s.indexOf("ps-")&&n.remove(t,s)}},i.outerWidth=function(t){return a(s.css(t,"width"))+a(s.css(t,"paddingLeft"))+a(s.css(t,"paddingRight"))+a(s.css(t,"borderLeftWidth"))+a(s.css(t,"borderRightWidth"))},i.startScrolling=function(t,e){n.add(t,"ps-in-scrolling"),void 0!==e?n.add(t,"ps-"+e):(n.add(t,"ps-x"),n.add(t,"ps-y"))},i.stopScrolling=function(t,e){n.remove(t,"ps-in-scrolling"),void 0!==e?n.remove(t,"ps-"+e):(n.remove(t,"ps-x"),n.remove(t,"ps-y"))},i.env={isWebKit:"WebkitAppearance"in document.documentElement.style,supportsTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsIePointer:null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(t,e,i){"use strict";var n=t("./plugin/destroy"),s=t("./plugin/initialize"),a=t("./plugin/update");e.exports={initialize:s,update:a,destroy:n}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":21}],8:[function(t,e,i){"use strict";e.exports={handlers:["click-rail","drag-scrollbar","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollXMarginOffset:0,scrollYMarginOffset:0,stopPropagationOnClick:!0,suppressScrollX:!1,suppressScrollY:!1,swipePropagation:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1,theme:"default"}},{}],9:[function(t,e,i){"use strict";var n=t("../lib/helper"),s=t("../lib/dom"),a=t("./instances");e.exports=function(t){var e=a.get(t);e&&(e.event.unbindAll(),s.remove(e.scrollbarX),s.remove(e.scrollbarY),s.remove(e.scrollbarXRail),s.remove(e.scrollbarYRail),n.removePsClasses(t),a.remove(t))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(t,e,i){"use strict";var n=t("../../lib/helper"),s=t("../instances"),a=t("../update-geometry"),o=t("../update-scroll");e.exports=function(t){!function(t,e){function i(t){return t.getBoundingClientRect()}var s=function(t){t.stopPropagation()};e.settings.stopPropagationOnClick&&e.event.bind(e.scrollbarY,"click",s),e.event.bind(e.scrollbarYRail,"click",(function(s){var r=n.toInt(e.scrollbarYHeight/2),c=e.railYRatio*(s.pageY-window.pageYOffset-i(e.scrollbarYRail).top-r)/(e.railYRatio*(e.railYHeight-e.scrollbarYHeight));c<0?c=0:c>1&&(c=1),o(t,"top",(e.contentHeight-e.containerHeight)*c),a(t),s.stopPropagation()})),e.settings.stopPropagationOnClick&&e.event.bind(e.scrollbarX,"click",s),e.event.bind(e.scrollbarXRail,"click",(function(s){var r=n.toInt(e.scrollbarXWidth/2),c=e.railXRatio*(s.pageX-window.pageXOffset-i(e.scrollbarXRail).left-r)/(e.railXRatio*(e.railXWidth-e.scrollbarXWidth));c<0?c=0:c>1&&(c=1),o(t,"left",(e.contentWidth-e.containerWidth)*c-e.negativeScrollAdjustment),a(t),s.stopPropagation()}))}(t,s.get(t))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],11:[function(t,e,i){"use strict";var n=t("../../lib/helper"),s=t("../../lib/dom"),a=t("../instances"),o=t("../update-geometry"),r=t("../update-scroll");function c(t,e){var i=null,a=null;var c=function(s){!function(s){var a=i+s*e.railXRatio,o=Math.max(0,e.scrollbarXRail.getBoundingClientRect().left)+e.railXRatio*(e.railXWidth-e.scrollbarXWidth);e.scrollbarXLeft=a<0?0:a>o?o:a;var c=n.toInt(e.scrollbarXLeft*(e.contentWidth-e.containerWidth)/(e.containerWidth-e.railXRatio*e.scrollbarXWidth))-e.negativeScrollAdjustment;r(t,"left",c)}(s.pageX-a),o(t),s.stopPropagation(),s.preventDefault()},l=function(){n.stopScrolling(t,"x"),e.event.unbind(e.ownerDocument,"mousemove",c)};e.event.bind(e.scrollbarX,"mousedown",(function(o){a=o.pageX,i=n.toInt(s.css(e.scrollbarX,"left"))*e.railXRatio,n.startScrolling(t,"x"),e.event.bind(e.ownerDocument,"mousemove",c),e.event.once(e.ownerDocument,"mouseup",l),o.stopPropagation(),o.preventDefault()}))}function l(t,e){var i=null,a=null;var c=function(s){!function(s){var a=i+s*e.railYRatio,o=Math.max(0,e.scrollbarYRail.getBoundingClientRect().top)+e.railYRatio*(e.railYHeight-e.scrollbarYHeight);e.scrollbarYTop=a<0?0:a>o?o:a;var c=n.toInt(e.scrollbarYTop*(e.contentHeight-e.containerHeight)/(e.containerHeight-e.railYRatio*e.scrollbarYHeight));r(t,"top",c)}(s.pageY-a),o(t),s.stopPropagation(),s.preventDefault()},l=function(){n.stopScrolling(t,"y"),e.event.unbind(e.ownerDocument,"mousemove",c)};e.event.bind(e.scrollbarY,"mousedown",(function(o){a=o.pageY,i=n.toInt(s.css(e.scrollbarY,"top"))*e.railYRatio,n.startScrolling(t,"y"),e.event.bind(e.ownerDocument,"mousemove",c),e.event.once(e.ownerDocument,"mouseup",l),o.stopPropagation(),o.preventDefault()}))}e.exports=function(t){var e=a.get(t);c(t,e),l(t,e)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],12:[function(t,e,i){"use strict";var n=t("../../lib/helper"),s=t("../../lib/dom"),a=t("../instances"),o=t("../update-geometry"),r=t("../update-scroll");function c(t,e){var i=!1;e.event.bind(t,"mouseenter",(function(){i=!0})),e.event.bind(t,"mouseleave",(function(){i=!1}));var a=!1;e.event.bind(e.ownerDocument,"keydown",(function(c){if(!(c.isDefaultPrevented&&c.isDefaultPrevented()||c.defaultPrevented)){var l=s.matches(e.scrollbarX,":focus")||s.matches(e.scrollbarY,":focus");if(i||l){var h=document.activeElement?document.activeElement:e.ownerDocument.activeElement;if(h){if("IFRAME"===h.tagName)h=h.contentDocument.activeElement;else for(;h.shadowRoot;)h=h.shadowRoot.activeElement;if(n.isEditable(h))return}var d=0,u=0;switch(c.which){case 37:d=-30;break;case 38:u=30;break;case 39:d=30;break;case 40:u=-30;break;case 33:u=90;break;case 32:u=c.shiftKey?90:-90;break;case 34:u=-90;break;case 35:u=c.ctrlKey?-e.contentHeight:-e.containerHeight;break;case 36:u=c.ctrlKey?t.scrollTop:e.containerHeight;break;default:return}r(t,"top",t.scrollTop-u),r(t,"left",t.scrollLeft+d),o(t),a=function(i,n){var s=t.scrollTop;if(0===i){if(!e.scrollbarYActive)return!1;if(0===s&&n>0||s>=e.contentHeight-e.containerHeight&&n<0)return!e.settings.wheelPropagation}var a=t.scrollLeft;if(0===n){if(!e.scrollbarXActive)return!1;if(0===a&&i<0||a>=e.contentWidth-e.containerWidth&&i>0)return!e.settings.wheelPropagation}return!0}(d,u),a&&c.preventDefault()}}}))}e.exports=function(t){c(t,a.get(t))}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],13:[function(t,e,i){"use strict";var n=t("../instances"),s=t("../update-geometry"),a=t("../update-scroll");function o(t,e){var i=!1;function n(n){var o=function(t){var e=t.deltaX,i=-1*t.deltaY;return void 0!==e&&void 0!==i||(e=-1*t.wheelDeltaX/6,i=t.wheelDeltaY/6),t.deltaMode&&1===t.deltaMode&&(e*=10,i*=10),e!=e&&i!=i&&(e=0,i=t.wheelDelta),[e,i]}(n),r=o[0],c=o[1];(function(e,i){var n=t.querySelector("textarea:hover, select[multiple]:hover, .ps-child:hover");if(n){if("TEXTAREA"!==n.tagName&&!window.getComputedStyle(n).overflow.match(/(scroll|auto)/))return!1;var s=n.scrollHeight-n.clientHeight;if(s>0&&!(0===n.scrollTop&&i>0||n.scrollTop===s&&i<0))return!0;var a=n.scrollLeft-n.clientWidth;if(a>0&&!(0===n.scrollLeft&&e<0||n.scrollLeft===a&&e>0))return!0}return!1})(r,c)||(i=!1,e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(a(t,"top",c?t.scrollTop-c*e.settings.wheelSpeed:t.scrollTop+r*e.settings.wheelSpeed),i=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(a(t,"left",r?t.scrollLeft+r*e.settings.wheelSpeed:t.scrollLeft-c*e.settings.wheelSpeed),i=!0):(a(t,"top",t.scrollTop-c*e.settings.wheelSpeed),a(t,"left",t.scrollLeft+r*e.settings.wheelSpeed)),s(t),i=i||function(i,n){var s=t.scrollTop;if(0===i){if(!e.scrollbarYActive)return!1;if(0===s&&n>0||s>=e.contentHeight-e.containerHeight&&n<0)return!e.settings.wheelPropagation}var a=t.scrollLeft;if(0===n){if(!e.scrollbarXActive)return!1;if(0===a&&i<0||a>=e.contentWidth-e.containerWidth&&i>0)return!e.settings.wheelPropagation}return!0}(r,c),i&&(n.stopPropagation(),n.preventDefault()))}void 0!==window.onwheel?e.event.bind(t,"wheel",n):void 0!==window.onmousewheel&&e.event.bind(t,"mousewheel",n)}e.exports=function(t){o(t,n.get(t))}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],14:[function(t,e,i){"use strict";var n=t("../instances"),s=t("../update-geometry");e.exports=function(t){!function(t,e){e.event.bind(t,"scroll",(function(){s(t)}))}(t,n.get(t))}},{"../instances":18,"../update-geometry":19}],15:[function(t,e,i){"use strict";var n=t("../../lib/helper"),s=t("../instances"),a=t("../update-geometry"),o=t("../update-scroll");function r(t,e){var i=null,r={top:0,left:0};function c(){i&&(clearInterval(i),i=null),n.stopScrolling(t)}var l=!1;e.event.bind(e.ownerDocument,"selectionchange",(function(){var e;t.contains(0===(e=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"").toString().length?null:e.getRangeAt(0).commonAncestorContainer)?l=!0:(l=!1,c())})),e.event.bind(window,"mouseup",(function(){l&&(l=!1,c())})),e.event.bind(window,"mousemove",(function(e){if(l){var h={x:e.pageX,y:e.pageY},d={left:t.offsetLeft,right:t.offsetLeft+t.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight};h.x<d.left+3?(r.left=-5,n.startScrolling(t,"x")):h.x>d.right-3?(r.left=5,n.startScrolling(t,"x")):r.left=0,h.y<d.top+3?(r.top=d.top+3-h.y<5?-5:-20,n.startScrolling(t,"y")):h.y>d.bottom-3?(r.top=h.y-d.bottom+3<5?5:20,n.startScrolling(t,"y")):r.top=0,0===r.top&&0===r.left?c():i||(i=setInterval((function(){s.get(t)?(o(t,"top",t.scrollTop+r.top),o(t,"left",t.scrollLeft+r.left),a(t)):clearInterval(i)}),50))}}))}e.exports=function(t){r(t,s.get(t))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],16:[function(t,e,i){"use strict";var n=t("../../lib/helper"),s=t("../instances"),a=t("../update-geometry"),o=t("../update-scroll");function r(t,e,i,n){function r(e,i){o(t,"top",t.scrollTop-i),o(t,"left",t.scrollLeft-e),a(t)}var c={},l=0,h={},d=null,u=!1,p=!1;function m(){u=!0}function g(){u=!1}function f(t){return t.targetTouches?t.targetTouches[0]:t}function v(t){return!(!t.targetTouches||1!==t.targetTouches.length)||!(!t.pointerType||"mouse"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_MOUSE)}function b(t){if(v(t)){p=!0;var e=f(t);c.pageX=e.pageX,c.pageY=e.pageY,l=(new Date).getTime(),null!==d&&clearInterval(d),t.stopPropagation()}}function y(i){if(!p&&e.settings.swipePropagation&&b(i),!u&&p&&v(i)){var n=f(i),s={pageX:n.pageX,pageY:n.pageY},a=s.pageX-c.pageX,o=s.pageY-c.pageY;r(a,o),c=s;var d=(new Date).getTime(),m=d-l;m>0&&(h.x=a/m,h.y=o/m,l=d),function(i,n){var s=t.scrollTop,a=t.scrollLeft,o=Math.abs(i),r=Math.abs(n);if(r>o){if(n<0&&s===e.contentHeight-e.containerHeight||n>0&&0===s)return!e.settings.swipePropagation}else if(o>r&&(i<0&&a===e.contentWidth-e.containerWidth||i>0&&0===a))return!e.settings.swipePropagation;return!0}(a,o)&&(i.stopPropagation(),i.preventDefault())}}function q(){!u&&p&&(p=!1,clearInterval(d),d=setInterval((function(){s.get(t)?Math.abs(h.x)<.01&&Math.abs(h.y)<.01?clearInterval(d):(r(30*h.x,30*h.y),h.x*=.8,h.y*=.8):clearInterval(d)}),10))}i&&(e.event.bind(window,"touchstart",m),e.event.bind(window,"touchend",g),e.event.bind(t,"touchstart",b),e.event.bind(t,"touchmove",y),e.event.bind(t,"touchend",q)),n&&(window.PointerEvent?(e.event.bind(window,"pointerdown",m),e.event.bind(window,"pointerup",g),e.event.bind(t,"pointerdown",b),e.event.bind(t,"pointermove",y),e.event.bind(t,"pointerup",q)):window.MSPointerEvent&&(e.event.bind(window,"MSPointerDown",m),e.event.bind(window,"MSPointerUp",g),e.event.bind(t,"MSPointerDown",b),e.event.bind(t,"MSPointerMove",y),e.event.bind(t,"MSPointerUp",q)))}e.exports=function(t){(n.env.supportsTouch||n.env.supportsIePointer)&&r(t,s.get(t),n.env.supportsTouch,n.env.supportsIePointer)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],17:[function(t,e,i){"use strict";var n=t("../lib/helper"),s=t("../lib/class"),a=t("./instances"),o=t("./update-geometry"),r={"click-rail":t("./handler/click-rail"),"drag-scrollbar":t("./handler/drag-scrollbar"),keyboard:t("./handler/keyboard"),wheel:t("./handler/mouse-wheel"),touch:t("./handler/touch"),selection:t("./handler/selection")},c=t("./handler/native-scroll");e.exports=function(t,e){e="object"==typeof e?e:{},s.add(t,"ps-container");var i=a.add(t);i.settings=n.extend(i.settings,e),s.add(t,"ps-theme-"+i.settings.theme),i.settings.handlers.forEach((function(e){r[e](t)})),c(t),o(t)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(t,e,i){"use strict";var n=t("../lib/helper"),s=t("../lib/class"),a=t("./default-setting"),o=t("../lib/dom"),r=t("../lib/event-manager"),c=t("../lib/guid"),l={};function h(t){var e,i,c=this;function l(){s.add(t,"ps-focus")}function h(){s.remove(t,"ps-focus")}c.settings=n.clone(a),c.containerWidth=null,c.containerHeight=null,c.contentWidth=null,c.contentHeight=null,c.isRtl="rtl"===o.css(t,"direction"),c.isNegativeScroll=(i=t.scrollLeft,t.scrollLeft=-1,e=t.scrollLeft<0,t.scrollLeft=i,e),c.negativeScrollAdjustment=c.isNegativeScroll?t.scrollWidth-t.clientWidth:0,c.event=new r,c.ownerDocument=t.ownerDocument||document,c.scrollbarXRail=o.appendTo(o.e("div","ps-scrollbar-x-rail"),t),c.scrollbarX=o.appendTo(o.e("div","ps-scrollbar-x"),c.scrollbarXRail),c.scrollbarX.setAttribute("tabindex",0),c.event.bind(c.scrollbarX,"focus",l),c.event.bind(c.scrollbarX,"blur",h),c.scrollbarXActive=null,c.scrollbarXWidth=null,c.scrollbarXLeft=null,c.scrollbarXBottom=n.toInt(o.css(c.scrollbarXRail,"bottom")),c.isScrollbarXUsingBottom=c.scrollbarXBottom==c.scrollbarXBottom,c.scrollbarXTop=c.isScrollbarXUsingBottom?null:n.toInt(o.css(c.scrollbarXRail,"top")),c.railBorderXWidth=n.toInt(o.css(c.scrollbarXRail,"borderLeftWidth"))+n.toInt(o.css(c.scrollbarXRail,"borderRightWidth")),o.css(c.scrollbarXRail,"display","block"),c.railXMarginWidth=n.toInt(o.css(c.scrollbarXRail,"marginLeft"))+n.toInt(o.css(c.scrollbarXRail,"marginRight")),o.css(c.scrollbarXRail,"display",""),c.railXWidth=null,c.railXRatio=null,c.scrollbarYRail=o.appendTo(o.e("div","ps-scrollbar-y-rail"),t),c.scrollbarY=o.appendTo(o.e("div","ps-scrollbar-y"),c.scrollbarYRail),c.scrollbarY.setAttribute("tabindex",0),c.event.bind(c.scrollbarY,"focus",l),c.event.bind(c.scrollbarY,"blur",h),c.scrollbarYActive=null,c.scrollbarYHeight=null,c.scrollbarYTop=null,c.scrollbarYRight=n.toInt(o.css(c.scrollbarYRail,"right")),c.isScrollbarYUsingRight=c.scrollbarYRight==c.scrollbarYRight,c.scrollbarYLeft=c.isScrollbarYUsingRight?null:n.toInt(o.css(c.scrollbarYRail,"left")),c.scrollbarYOuterWidth=c.isRtl?n.outerWidth(c.scrollbarY):null,c.railBorderYWidth=n.toInt(o.css(c.scrollbarYRail,"borderTopWidth"))+n.toInt(o.css(c.scrollbarYRail,"borderBottomWidth")),o.css(c.scrollbarYRail,"display","block"),c.railYMarginHeight=n.toInt(o.css(c.scrollbarYRail,"marginTop"))+n.toInt(o.css(c.scrollbarYRail,"marginBottom")),o.css(c.scrollbarYRail,"display",""),c.railYHeight=null,c.railYRatio=null}function d(t){return t.getAttribute("data-ps-id")}i.add=function(t){var e=c();return function(t,e){t.setAttribute("data-ps-id",e)}(t,e),l[e]=new h(t),l[e]},i.remove=function(t){delete l[d(t)],function(t){t.removeAttribute("data-ps-id")}(t)},i.get=function(t){return l[d(t)]}},{"../lib/class":2,"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(t,e,i){"use strict";var n=t("../lib/helper"),s=t("../lib/class"),a=t("../lib/dom"),o=t("./instances"),r=t("./update-scroll");function c(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}e.exports=function(t){var e,i=o.get(t);i.containerWidth=t.clientWidth,i.containerHeight=t.clientHeight,i.contentWidth=t.scrollWidth,i.contentHeight=t.scrollHeight,t.contains(i.scrollbarXRail)||((e=a.queryChildren(t,".ps-scrollbar-x-rail")).length>0&&e.forEach((function(t){a.remove(t)})),a.appendTo(i.scrollbarXRail,t)),t.contains(i.scrollbarYRail)||((e=a.queryChildren(t,".ps-scrollbar-y-rail")).length>0&&e.forEach((function(t){a.remove(t)})),a.appendTo(i.scrollbarYRail,t)),!i.settings.suppressScrollX&&i.containerWidth+i.settings.scrollXMarginOffset<i.contentWidth?(i.scrollbarXActive=!0,i.railXWidth=i.containerWidth-i.railXMarginWidth,i.railXRatio=i.containerWidth/i.railXWidth,i.scrollbarXWidth=c(i,n.toInt(i.railXWidth*i.containerWidth/i.contentWidth)),i.scrollbarXLeft=n.toInt((i.negativeScrollAdjustment+t.scrollLeft)*(i.railXWidth-i.scrollbarXWidth)/(i.contentWidth-i.containerWidth))):i.scrollbarXActive=!1,!i.settings.suppressScrollY&&i.containerHeight+i.settings.scrollYMarginOffset<i.contentHeight?(i.scrollbarYActive=!0,i.railYHeight=i.containerHeight-i.railYMarginHeight,i.railYRatio=i.containerHeight/i.railYHeight,i.scrollbarYHeight=c(i,n.toInt(i.railYHeight*i.containerHeight/i.contentHeight)),i.scrollbarYTop=n.toInt(t.scrollTop*(i.railYHeight-i.scrollbarYHeight)/(i.contentHeight-i.containerHeight))):i.scrollbarYActive=!1,i.scrollbarXLeft>=i.railXWidth-i.scrollbarXWidth&&(i.scrollbarXLeft=i.railXWidth-i.scrollbarXWidth),i.scrollbarYTop>=i.railYHeight-i.scrollbarYHeight&&(i.scrollbarYTop=i.railYHeight-i.scrollbarYHeight),function(t,e){var i={width:e.railXWidth};e.isRtl?i.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth-e.contentWidth:i.left=t.scrollLeft,e.isScrollbarXUsingBottom?i.bottom=e.scrollbarXBottom-t.scrollTop:i.top=e.scrollbarXTop+t.scrollTop,a.css(e.scrollbarXRail,i);var n={top:t.scrollTop,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?n.right=e.contentWidth-(e.negativeScrollAdjustment+t.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth:n.right=e.scrollbarYRight-t.scrollLeft:e.isRtl?n.left=e.negativeScrollAdjustment+t.scrollLeft+2*e.containerWidth-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:n.left=e.scrollbarYLeft+t.scrollLeft,a.css(e.scrollbarYRail,n),a.css(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),a.css(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}(t,i),i.scrollbarXActive?s.add(t,"ps-active-x"):(s.remove(t,"ps-active-x"),i.scrollbarXWidth=0,i.scrollbarXLeft=0,r(t,"left",0)),i.scrollbarYActive?s.add(t,"ps-active-y"):(s.remove(t,"ps-active-y"),i.scrollbarYHeight=0,i.scrollbarYTop=0,r(t,"top",0))}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-scroll":20}],20:[function(t,e,i){"use strict";var n,s,a=t("./instances"),o=document.createEvent("Event"),r=document.createEvent("Event"),c=document.createEvent("Event"),l=document.createEvent("Event"),h=document.createEvent("Event"),d=document.createEvent("Event"),u=document.createEvent("Event"),p=document.createEvent("Event"),m=document.createEvent("Event"),g=document.createEvent("Event");o.initEvent("ps-scroll-up",!0,!0),r.initEvent("ps-scroll-down",!0,!0),c.initEvent("ps-scroll-left",!0,!0),l.initEvent("ps-scroll-right",!0,!0),h.initEvent("ps-scroll-y",!0,!0),d.initEvent("ps-scroll-x",!0,!0),u.initEvent("ps-x-reach-start",!0,!0),p.initEvent("ps-x-reach-end",!0,!0),m.initEvent("ps-y-reach-start",!0,!0),g.initEvent("ps-y-reach-end",!0,!0),e.exports=function(t,e,i){if(void 0===t)throw"You must provide an element to the update-scroll function";if(void 0===e)throw"You must provide an axis to the update-scroll function";if(void 0===i)throw"You must provide a value to the update-scroll function";"top"===e&&i<=0&&(t.scrollTop=i=0,t.dispatchEvent(m)),"left"===e&&i<=0&&(t.scrollLeft=i=0,t.dispatchEvent(u));var f=a.get(t);"top"===e&&i>=f.contentHeight-f.containerHeight&&((i=f.contentHeight-f.containerHeight)-t.scrollTop<=1?i=t.scrollTop:t.scrollTop=i,t.dispatchEvent(g)),"left"===e&&i>=f.contentWidth-f.containerWidth&&((i=f.contentWidth-f.containerWidth)-t.scrollLeft<=1?i=t.scrollLeft:t.scrollLeft=i,t.dispatchEvent(p)),n||(n=t.scrollTop),s||(s=t.scrollLeft),"top"===e&&i<n&&t.dispatchEvent(o),"top"===e&&i>n&&t.dispatchEvent(r),"left"===e&&i<s&&t.dispatchEvent(c),"left"===e&&i>s&&t.dispatchEvent(l),"top"===e&&(t.scrollTop=n=i,t.dispatchEvent(h)),"left"===e&&(t.scrollLeft=s=i,t.dispatchEvent(d))}},{"./instances":18}],21:[function(t,e,i){"use strict";var n=t("../lib/helper"),s=t("../lib/dom"),a=t("./instances"),o=t("./update-geometry"),r=t("./update-scroll");e.exports=function(t){var e=a.get(t);e&&(e.negativeScrollAdjustment=e.isNegativeScroll?t.scrollWidth-t.clientWidth:0,s.css(e.scrollbarXRail,"display","block"),s.css(e.scrollbarYRail,"display","block"),e.railXMarginWidth=n.toInt(s.css(e.scrollbarXRail,"marginLeft"))+n.toInt(s.css(e.scrollbarXRail,"marginRight")),e.railYMarginHeight=n.toInt(s.css(e.scrollbarYRail,"marginTop"))+n.toInt(s.css(e.scrollbarYRail,"marginBottom")),s.css(e.scrollbarXRail,"display","none"),s.css(e.scrollbarYRail,"display","none"),o(t),r(t,"top",t.scrollTop),r(t,"left",t.scrollLeft),s.css(e.scrollbarXRail,"display",""),s.css(e.scrollbarYRail,"display",""))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19,"./update-scroll":20}]},{},[1])}}]);
//# sourceMappingURL=sri-v2-chartiq-vendor-646f3c4c-bundle-4e9f156b1eb1369259ba.js.map